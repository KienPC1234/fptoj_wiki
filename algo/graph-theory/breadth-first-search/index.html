
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wiki.fptoj.com/algo/graph-theory/breadth-first-search/">
      
      
        <link rel="prev" href="../../geometry/Sweep-Line/">
      
      
        <link rel="next" href="../centroid-decomposition/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>BFS (Breadth-first search) - FPTOJ WIKI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bfs-breadth-first-search" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FPTOJ WIKI" class="md-header__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FPTOJ WIKI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              BFS (Breadth-first search)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ tối"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ tối" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ sáng"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ sáng" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FPTOJ WIKI" class="md-nav__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    FPTOJ WIKI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trang chủ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giới thiệu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Markdown
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Thuật Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Thuật Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cơ Bản
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Cơ Bản
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/backtracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đệ quy và Thuật toán quay lui
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán tìm kiếm nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bitwise-operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phép toán bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/computational-complexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp thời gian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 1: vòng lặp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 2: bắt đầu từ đâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/meet-in-the-middle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán sắp xếp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/Tai-Lieu-Thuat-Toan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số Tài liệu hay về Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/two-pointers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật hai con trỏ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đại Số
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Đại Số
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/binary_exponentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lũy thừa nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/euclid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Euclid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/fft-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biến đổi Fourier nhanh - Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/nCk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cách tính số tổ hợp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/primality_check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kiểm tra số nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/prime_sieve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sàng nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/array-vs-linked-lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng và danh sách liên kết
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/C%C3%A2y-Palindrome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc của cây Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/data-structures-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng quan về Cấu Trúc Dữ Liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/deque-min-max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàng đợi hai đầu (deque) và Bài toán tìm max-min trong đoạn tịnh tiến
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Deque/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deque - hàng đợi hai đầu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set-union/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoints Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick-2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân 2 chiều (BIT 2 chiều)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân (Binary Indexed Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Table)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/heavy-light-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heavy-Light Decomposition (HLD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/interval-tree-tap-doan-thang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interval Tree trên tập đoạn thẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca-binlift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lowest Common Ancestor (LCA) - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các phương pháp giải bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/mo-algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/overview-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/persistent-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistent Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/prefix-sum-and-difference-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng cộng dồn và mảng hiệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/rmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Range Minimum Query (RMQ) - Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây Phân Đoạn (cơ bản)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-extend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tất tần tật về Cây Phân Đoạn (Segment Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Skip-Lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip Lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/sqrt-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack (ngăn xếp)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng hậu tố (Suffix Array)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-automaton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/trie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trie
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quy hoạch động
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Quy hoạch động
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số bài toán quy hoạch động điển hình
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/Mot-so-ky-thuat-toi-uu-hoa-thuat-toan-Quy-Hoach-Dong/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số kĩ thuật tối ưu hoá thuật toán Quy Hoạch Động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/palindrome-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một vài bài tập về Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/thac-mac-ve-qhd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phân tích về QHĐ - Thầy Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Games
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Games
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../games/Giai-Thuat-Cat-Tia-Alpha-beta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thuật cắt tỉa Alpha-beta
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hình học
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Hình học
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 1: Những khái niệm cơ bản
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 2: Sự giao nhau của đường thẳng và các ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/Sweep-Line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán đường quét
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lý thuyết Đồ Thị
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Lý thuyết Đồ Thị
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    BFS (Breadth-first search)
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../centroid-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán phân tách trọng tâm - Centroid decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Depth-First-Search-Tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây DFS (Depth-First Search Tree) và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-cycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi - Chu trình Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-tour-on-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi Euler trên cây
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../everything/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các chủ đề cơ bản về đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán Luồng cực đại trên mạng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lubenica-vnoj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán LUBENICA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../minimum-spanning-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán tìm cây khung nhỏ nhất trong đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shortest-path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các thuật toán về tìm đường đi ngắn nhất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topological-sort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sắp xếp Tô-pô (Topological Sort)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lý thuyết trò chơi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/Ham-Mobius/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/modular-inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4.5 - Nghịch đảo modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/multiplicative-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm nhân tính
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tìm Kiếm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Tìm Kiếm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/Local-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kỹ Năng Thi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Kỹ Năng Thi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Ki-nang-thi-cu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng hợp các lời khuyên cho các kỳ thi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Kinh-nghiem-thi-VOI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinh nghiệm thi VOI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/viet-trinh-cham/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tự code, tự chấm, tự sướng - Bí kíp thi offline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xâu kí tự
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Xâu kí tự
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xử lý xâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash: A String Matching Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán KMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/manacher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Manacher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mẹo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Mẹo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ph%E1%BB%8Fng-v%E1%BA%A5n-team-IOI-VN-2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phỏng Vấn Team IOI VN 2017
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/vojsol/ALAKE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALAKE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/convex_greedy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sum-constrained convex optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/counting-without-matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Khử nhân ma trận
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/FFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhân ma trận (Matrix multiplication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/mitm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/Roi-rac-hoa-va-ung-dung/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rời rạc hoá và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computer Science (Khoa học máy tính)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computer Science (Khoa học máy tính)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Cipher-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mật mã và Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Public-Key-Cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public Key Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/cipher/ROT13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROT13
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xử lý ảnh
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Xử lý ảnh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/Seam-Carving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seam Carving Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/setup-opencv-windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hướng dẫn cài đặt OpenCV trên Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ngôn Ngữ Lập Trình
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Ngôn Ngữ Lập Trình
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/pointers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Con trỏ trong C/C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xâu trong C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/Pascal-Vi-sao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hoài niệm về Pascal - Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dịch Thuật
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Dịch Thuật
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/functional-programming-part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming - Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/Efficient-and-easy-segment-trees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cài đặt cây phân đoạn hiệu quả (Efficient and easy segment trees)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Tables)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/palindrome-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palindrome tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/stack-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue & Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    E-Maxx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            E-Maxx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Aho-Corasick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aho Corasick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Tim-kiem-tam-phan-Ternary-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tìm kiếm tam phân - Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nâng Cao
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Nâng Cao
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Lucas-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Lucas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 2 - Số nguyên tố, Sàng Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 3 - Tính (a^b) % c
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4 - Phi hàm Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 5 - Các kiến thức cơ bản về Tổ hợp (Combinatorics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 6 - Xác suất (Probabilities)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 7 - Bao hàm - Loại trừ (Inclusion-Exclusion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/So-hoc-Phan-1-Modulo-gcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 1 - Modulo & gcd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Wilsons-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Wilson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Máy học (Machine Learning - ML)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Máy học (Machine Learning - ML)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ml/machine-learning-101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning 101 (1): Làm quen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/PyTorch-la-gi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Là Gì?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quora
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Quora
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/quora/mobius-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topcoder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Topcoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/dynamic-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhập môn Quy hoạch động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/fun-with-bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fun with Bits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Greedy-is-Good/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Tham lam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Hieu-ve-xac-suat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xác suất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Dissect-a-Topcoder-Problem-Statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ năng đọc đề Topcoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Find-a-Solution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nghệ thuật giải bài
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Mathematics-for-Topcoders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toán học trong Tin học
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/max-flow-1-luong-cuc-dai-tren-mang-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luồng cực đại trên mạng - Maxflow network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán RMQ và bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/The-Importance-of-Algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tầm Quan Trọng Của Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Using-Regular-Expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sử dụng Regex
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    USACO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            USACO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/USACO/Crafting-Winning-Solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viết lời giải chiến thắng trong kì thi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wcipeg
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            Wcipeg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Bao-l%E1%BB%93i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thích trực quan về bao lồi trên mặt phẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Binary-Heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull-Trick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật bao lồi (Convex Hull Trick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bao lồi (Convex Hull)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán luồng cực đại
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Knuth-Morris-Pratt (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây (Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="bfs-breadth-first-search">BFS (Breadth-first search)</h1>
<p><strong>Nguồn:</strong> <a href="https://cp-algorithms.com/graph/breadth-first-search.html">CP-Algorithms</a>, <a href="algo/basic/Tai-Lieu-Thuat-Toan">Giải thuật và lập trình - Lê Minh Hoàng</a></p>
<p><strong>Biên soạn:</strong>
- Nguyễn Châu Khanh - VNU University of Engineering and Technology (VNU-UET)</p>
<p><strong>Reviewer:</strong> 
- Trần Quang Lộc - ITMO University
- Hoàng Xuân Nhật - VNUHCM-University of Science
- Trần Xuân Bách - HUS High School for Gifted Students</p>
<h1 id="thuat-toan-duyet-o-thi-uu-tien-chieu-rong">Thuật toán duyệt đồ thị ưu tiên chiều rộng</h1>
<p>Thuật toán <strong>duyệt đồ thị ưu tiên chiều rộng</strong> <em>(Breadth-first search - BFS)</em> là một trong những thuật toán tìm kiếm cơ bản và thiết yếu trên đồ thị. Mà trong đó, những đỉnh nào gần đỉnh xuất phát hơn sẽ được duyệt trước.</p>
<p>Ứng dụng của <span class="arithmatex">\(BFS\)</span> có thể giúp ta giải quyết tốt một số bài toán trong thời gian và không gian <strong>tối thiểu</strong>. Đặc biệt là bài toán tìm kiếm đường đi ngắn nhất từ một đỉnh gốc tới tất cả các đỉnh khác. Trong đồ thị không có trọng số hoặc tất cả trọng số bằng nhau, thuật toán sẽ luôn trả ra đường đi ngắn nhất có thể. Ngoài ra, thuật toán này còn được dùng để tìm các thành phần liên thông của đồ thị, hoặc kiểm tra đồ thị hai phía, ...</p>
<p><img alt="/uploads/breadth-first-search_img1.png" src="/uploads/breadth-first-search_img1.png" /></p>
<h2 id="y-tuong">Ý tưởng</h2>
<p>Với đồ thị không trọng số và đỉnh nguồn <span class="arithmatex">\(s\)</span>. Đồ thị này có thể là đồ thị có hướng hoặc vô hướng, điều đó <strong>không quan trọng</strong> đối với thuật toán.</p>
<p>Có thể hiểu thuật toán như một ngọn lửa lan rộng trên đồ thị:</p>
<ul>
<li>Ở bước thứ <span class="arithmatex">\(0\)</span>, chỉ có đỉnh nguồn <span class="arithmatex">\(s\)</span> đang cháy. </li>
<li>Ở mỗi bước tiếp theo, ngọn lửa đang cháy ở mỗi đỉnh lại lan sang tất cả các đỉnh kề với nó.</li>
</ul>
<p>Trong mỗi lần lặp của thuật toán, "vòng lửa" lại lan rộng ra theo chiều rộng. Những đỉnh nào gần <span class="arithmatex">\(s\)</span> hơn sẽ bùng cháy trước.</p>
<p>Chính xác hơn, thuật toán có thể được mô tả như sau: </p>
<ul>
<li>Đầu tiên ta thăm đỉnh nguồn <span class="arithmatex">\(s\)</span>. </li>
<li>Việc thăm đỉnh <span class="arithmatex">\(s\)</span> sẽ phát sinh thứ tự thăm các đỉnh <span class="arithmatex">\((u_1, u_2, … u_p)\)</span> kề với <span class="arithmatex">\(s\)</span> (những đỉnh gần <span class="arithmatex">\(s\)</span> nhất). Tiếp theo, ta thăm đỉnh <span class="arithmatex">\(u_1\)</span>, khi thăm đỉnh <span class="arithmatex">\(u_1\)</span> sẽ lại phát sinh yêu cầu thăm những đỉnh <span class="arithmatex">\((v_1, v_2, …, v_q)\)</span> kề với <span class="arithmatex">\(u_1\)</span>. Nhưng rõ ràng những đỉnh <span class="arithmatex">\(v\)</span> này “xa” <span class="arithmatex">\(s\)</span> hơn những đỉnh <span class="arithmatex">\(u\)</span> nên chúng chỉ được thăm khi tất cả những đỉnh <span class="arithmatex">\(u\)</span> đều đã được thăm. Tức là thứ tự thăm các đỉnh sẽ là: <span class="arithmatex">\(s, u_1, u_2, …, u_p, v_1, v_2, …, v_q, …\)</span></li>
</ul>
<p><img alt="/uploads/breadth-first-search_img2.png" src="/uploads/breadth-first-search_img2.png" /></p>
<p>Thuật toán tìm kiếm theo chiều rộng sử dụng một danh sách để chứa những đỉnh đang “chờ” thăm. Tại mỗi bước, ta thăm một đỉnh đầu danh sách, loại nó ra khỏi danh sách và cho những đỉnh kề với nó chưa được thăm xếp hàng vào cuối danh sách. Thuật toán sẽ kết thúc khi danh sách rỗng.</p>
<h2 id="thuat-toan">Thuật toán</h2>
<p>Thuật toán sử dụng một cấu trúc dữ liệu hàng đợi <em>(queue)</em> để chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</p>
<p><strong>Bước 1:</strong> Khởi tạo
- Các đỉnh đều ở trạng thái chưa được đánh dấu. Ngoại trừ đỉnh nguồn <span class="arithmatex">\(s\)</span> đã được đánh dấu.
- Một hàng đợi ban đầu chỉ chứa <span class="arithmatex">\(1\)</span> phần tử là <span class="arithmatex">\(s\)</span>.</p>
<p><strong>Bước 2:</strong> Lặp lại các bước sau cho đến khi hàng đợi rỗng:
- Lấy đỉnh <span class="arithmatex">\(u\)</span> ra khỏi hàng đợi.
- Xét tất cả những đỉnh <span class="arithmatex">\(v\)</span> kề với <span class="arithmatex">\(u\)</span> mà chưa được đánh dấu, với mỗi đỉnh <span class="arithmatex">\(v\)</span> đó:
    * Đánh dấu <span class="arithmatex">\(v\)</span> đã thăm.
    * Lưu lại vết đường đi từ <span class="arithmatex">\(u\)</span> đến <span class="arithmatex">\(v\)</span>.
    * Đẩy <span class="arithmatex">\(v\)</span> vào trong hàng đợi (đỉnh <span class="arithmatex">\(v\)</span> sẽ chờ được duyệt tại những bước sau).</p>
<p><strong>Bước 3:</strong> Truy vết tìm đường đi.</p>
<h2 id="mo-ta">Mô tả</h2>
<ul>
<li>Xét đồ thị sau đây, với đỉnh nguồn <span class="arithmatex">\(s=1\)</span> :</li>
</ul>
<p><img alt="/uploads/breadth-first-search_img3.png" src="/uploads/breadth-first-search_img3.png" />
<img alt="/uploads/breadth-first-search_img4.png" src="/uploads/breadth-first-search_img4.png" /></p>
<ul>
<li><strong>Quá trình:</strong></li>
</ul>
<p><a href="/uploads/breadth-first-search_gif1.gif">/uploads/breadth-first-search_gif1.gif</a></p>
<h2 id="cai-at">Cài đặt</h2>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Biến <code>maxN</code> - Kích thước mảng.</li>
<li>Mảng <code>d[]</code> - Mảng lưu lại khoảng cách từ đỉnh nguồn đến mọi đỉnh.</li>
<li>Mảng <code>par[]</code> - Mảng lưu lại vết đường đi.</li>
<li>Mảng <code>visit[]</code> - Mảng đánh dấu các đỉnh đã thăm.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="c1">// Số lượng đỉnh của đồ thị</span>
<span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Với s là đỉnh xuất phát (đỉnh nguồn)</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="truy-vet"><strong>Truy vết</strong></h3>
<ul>
<li>Cài đặt truy vết đường đi từ đỉnh nguồn <span class="arithmatex">\(s\)</span> đến đỉnh <span class="arithmatex">\(u\)</span> :</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;No path!&quot;</span><span class="p">;</span>
<span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
<span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="n">reverse</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Path: &quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="cac-ac-tinh-cua-thuat-toan">Các đặc tính của thuật toán</h2>
<p>Nếu sử dụng một ngăn xếp <em>(stack)</em> thay vì hàng đợi <em>(queue)</em> thì ta sẽ thu được <strong>thứ tự duyệt đỉnh</strong> của thuật toán <strong>tìm kiếm theo chiều sâu</strong> <em>(Depth First Search – DFS)</em>. Đây chính là <strong>phương pháp khử đệ quy</strong> của <span class="arithmatex">\(DFS\)</span> để cài đặt thuật toán trên các ngôn ngữ không cho phép đệ quy.</p>
<p><strong>Định lí:</strong> Thuật toán <span class="arithmatex">\(BFS\)</span> cho ta độ dài đường đi ngắn nhất từ đỉnh nguồn tới mọi đỉnh (với khoảng cách tới đỉnh <span class="arithmatex">\(u\)</span> bằng <span class="arithmatex">\(d[u]\)</span>). 
Trong thuật toán <span class="arithmatex">\(BFS\)</span>, nếu đỉnh <span class="arithmatex">\(u\)</span> xa đỉnh nguồn hơn đỉnh <span class="arithmatex">\(v\)</span>, thì <span class="arithmatex">\(u\)</span> sẽ được thăm trước.</p>
<ul>
<li><strong>Chứng minh:</strong> Trong <span class="arithmatex">\(BFS\)</span>, từ một đỉnh hiện tại, ta luôn đi thăm tất cả các đỉnh kề với nó trước, sau đó thăm tất cả các đỉnh cách nó một đỉnh, rồi các đỉnh cách nó hai đỉnh, v.v... Như vậy, nếu từ một đỉnh <span class="arithmatex">\(u\)</span> khi ta chạy <span class="arithmatex">\(BFS\)</span>, quãng đường đến đỉnh <span class="arithmatex">\(v\)</span> luôn là quãng đường đi qua ít cạnh nhất.</li>
</ul>
<h2 id="inh-ly-bat-tay-handshaking-lemma">Định lý Bắt tay (Handshaking lemma)</h2>
<p><strong>Định lý:</strong> Trong một đồ thị bất kỳ, tổng số <a href="https://vi.wikipedia.org/wiki/B%E1%BA%ADc_(l%C3%BD_thuy%E1%BA%BFt_%C4%91%E1%BB%93_th%E1%BB%8B)">bậc</a> của tất cả các đỉnh bằng <strong>gấp đôi</strong> số cạnh của đồ thị.</p>
<ul>
<li>
<p><strong>Mô tả:</strong> Cho đồ thị <span class="arithmatex">\(G=(V,E)\)</span> gồm <span class="arithmatex">\(\|V\|\)</span> đỉnh và <span class="arithmatex">\(\|E\|\)</span> cạnh. Khi đó, tổng tất cả các bậc của đỉnh trong <span class="arithmatex">\(G\)</span> bằng <span class="arithmatex">\(2 \times \|E\|\)</span> .
    Với <span class="arithmatex">\(deg(v)\)</span> là số bậc của đỉnh <span class="arithmatex">\(v\)</span>, ta có: <span class="arithmatex">\(\displaystyle\sum_{v \in V}deg(v) = 2 \times \|E\|\)</span></p>
<ul>
<li>
<p><strong>Ví dụ:</strong> Cho đồ thị sau với <span class="arithmatex">\(\|V\| = 8\)</span> và <span class="arithmatex">\(\|E\| = 7\)</span></p>
<p><img alt="/uploads/breadth-first-search_img5.png" src="/uploads/breadth-first-search_img5.png" /></p>
<ul>
<li><span class="arithmatex">\(\displaystyle\sum_{v \in V}deg(v) = 2 \times \|E\| = 2 \times 7 = 14\)</span> </li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Chứng minh:</strong> Vì mỗi một cạnh nối với đúng hai đỉnh của đồ thị, nên một cạnh sẽ đóng góp <span class="arithmatex">\(2\)</span> đơn vị vào tổng số bậc của tất cả các đỉnh.</p>
</li>
</ul>
<p><strong>Hệ quả:</strong> Trong đồ thị, số lượng <strong>đỉnh bậc lẻ</strong> luôn là một số chẵn.
- <strong>Chứng minh:</strong> Gọi <span class="arithmatex">\(L\)</span> và <span class="arithmatex">\(C\)</span> lần lượt là tập các đỉnh bậc lẻ và bậc chẵn của đồ thị <span class="arithmatex">\(G=(V, E)\)</span>. Ta có: 
    <span class="arithmatex">\(2 \times \|E\| = \displaystyle\sum_{v \in V}deg(v) = \displaystyle\sum_{v \in L}deg(v) + \displaystyle\sum_{v \in C}deg(v)\)</span> </p>
<pre><code>- $2 \times \|E\|$ chẵn
- $\displaystyle\sum_{v \in C}deg(v)$ chẵn

$\Rightarrow$ $\displaystyle\sum_{v \in L}deg(v)$ chẵn
</code></pre>
<p><strong>Nhận xét:</strong> 
- Trong quá trình duyệt đồ thị được biểu diễn bằng <strong>danh sách kề</strong>, mỗi cạnh sẽ được duyệt chính xác hai lần đối với <strong>đồ thị vô hướng</strong> (vì mỗi cạnh sẽ được lưu trong <span class="arithmatex">\(2\)</span> danh sách kề của <span class="arithmatex">\(2\)</span> đỉnh). Còn đối với <strong>đồ thị có hướng</strong>, mọi cạnh của đồ thị chỉ được duyệt chính xác một lần.</p>
<p><strong>Tham khảo:</strong> <a href="https://en.wikipedia.org/wiki/Handshaking_lemma">Handshaking_lemma</a></p>
<h2 id="o-phuc-tap-thuat-toan">Độ phức tạp thuật toán</h2>
<h3 id="o-phuc-tap-thoi-gian"><strong>Độ phức tạp thời gian</strong></h3>
<p>Gọi <span class="arithmatex">\(\|V\|\)</span> là số lượng đỉnh và <span class="arithmatex">\(\|E\|\)</span> là số lượng cạnh của đồ thị.</p>
<p>Trong quá trình <span class="arithmatex">\(BFS\)</span>, cách biểu diễn đồ thị có ảnh hưởng lớn tới chi phí về thời gian thực hiện giải thuật :
- Nếu đồ thị biểu diễn bằng <strong>danh sách kề</strong> (vector <code>g[]</code>) :
    - Ta có thể thực hiện thuật toán này một cách <strong>tối ưu nhất</strong> về mặt thời gian nhờ khả năng duyệt qua các đỉnh kề của mỗi đỉnh một cách <strong>hiệu quả</strong>.
    - Vì ta sử dụng mảng <code>visit[]</code> để ngăn việc đẩy một đỉnh vào hàng đợi nhiều lần nên mỗi đỉnh sẽ được thăm <strong>chính xác một lần</strong> duy nhất. Do đó, ta mất độ phức tạp thời gian <span class="arithmatex">\(O(\|V\|)\)</span> dành cho việc thăm các đỉnh. 
    - Bất cứ khi nào một đỉnh được thăm, mọi cạnh kề với đỉnh đó đều được duyệt, với thời gian dành cho mỗi cạnh là <span class="arithmatex">\(O(1)\)</span>. Từ phần nhận xét của <strong>định lý Bắt tay <em>(Handshaking lemma)</em></strong>, ta sẽ mất độ phức tạp thời gian <span class="arithmatex">\(O(\|E\|)\)</span> dành cho việc duyệt các cạnh.
    - Nhìn chung, độ phức tạp thời gian của thuật toán này là <span class="arithmatex">\(O(\|V\|+\|E\|)\)</span>. Đây là cách cài đặt tốt nhất.
- Nếu đồ thị được biểu diễn bằng <strong>ma trận kề</strong> : 
    - Ta cũng sẽ mất độ phức tạp thời gian <span class="arithmatex">\(O(\|V\|)\)</span> dành cho việc thăm các đỉnh <em>(giải thích tương tự như trên)</em>.
    - Với mỗi đỉnh được thăm, ta sẽ phải duyệt qua toàn bộ các đỉnh của đồ thị để kiểm tra đỉnh kề với nó. Do đó, thuật toán sẽ mất độ phức tạp <span class="arithmatex">\(O(\|V\|^2)\)</span>.</p>
<h3 id="o-phuc-tap-khong-gian"><strong>Độ phức tạp không gian</strong></h3>
<p>Tại mọi thời điểm, trong hàng đợi (queue <code>q</code>) có không quá <span class="arithmatex">\(\|V\|\)</span> phần tử. Do đó, độ phức tạp bộ nhớ là <span class="arithmatex">\(O(\|V\|)\)</span>.</p>
<h1 id="ung-dung-bfs-e-xac-inh-thanh-phan-lien-thong">Ứng dụng BFS để xác định thành phần liên thông</h1>
<h2 id="bai-toan-1"><strong>Bài toán 1</strong></h2>
<p><a href="http://lequydon.ntucoder.net/Problem/Details/4601">BDFS - Đếm số thành phần liên thông</a></p>
<h3 id="e-bai"><strong>Đề bài</strong></h3>
<p>Cho đơn đồ thị vô hướng gồm <span class="arithmatex">\(n\)</span> đỉnh và <span class="arithmatex">\(m\)</span> cạnh <span class="arithmatex">\((1 \le n, m \le 10^5)\)</span>, các đỉnh được đánh số từ <span class="arithmatex">\(1\)</span> tới <span class="arithmatex">\(n\)</span>. Tìm số <a href="https://vi.wikipedia.org/wiki/Th%C3%A0nh_ph%E1%BA%A7n_li%C3%AAn_th%C3%B4ng">thành phần liên thông</a> của đồ thị.</p>
<h3 id="y-tuong_1"><strong>Ý tưởng</strong></h3>
<p>Một đồ thị có thể liên thông hoặc không liên thông. Nếu đồ thị liên thông thì số thành phần liên thông của nó là <span class="arithmatex">\(1\)</span>. Điều này tương đương với phép duyệt theo thủ tục <span class="arithmatex">\(BFS\)</span> được gọi đến <strong>đúng một lần</strong>. Nếu đồ thị không liên thông (số thành phần liên thông lớn hơn <span class="arithmatex">\(1\)</span>) ta có thể tách chúng thành những <strong>đồ thị con liên thông</strong>. Điều này cũng có nghĩa là trong phép duyệt đồ thị, số thành phần liên thông của nó bằng số lần gọi tới thủ tục <span class="arithmatex">\(BFS\)</span>.</p>
<h3 id="thuat-toan_1"><strong>Thuật toán</strong></h3>
<p>Thuật toán ứng dụng <span class="arithmatex">\(BFS\)</span> để xác định thành phần liên thông:
- <strong>Bước 0:</strong> Khởi tạo số lượng thành phần liên thông bằng <span class="arithmatex">\(0\)</span>.
- <strong>Bước 1:</strong> Xuất phát từ một đỉnh chưa được đánh dấu của đồ thị. Ta đánh dấu đỉnh xuất phát, tăng số thành phần liên thông thêm <span class="arithmatex">\(1\)</span>.
- <strong>Bước 2:</strong> Từ một đỉnh <span class="arithmatex">\(i\)</span> đã đánh dấu, ta đánh dấu tất cả các đỉnh <span class="arithmatex">\(j\)</span> kề với <span class="arithmatex">\(i\)</span> mà <span class="arithmatex">\(j\)</span> chưa được đánh dấu.
- <strong>Bước 3:</strong> Thực hiện bước <span class="arithmatex">\(2\)</span> cho đến khi không còn thực hiện được nữa.
- <strong>Bước 4:</strong> Nếu số số đỉnh đánh dấu bằng <span class="arithmatex">\(n\)</span> (mọi đỉnh đều được đánh dấu) kết thúc thuật toán và trả về số thành phần liên thông, ngược lại quay về bước <span class="arithmatex">\(1\)</span>.</p>
<h3 id="mo-ta_1"><strong>Mô tả</strong></h3>
<p><a href="/uploads/breadth-first-search_gif2.gif">/uploads/breadth-first-search_gif2.gif</a></p>
<h3 id="cai-at_1"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 100007</code>.</li>
<li>Biến <code>components</code> - Số lượng thành phần liên thông.</li>
<li>Mảng <code>visit[]</code> - Mảng đánh dấu các đỉnh đã thăm.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">components</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">++</span><span class="n">components</span><span class="p">;</span>
<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="n">bfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">components</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia"><strong>Đánh giá</strong></h3>
<p>Ta cũng có thể sử dụng  thuật toán tìm kiếm theo chiều sâu <em>(Depth First Search – DFS)</em> để xác định thành phần liên thông.</p>
<p><strong>Độ phức tạp</strong></p>
<p>Độ phức tạp của thuật toán là <span class="arithmatex">\(O(n + m)\)</span>.</p>
<h2 id="thuat-toan-loang-flood-fill">Thuật toán loang (Flood Fill)</h2>
<p><strong>Thuật toán loang <em>(thuật toán vết dầu loang)</em></strong> là một kĩ thuật sử dụng <span class="arithmatex">\(BFS\)</span> để tìm tất cả các điểm có thể đi tới. Điểm khác biệt giữa <strong>Loang</strong> so với đa số những bài <span class="arithmatex">\(BFS\)</span> là ta không phải tìm chi phí nhỏ nhất.</p>
<p>Thuật toán loang được dùng khá nhiều trong tin học, điển hình là <strong>thuật toán loang trên ma trận</strong> được ứng dụng để đếm số <strong>thành phần liên thông</strong> trên ma trận. Ngoài ra, nó còn ứng dụng trong các <strong>bài toán thực tế</strong> như các bài toán tìm đường đi, game dò mìn, game line98,...</p>
<p>Gọi là thuật toán loang vì nguyên lí của thuật toán này rất giống với hiện tượng loang của chất lỏng. Khi ta nhỏ dầu xuống một mặt phẳng, vết dầu có thể loang ra những khu vực xung quanh. Tương tự, thuật toán loang trên ma trận cũng vậy, ta sẽ duyệt một ô trên ma trận và sau đó duyệt các điểm xung quanh nó và loang dần ra để giải quyết bài toán.</p>
<h2 id="bai-toan-2"><strong>Bài toán 2</strong></h2>
<p><a href="https://www.spoj.com/problems/UCV2013H/">UCV2013H - Slick</a></p>
<h3 id="e-bai_1"><strong>Đề bài</strong></h3>
<p>Một tai nạn hàng hải đã khiến dầu tràn ra biển. Để có được thông tin về mức độ nghiêm trọng của thảm họa này, người ta phải phân tích các hình ảnh chụp từ vệ tinh, từ đó tính toán chi phí khắc phục cho phù hợp. Đối với điều này, số lượng vết dầu loang trên biển và kích thước của mỗi vết loang phải được xác định. Vết loang là một mảng dầu nổi trên mặt nước. </p>
<p>Để tiện cho việc xử lí, hình ảnh được chuyển đổi thành một ma trận nhị phân kích thước <span class="arithmatex">\(N \times M\)</span> <span class="arithmatex">\((1 \le N, M \le 250)\)</span>. Với <span class="arithmatex">\(1\)</span> là ô bị nhiễm dầu, và <span class="arithmatex">\(0\)</span> là ô không bị nhiễm dầu. Vết dầu loang là tập hợp của một số ô bị nhiễm dầu có chung cạnh.</p>
<p>Họ đã thuê bạn để giúp họ xử lí hình ảnh. Công việc của bạn là đếm số lượng vết loang trên biển và kích thước tương ứng của từng vết.</p>
<h3 id="y-tuong_2"><strong>Ý tưởng</strong></h3>
<p>Ta xây dựng một <strong>mô hình đồ thị</strong> của bài toán như sau:
- Gọi mỗi đỉnh của đồ thị tương ứng với mỗi ô <span class="arithmatex">\(1\)</span> <em>(ô bị nhiễm dầu)</em> của ma trận.
- Tồn tại một cạnh nối giữa cặp đỉnh <span class="arithmatex">\((u, v)\)</span> khi và chỉ khi ô tương ứng với đỉnh <span class="arithmatex">\(u\)</span> kề cạnh với ô tương ứng với đỉnh <span class="arithmatex">\(v\)</span> và cả hai ô đều là ô <span class="arithmatex">\(1\)</span>.</p>
<p>Khi đó, bài toán quy về thành bài toán <strong>xác định thành phần liên thông của đồ thị</strong>. Trong đó, mỗi thành phần liên thông tương ứng với mỗi một vết dầu loang.</p>
<p>Nghĩa là, số lượng thành phần liên thông của đồ thị chính là số lượng vết dầu loang. Và số lượng đỉnh nằm trong cùng một thành phần liên thông là kích thước của vết loang tương ứng.</p>
<h3 id="thuat-toan_2"><strong>Thuật toán</strong></h3>
<p>Áp dụng <strong>thuật toán loang trên ma trận</strong> để xác định thành phần liên thông:
- Khởi tạo số lượng vết dầu bằng <span class="arithmatex">\(0\)</span>.
- Duyệt dần từng ô của ma trận, nếu ô đang xét là một ô bị nhiễm dầu (ô <span class="arithmatex">\(1\)</span>) và chưa được đánh dấu:
    * Đánh dấu lại ô đó.
    * Tăng số lượng vết dầu thêm <span class="arithmatex">\(1\)</span>.
    * Thực hiện thủ tục <span class="arithmatex">\(BFS\)</span> xuất phát từ ô đó để loang ra các ô xung quanh như sau:
        * Khởi tạo kích thước của vết dầu đang xét là <span class="arithmatex">\(1\)</span>.
        * Tiếp tục thực hiện công việc sau cho đến khi không còn thực hiện được nữa: Từ một ô đã đánh dấu, ta đánh dấu tất cả các ô bị nhiễm dầu kề cạnh với ô đó mà chưa được đánh dấu. Mỗi lần đánh dấu lại một ô thì ta tăng kích thước của vết dầu thêm <span class="arithmatex">\(1\)</span>. 
        * Sử dụng <span class="arithmatex">\(1\)</span> mảng để lưu lại kích thước của từng vết loang.
- Nếu tất cả các ô bị nhiễm dầu đều đã được đánh dấu, trả ra kết quả và kết thúc thuật toán.</p>
<h3 id="mo-ta_2"><strong>Mô tả</strong></h3>
<p><a href="/uploads/breadth-first-search_gif3.gif">/uploads/breadth-first-search_gif3.gif</a></p>
<h3 id="cai-at_2"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 300</code>.</li>
<li>Mảng <code>visit[][]</code> - Mảng đánh dấu các ô đã duyệt.</li>
<li>Vector <code>slicks</code> - Lưu kích thước của mỗi vết dầu loang.</li>
<li>Hàng đợi <code>q</code> - Chứa các ô sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">slicks</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">moveX</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">moveY</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>

<span class="c1">// Thủ tục cài đặt lại cấu trúc dữ liệu sau mỗi bộ test</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">slicks</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sizeSlicks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Biến đếm số lượng đỉnh thuộc thành phần liên thông</span>
<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">});</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="n">sy</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">first</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">moveX</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">moveY</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="o">++</span><span class="n">sizeSlicks</span><span class="p">;</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">});</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sizeSlicks</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="w"> </span>
<span class="w">                    </span><span class="n">slicks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">bfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">));</span>

<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">slicks</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>

<span class="w">        </span><span class="n">sort</span><span class="p">(</span><span class="n">slicks</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">slicks</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
<span class="w">        </span><span class="n">slicks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mf">1e9</span><span class="p">);</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slicks</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">slicks</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pre</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="w">                </span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">                </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">++</span><span class="n">number</span><span class="p">;</span>

<span class="w">        </span><span class="n">reset</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_1"><strong>Đánh giá</strong></h3>
<p>Ta sử dụng <span class="arithmatex">\(2\)</span> mảng <code>moveX[]</code> và <code>moveY[]</code> để có thể dễ dàng duyệt qua tất cả các ô kề cạnh với ô đang xét.</p>
<p><strong>Độ phức tạp</strong></p>
<p>Với mỗi bộ test:
- Vì mỗi ô của ma trận được duyệt đúng duy nhất <span class="arithmatex">\(1\)</span> lần nên ta sẽ mất độ phức tạp <span class="arithmatex">\(O(N \times M)\)</span>.
- Ta sẽ mất thêm <span class="arithmatex">\(O(4 \times N \times M)\)</span> vì ta phải duyệt qua <span class="arithmatex">\(4\)</span> ô kề cạnh với mỗi ô của ma trận.</p>
<p>Nhìn chung, độ phức tạp của thuật toán là <span class="arithmatex">\(O(t \times (N \times M + 4 \times N \times M))\)</span>. Với <span class="arithmatex">\(t\)</span> là số lượng bộ test.</p>
<h2 id="bai-tap-ap-dung"><strong>Bài tập áp dụng</strong></h2>
<p><a href="https://www.spoj.com/PTIT/problems/BCDAISY/">BCDAISY - Chú bò hư hỏng</a></p>
<p><a href="https://www.spoj.com/PTIT/problems/BCLKCOUN/">BCLKCOUN - Đếm số ao</a></p>
<p><a href="https://www.spoj.com/PTIT/problems/BCISLAND/">BCISLAND - Nước biển</a></p>
<p><a href="https://www.spoj.com/THPTCBT/problems/MTNTRAI/">MTNTRAI - Nông Trại</a></p>
<p><a href="https://oj.vnoi.info/problem/nkguard">NKGUARD - Bảo vệ nông trang</a></p>
<p><a href="https://oj.vnoi.info/problem/damage">Damage - Động đất</a></p>
<p><a href="https://www.spoj.com/problems/KOZE/">KOZE - Sheep</a></p>
<p><a href="https://cses.fi/problemset/task/1192">CSES - Counting Rooms</a></p>
<h1 id="ung-dung-bfs-e-tim-uong-i-ngan-nhat-trong-o-thi-khong-trong-so">Ứng dụng BFS để tìm đường đi ngắn nhất trong đồ thị không trọng số</h1>
<p>Những bài sử dụng <span class="arithmatex">\(BFS\)</span> thường yêu cầu tìm số bước ít nhất (hoặc đường đi ngắn nhất) từ điểm đầu đến điểm cuối. Bên cạnh đó, đường đi giữa <span class="arithmatex">\(2\)</span> điểm bất kì thường có chung trọng số (và thường là <span class="arithmatex">\(1\)</span>). Phổ biến nhất là dạng bài cho bảng <span class="arithmatex">\(N \times M\)</span>, có những ô đi qua được và những ô không đi qua được. Bảng này có thể là mê cung, sơ đồ, các thành phố hoặc các thứ các thứ tương đương. Có thể nói đây là những bài toán <span class="arithmatex">\(BFS\)</span> kinh điển.</p>
<p>Hãy xem xét bài toán sau đây:</p>
<h2 id="bai-toan-3"><strong>Bài toán 3</strong></h2>
<p><a href="https://oj.vnoi.info/problem/vmunch">Vmunch - Gặm cỏ</a></p>
<h3 id="e-bai_2"><strong>Đề bài</strong></h3>
<p>Cho một bảng hình chữ nhật chia thành lưới ô vuông kích thước <span class="arithmatex">\(R \times C\)</span> (<span class="arithmatex">\(1 \le R, C \le 100\)</span>). Mỗi ô mang <span class="arithmatex">\(1\)</span> trong <span class="arithmatex">\(4\)</span> giá trị sau : <code>.</code> , <code>*</code> , <code>B</code> , <code>C</code>. Cô bò Bessie đang đứng ở ô <code>C</code> và cần đi đến ô <code>B</code>. Mỗi bước đi Bessie có thể đi từ <span class="arithmatex">\(1\)</span> ô vuông sang <span class="arithmatex">\(4\)</span> ô vuông khác kề cạnh nhưng không được đi vào ô <code>*</code> hay đi ra khỏi bảng. Hãy tìm số bước đi ít nhất để Bessie đến được ô <code>B</code>. </p>
<p>Đảm bảo chỉ có duy nhất <span class="arithmatex">\(1\)</span> ô <code>B</code> và <span class="arithmatex">\(1\)</span> ô <code>C</code> trong bảng, và luôn tồn tại đường đi từ <code>C</code> đến <code>B</code>.</p>
<h3 id="phan-tich"><strong>Phân tích</strong></h3>
<p>Theo mối quan hệ được xây dựng trong đề bài, Bessie có thể di chuyển từ <span class="arithmatex">\(1\)</span> ô vuông sang <span class="arithmatex">\(4\)</span> ô vuông khác kề cạnh. Từ đó, ta có thể xây dựng một <strong>mô hình đồ thị</strong> của bài toán:
- Gọi mỗi đỉnh của đồ thị tương ứng với mỗi ô trong lưới ô vuông.
- Tồn tại một cạnh nối giữa cặp đỉnh <span class="arithmatex">\((u, v)\)</span> khi và chỉ khi từ ô tương ứng với đỉnh <span class="arithmatex">\(u\)</span> có thể di chuyển đến ô tương ứng với đỉnh <span class="arithmatex">\(v\)</span> (đồng nghĩa, ô tương ứng với đỉnh <span class="arithmatex">\(u\)</span> kề cạnh với ô tương ứng với đỉnh <span class="arithmatex">\(v\)</span> và cả <span class="arithmatex">\(2\)</span> ô đều <strong>không phải</strong> là ô <code>*</code> ).</p>
<p>Sau khi xây dựng được đồ thị, bài toán quy về như sau: Tìm đường đi ngắn nhất từ đỉnh tương ứng với ô <code>C</code> đến đỉnh tương ứng với ô <code>B</code>. Độ dài đường đi ngắn nhất đó chính là số bước ít nhất mà Bessie cần thực hiện.</p>
<p>Vậy để tìm được kết quả bài toán, ta sẽ áp dụng thuật toán <span class="arithmatex">\(BFS\)</span>.</p>
<h3 id="cai-at_3"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 110</code>.</li>
<li>Mảng <code>d[][]</code> - Mảng lưu số bước ít nhất để đi từ ô xuất phát đến mỗi ô khác.</li>
<li>Mảng <code>visit[][]</code> - Mảng đánh dấu các ô đã đi qua.</li>
<li>Hàng đợi <code>q</code> - Chứa các ô sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">110</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">moveX</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">moveY</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fill_n</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">});</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="n">sy</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">first</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// Nếu gặp được ô B thì kết thúc thủ tục BFS</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;B&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">moveX</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">moveY</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;*&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">});</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">ty</span><span class="p">;</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;C&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;B&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="n">bfs</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">tx</span><span class="p">][</span><span class="n">ty</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_2"><strong>Đánh giá</strong></h3>
<p>Ta sử dụng <span class="arithmatex">\(2\)</span> mảng <code>moveX[]</code> và <code>moveY[]</code> để có thể dễ dàng duyệt qua tất cả các ô kề cạnh với ô đang xét.</p>
<p><strong>Độ phức tạp</strong></p>
<p>Giống như <span class="arithmatex">\(BFS\)</span> thông thường, độ phức tạp của bài toán là <span class="arithmatex">\(O(\|V\| + \|E\|)\)</span> (với <span class="arithmatex">\(\|V\|\)</span> là số đỉnh và <span class="arithmatex">\(\|E\|\)</span> là số cạnh của đồ thị). Trong đó, số đỉnh của đồ thị bằng số lượng ô vuông của bảng (nghĩa là <span class="arithmatex">\(\|V\| = R \times C\)</span> ). Trong <strong>trường hợp tệ nhất</strong>, tại mỗi ô đều có thể đi sang <span class="arithmatex">\(4\)</span> ô kề cạnh, nên đồ thị sẽ có khoảng <span class="arithmatex">\(4 \times \|V\|\)</span> cạnh.</p>
<p>Mặc dù trong quá trình <span class="arithmatex">\(BFS\)</span>, khi gặp được ô <code>B</code> thì thủ tục <span class="arithmatex">\(BFS\)</span> kết thúc luôn nên độ phức tạp thực tế có thể ít hơn so với tính toán. Nhưng trong <strong>trường hợp tệ nhất</strong> là ta phải đi hết tất cả các ô khác xong mới đến được ô <code>B</code>. Nên nhìn chung, độ phức tạp của thuật toán là <span class="arithmatex">\(O(R \times C + 4 \times R \times C)\)</span>.</p>
<h2 id="bai-toan-4"><strong>Bài toán 4</strong></h2>
<p><a href="https://www.spoj.com/problems/ELEVTRBL/">ELEVTRBL - Elevator Trouble</a></p>
<h3 id="e-bai_3"><strong>Đề bài</strong></h3>
<p>Trong một tòa nhà có <span class="arithmatex">\(f\)</span> tầng, các tầng được đánh số từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(f\)</span>, hiện tại bạn đang đứng tại tầng <span class="arithmatex">\(s\)</span> và cần đi đến tầng <span class="arithmatex">\(g\)</span>. Tại mỗi tầng, thang máy chỉ có <span class="arithmatex">\(2\)</span> nút là "UP u" và "DOWN d" :
- Nút "UP u" có thể đưa bạn lên đúng <span class="arithmatex">\(u\)</span> tầng nếu như có đủ số tầng phía trên.
- Nút "DOWN d" có thể đưa bạn xuống đúng <span class="arithmatex">\(d\)</span> tầng nếu như có đủ số tầng phía dưới. </p>
<p>Trường hợp không có đủ số tầng thì thang máy sẽ không lên hoặc không xuống. Hãy tính số lần phải bấm nút ít nhất để có thể đến được tầng <span class="arithmatex">\(g\)</span>.</p>
<p><span class="arithmatex">\(1 \le s, g \le f \le 10^6; 0 \le u, d \le 10^6\)</span>. </p>
<h3 id="phan-tich_1"><strong>Phân tích</strong></h3>
<p><strong>Ghi chú:</strong> Từ ứng dụng <strong>tìm đường đi ngắn nhất trong đồ thị không trọng số</strong>, ta có thể áp dụng để giải quyết các vấn đề hoặc trò chơi có số lần di chuyển ít nhất, nếu mỗi trạng thái của nó có thể được biểu diễn bằng một đỉnh của đồ thị và việc chuyển đổi từ trạng thái này sang trạng thái khác là các cạnh của đồ thị.</p>
<p>Với bài toán này ta <strong>không thể</strong> sử dụng thuật toán vét cạn, hay quay lui có điều kiện vì số lượng tầng ở đây có thể lên đến <span class="arithmatex">\(10^6\)</span> dẫn tới việc chương trình có thể <strong>chạy quá thời gian</strong>.</p>
<p>Thay vào đó, ta sẽ sử dụng thuật toán <span class="arithmatex">\(BFS\)</span>. Tư tưởng ở đây là ta sẽ đi tính số lần bấm nút nhỏ nhất để đến được mỗi tầng.</p>
<p>Từ mối quan hệ được xây dựng trong bài toán, ta có thể xây dựng một <strong>mô hình đồ thị</strong> như sau:
- Gọi mỗi đỉnh của đồ thị tương ứng với mỗi tầng của tòa nhà.
- Nếu từ tầng <span class="arithmatex">\(x\)</span> ta có thể đến được tầng <span class="arithmatex">\(y\)</span> bằng một lần bấm nút thì tồn tại cạnh nối <span class="arithmatex">\(1\)</span> chiều từ đỉnh <span class="arithmatex">\(x\)</span> đến đỉnh <span class="arithmatex">\(y\)</span>. Tương đương với việc tồn tại cạnh <span class="arithmatex">\(x \rightarrow (x + u)\)</span> (nếu <span class="arithmatex">\((x + u) \le f\)</span> ) và cạnh <span class="arithmatex">\(x \rightarrow (x - d)\)</span> (nếu <span class="arithmatex">\((x - d) \ge 1\)</span> ).</p>
<p>Sau khi xây dựng được đồ thị, đường đi ngắn nhất từ đỉnh <span class="arithmatex">\(s\)</span> đến đỉnh <span class="arithmatex">\(g\)</span> chính là số lần bấm nút ít nhất cần thực hiện.</p>
<p>Vậy để tìm được kết quả bài toán, ta sẽ áp dụng thuật toán <span class="arithmatex">\(BFS\)</span>.</p>
<h3 id="cai-at_4"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 1000007</code>.</li>
<li>Mảng <code>number[]</code> - Mảng lưu lại số lần bấm nút ít nhất để đến được mỗi tầng.</li>
<li>Mảng <code>visit[]</code> - Mảng đánh dấu lại các tầng đã đến.</li>
<li>Hàng đợi <code>q</code> - Chứa các tầng sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1e6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">number</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// Nếu gặp được tầng đích thì kết thúc thủ tục BFS</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">number</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Kết thúc quá trình BFS mà ko đến được tầng đích </span>
<span class="w">    </span><span class="n">number</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="w">    </span><span class="n">bfs</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">number</span><span class="p">[</span><span class="n">g</span><span class="p">];</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;use the stairs&quot;</span><span class="p">;</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_3"><strong>Đánh giá</strong></h3>
<p><strong>Độ phức tạp</strong></p>
<p>Độ phức tạp của bài toán là <span class="arithmatex">\(O(\|V\| + \|E\|)\)</span> (với <span class="arithmatex">\(\|V\|\)</span> là số đỉnh và <span class="arithmatex">\(\|E\|\)</span> là số cạnh của đồ thị). Trong đó, số đỉnh của đồ thị bằng số tầng của tòa nhà (nghĩa là <span class="arithmatex">\(\|V\| = f\)</span> ). Đa số mỗi tầng đều có thể đi đến <span class="arithmatex">\(2\)</span> tầng khác, nên đồ thị sẽ có khoảng <span class="arithmatex">\(2 \times \|V\|\)</span> cạnh.</p>
<p>Nhìn chung, độ phức tạp của thuật toán là <span class="arithmatex">\(O(f + 2 \times f)\)</span>.</p>
<h2 id="bai-toan-5">Bài toán 5</h2>
<p><a href="https://lqdoj.edu.vn/problem/cjpaysballas">cjpaysballas - CJ thanh toán BALLAS</a></p>
<h3 id="e-bai_4"><strong>Đề bài</strong></h3>
<p>Cho một đồ thị có hướng gồm <span class="arithmatex">\(N\)</span> đỉnh và <span class="arithmatex">\(M\)</span> cạnh <span class="arithmatex">\((1 \le N \le 10^5; 1 \le M \le 10^6)\)</span>. Các đỉnh được đánh số từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>. Hãy tìm đường đi ngắn nhất xuất phát tại đỉnh <span class="arithmatex">\(s\)</span> và kết thúc tại đỉnh <span class="arithmatex">\(t\)</span>. Nếu có nhiều đường đi ngắn nhất thỏa mãn, thì chỉ ra đường đi có <strong>thứ tự từ điển nhỏ nhất</strong> trong số đó.</p>
<p>Đảm bảo luôn tồn tại ít nhất một đường đi từ <span class="arithmatex">\(s\)</span> đến <span class="arithmatex">\(t\)</span>.</p>
<h3 id="phan-tich_2"><strong>Phân tích</strong></h3>
<p><strong>Định lí:</strong> Nếu ta sắp xếp các <strong>danh sách kề</strong> của mỗi đỉnh theo <strong>thứ tự tăng dần</strong> thì thuật toán <span class="arithmatex">\(BFS\)</span> luôn trả về đường đi có <strong>thứ tự từ điển nhỏ nhất</strong> trong số những đường đi ngắn nhất.</p>
<ul>
<li><strong>Chứng minh:</strong> Trong quá trình <span class="arithmatex">\(BFS\)</span>, nếu các đỉnh được đưa vào hàng đợi <em>(queue)</em> theo thứ tự từ điển tăng dần thì theo cơ chế hoạt động <span class="arithmatex">\(FIFO\)</span> <em>(First In - First Out)</em>, các đỉnh có thứ tự từ điển nhỏ hơn sẽ được thăm trước.</li>
</ul>
<p>Từ <strong>định lí</strong> trên, ta sẽ sắp xếp lại thứ tự đỉnh kề theo thứ tự tăng dần để đảm bảo đường đi được in ra theo thứ tự từ điển. Sau đó sử dụng <span class="arithmatex">\(BFS\)</span> kết hợp với truy vết để giải quyết bài toán.</p>
<h3 id="cai-at_5"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Mảng <code>par[]</code> - Mảng lưu lại vết đường đi.</li>
<li>Mảng <code>visit[]</code> - Mảng đánh dấu các đỉnh đã thăm.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Sắp xếp danh sách kề</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="n">sort</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>

<span class="w">    </span><span class="n">bfs</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Truy vết</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
<span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="n">reverse</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_4"><strong>Đánh giá</strong></h3>
<p><strong>Độ phức tạp</strong>
- Độ phức tạp của thuật toán là <span class="arithmatex">\(O(N + M)\)</span>.</p>
<h2 id="bai-tap-ap-dung_1"><strong>Bài tập áp dụng</strong></h2>
<p><a href="https://lqdoj.edu.vn/problem/bfs">BFS - BFS Cơ bản</a></p>
<p><a href="https://oj.vnoi.info/problem/kandp">Kandp - Mã và tốt</a></p>
<p><a href="https://www.spoj.com/problems/NAKANJ/">NAKANJ - Minimum Knight moves !!!</a></p>
<p><a href="https://www.spoj.com/problems/DIGOKEYS/">DIGOKEYS - Find the Treasure</a></p>
<p><a href="https://www.spoj.com/problems/MICEMAZE/">MICEMAZE - Mice and Maze</a></p>
<p><a href="https://www.spoj.com/problems/INVESORT/">INVESORT - Inversion Sort</a></p>
<p><a href="https://www.spoj.com/problems/ONEZERO/en/">ONEZERO - Ones and zeros</a></p>
<p><a href="https://www.spoj.com/problems/CATM/">CATM - The Cats and the Mouse</a></p>
<p><a href="https://www.spoj.com/problems/NATALIAG/">NATALIAG - Natalia Plays a Game</a></p>
<p><a href="https://www.spoj.com/problems/MULTII/">MULTII - Yet Another Multiple Problem</a></p>
<p><a href="https://codeforces.com/contest/769/problem/C">Cycle in Maze - 769C Codeforces</a></p>
<p><a href="https://codeforces.com/contest/821/problem/D">Okabe and City - 821D Codeforces</a></p>
<p><a href="https://codeforces.com/contest/796/problem/D">Police Stations - 796D Codeforces</a></p>
<p><a href="https://cses.fi/problemset/task/1193">CSES - Labyrinth</a></p>
<p><a href="https://cses.fi/problemset/task/1667/">CSES - Message Route</a></p>
<p><a href="https://cses.fi/problemset/task/1194">CSES - Monsters</a></p>
<h1 id="ung-dung-bfs-e-tim-chu-trinh-ngan-nhat-trong-o-thi-co-huong-khong-trong-so">Ứng dụng BFS để tìm chu trình ngắn nhất trong đồ thị có hướng không trọng số</h1>
<h2 id="bai-toan-6"><strong>Bài toán 6</strong></h2>
<!-- [ADACYCLE - Ada and Cycle](https://www.spoj.com/problems/ADACYCLE/) -->

<h3 id="e-bai_5"><strong>Đề bài</strong></h3>
<p>Ada đang có một chuyến đi ở Bugindia. Ở đó có nhiều thành phố và những con đường một chiều nối giữa chúng. Ada rất băn khoăn về việc tìm con đường ngắn nhất bắt đầu tại một thành phố và kết thúc ở cùng một thành phố. Vì Ada thích những chuyến đi ngắn, cô ấy đã nhờ bạn tìm độ dài của con đường như vậy cho mỗi thành phố ở Bugindia.</p>
<p><strong>Input</strong></p>
<ul>
<li>Dòng đầu tiên chứa số <span class="arithmatex">\(N\)</span> <span class="arithmatex">\((0 &lt; N \le 200)\)</span> là số lượng thành phố.</li>
<li><span class="arithmatex">\(N\)</span> dòng tiếp theo, mỗi dòng chứa <span class="arithmatex">\(N\)</span> số nguyên <span class="arithmatex">\(H_{ij}\)</span> <span class="arithmatex">\((0 \le H_{ij} \le 1)\)</span> . Nghĩa là, nếu <span class="arithmatex">\(H_{ij} = 1\)</span> thì tồn tại một con đường nối từ thành phố <span class="arithmatex">\(i\)</span> đến thành phố <span class="arithmatex">\(j\)</span>. Ngược lại, nếu <span class="arithmatex">\(H_{ij} = 0\)</span> thì không tồn tại con đường.</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>Gồm <span class="arithmatex">\(N\)</span> dòng: Dòng thứ <span class="arithmatex">\(i\)</span> in ra độ dài của con đường ngắn nhất bắt đầu từ thành phố <span class="arithmatex">\(i\)</span> và kết thúc ở thành phố <span class="arithmatex">\(i\)</span>. Nếu không tồn tại con đường nào như vậy, hãy in ra "<strong>NO WAY</strong>" để thay thế.</li>
</ul>
<h3 id="phan-tich_3"><strong>Phân tích</strong></h3>
<p>Theo yêu cầu đề bài, với mỗi thành phố, ta phải tìm độ dài con đường ngắn nhất bắt đầu và kết thúc ở cùng một thành phố đó.</p>
<p>Ta coi các thành phố là các đỉnh của đồ thị và các con đường <span class="arithmatex">\(1\)</span> chiều là các cạnh có hướng của đồ thị.</p>
<p>Đồng nghĩa với việc, với mỗi đỉnh của đồ thị, ta phải tìm độ dài của <strong>chu trình ngắn nhất</strong> chứa đỉnh đó. Vì thứ tự duyệt các đỉnh của thuật toán <span class="arithmatex">\(BFS\)</span> luôn bắt đầu duyệt từ các đỉnh gần đỉnh nguồn nhất cho đến các đỉnh nằm ở xa đỉnh nguồn. Do đó, ta có thể áp dụng <strong>tính chất</strong> này của <span class="arithmatex">\(BFS\)</span> để có thể tìm ra đỉnh <span class="arithmatex">\(u\)</span> nằm gần đỉnh nguồn nhất sao cho có cạnh nối từ <span class="arithmatex">\(u\)</span> đến đỉnh nguồn. </p>
<p>Đường đi ngắn nhất từ đỉnh nguồn đến đỉnh <span class="arithmatex">\(u\)</span>, rồi từ <span class="arithmatex">\(u\)</span> trở lại đỉnh nguồn bằng <span class="arithmatex">\(1\)</span> cạnh có hướng, chính là <strong>chu trình ngắn nhất</strong> chứa đỉnh nguồn.</p>
<h3 id="mo-ta_3"><strong>Mô tả</strong></h3>
<ul>
<li>Thực hiện <span class="arithmatex">\(BFS\)</span> bắt đầu tại đỉnh <span class="arithmatex">\(S\)</span> :</li>
</ul>
<p><a href="/uploads/breadth-first-search_gif4.gif">/uploads/breadth-first-search_gif4.gif</a></p>
<h3 id="thuat-toan_3"><strong>Thuật toán</strong></h3>
<p>Với mỗi đỉnh của đồ thị, ta thực hiện <span class="arithmatex">\(BFS\)</span> bắt đầu từ đỉnh đó. </p>
<p>Trong quá trình <span class="arithmatex">\(BFS\)</span>, ghi nhận khoảng cách từ đỉnh nguồn đến đỉnh đang duyệt, nếu gặp lại đỉnh nguồn thì đó là <strong>chu trình ngắn nhất</strong> chứa đỉnh nguồn. Lúc này, ta in ra độ dài chu trình và kết thúc <span class="arithmatex">\(BFS\)</span>, rồi bắt đầu thực hiện một <span class="arithmatex">\(BFS\)</span> mới từ đỉnh tiếp theo.</p>
<h3 id="cai-at_6"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 210</code>.</li>
<li>Mảng <code>visit[]</code> - Mảng đánh dấu các đỉnh đã thăm.</li>
<li>Mảng <code>d[]</code> - Mảng lưu lại khoảng cách từ đỉnh nguồn đến mọi đỉnh.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">210</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">visit</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">visit</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">visit</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="c1">// Nếu gặp lại đỉnh nguồn, trả ra độ dài chu trình và kết thúc BFS</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="n">visit</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">h</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ans</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;NO WAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="anh-gia_5"><strong>Đánh giá</strong></h3>
<p>Từ bài toán này, ta có thể áp dụng để <strong>tìm chu trình ngắn nhất trong đồ thị có hướng không trọng số</strong> bằng cách lấy ra chu trình ngắn nhất trong tất cả các chu trình chứa mỗi đỉnh (nhiều nhất một chu trình từ mỗi <span class="arithmatex">\(BFS\)</span> bắt đầu từ <span class="arithmatex">\(1\)</span> đỉnh).</p>
<p><strong>Độ phức tạp</strong></p>
<p>Theo đề bài, đồ thị ban đầu được biểu diễn bằng <strong>ma trận kề</strong>. Nên để tối ưu về mặt thời gian, ta sẽ chuyển đổi cách biểu diễn đồ thị thành <strong>danh sách kề</strong>.</p>
<p>Theo cách tính toán độ phức tạp thông thường, hàm <span class="arithmatex">\(BFS\)</span> sẽ mất <span class="arithmatex">\(O(N + \|E\|)\)</span>. Với <span class="arithmatex">\(\|E\|\)</span> là số cạnh của đồ thị. Trong <strong>trường hợp xấu nhất</strong>, mỗi đỉnh đều có cạnh nối tới tất cả các đỉnh của đồ thị (đồng nghĩa, <span class="arithmatex">\(H_{ij} = 1\)</span> với <span class="arithmatex">\(1 \le i, j \le N\)</span>), khi đó, số lượng cạnh của đồ thị là <span class="arithmatex">\(N^2\)</span>.</p>
<p>Vì với mỗi đỉnh của đồ thị, ta phải gọi lại hàm <span class="arithmatex">\(BFS\)</span>. Nên nhìn chung, độ phức tạp của thuật toán là <span class="arithmatex">\(O(N^3)\)</span>.</p>
<h1 id="ung-dung-bfs-e-tim-uong-i-ngan-nhat-trong-o-thi-co-trong-so-0-hoac-1">Ứng dụng BFS để tìm đường đi ngắn nhất trong đồ thị có trọng số 0 hoặc 1</h1>
<h2 id="bai-toan-7"><strong>Bài toán 7</strong></h2>
<p><a href="https://www.codechef.com/problems/REVERSE">REVERSE - Chef and Reversing</a></p>
<h3 id="e-bai_6"><strong>Đề bài</strong></h3>
<p>Cho một đồ thị có hướng <span class="arithmatex">\(N\)</span> đỉnh và <span class="arithmatex">\(M\)</span> cạnh <span class="arithmatex">\((1 \le N, M \le 10^5)\)</span>. Tìm số cạnh ít nhất cần phải đảo chiều để tồn tại đường đi từ đỉnh <span class="arithmatex">\(1\)</span> cho đến đỉnh <span class="arithmatex">\(N\)</span>.</p>
<p>Các đỉnh được đánh số từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>. Đồ thị có thể có nhiều cạnh nối giữa một cặp đỉnh. Và có thể tồn tại cạnh nối từ một đỉnh đến chính nó <em>(đồ thị có thể có khuyên)</em>.</p>
<h3 id="phan-tich_4"><strong>Phân tích</strong></h3>
<p>Gọi đồ thị ban đầu là <span class="arithmatex">\(G\)</span>.</p>
<p>Ta sẽ thêm các <strong>cạnh ngược</strong> của mỗi cạnh ban đầu trong đồ thị <span class="arithmatex">\(G\)</span> (nghĩa là, với mỗi cạnh <span class="arithmatex">\(u \to v\)</span> của đồ thị, ta sẽ thêm cạnh <span class="arithmatex">\(v \to u\)</span> vào). Cho các <strong>cạnh ngược</strong> có trọng số bằng <span class="arithmatex">\(1\)</span> và tất cả các cạnh ban đầu có trọng số bằng <span class="arithmatex">\(0\)</span>. Khi đó, ta sẽ có được đồ thị mới là đồ thị <span class="arithmatex">\(G '\)</span>.</p>
<p>Độ dài của đường đi ngắn nhất từ đỉnh <span class="arithmatex">\(1\)</span> cho đến đỉnh <span class="arithmatex">\(N\)</span> trong đồ thị <span class="arithmatex">\(G'\)</span> chính là đáp án của bài toán.
 - <strong>Chứng minh:</strong> Trong đồ thị <span class="arithmatex">\(G '\)</span>, xét từng cạnh trên một đường đi từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>. Nếu cạnh đó có trọng số là <span class="arithmatex">\(0\)</span> thì đã tồn tại cạnh đó trên đồ thị <span class="arithmatex">\(G\)</span> ban đầu, còn nếu trọng số là <span class="arithmatex">\(1\)</span> thì cạnh ngược lại của nó tồn tại trong đồ thị <span class="arithmatex">\(G\)</span>. Khi đó ta sẽ phải đảo chiều cạnh đó. Nhận thấy sau khi xét toàn bộ các cạnh, ta sẽ thu được một đường đi từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>, và số cạnh ta phải đảo chiều chính là số cạnh <span class="arithmatex">\(1\)</span> trong đường đi đó.</p>
<p>Ta sử dụng <strong>kĩ thuật 0-1 BFS</strong> :
- Nó có tên gọi như vậy vì <strong>kĩ thuật 0-1 BFS</strong> thường được sử dụng để tìm đường đi ngắn nhất trong đồ thị có trọng số <span class="arithmatex">\(0\)</span> hoặc <span class="arithmatex">\(1\)</span>.
- Khi trọng số của các cạnh bằng <span class="arithmatex">\(0\)</span> hoặc <span class="arithmatex">\(1\)</span>, thuật toán <span class="arithmatex">\(BFS\)</span> thông thường sẽ trả ra kết quả <strong>sai</strong>, vì thuật toán <span class="arithmatex">\(BFS\)</span> thông thường chỉ <strong>đúng</strong> trong đồ thị có trọng số của các cạnh <strong>bằng nhau</strong>.</p>
<p>Ta có thể chỉnh sửa một chút từ thuật toán <span class="arithmatex">\(BFS\)</span> để có được <strong>kĩ thuật 0-1 BFS</strong> :
- Trong kĩ thuật này, thay vì sử dụng mảng <em>bool</em> để đánh dấu lại các đỉnh đã duyệt, ta sẽ kiểm tra điều kiện <strong>khoảng cách ngắn nhất</strong>. Nghĩa là, trong quá trình <span class="arithmatex">\(BFS\)</span>, với mỗi đỉnh <span class="arithmatex">\(v\)</span> kề với <span class="arithmatex">\(u\)</span>, đỉnh <span class="arithmatex">\(v\)</span> chỉ được đẩy vào hàng đợi khi và chỉ khi đường đi đi ngắn nhất từ đỉnh nguồn đến <span class="arithmatex">\(v\)</span> lớn hơn đường đi ngắn nhất từ đỉnh nguồn đến <span class="arithmatex">\(u\)</span> cộng với trọng số cạnh <span class="arithmatex">\(u \to v\)</span> (khoảng cách được giảm bớt khi sử dụng cạnh này) .
- Ta sẽ sử dụng một <a href="algo/data-structures/Deque">hàng đợi hai đầu</a> <em>(deque)</em> thay cho hàng đợi <em>(queue)</em> để lưu trữ các đỉnh.  Trong quá trình <span class="arithmatex">\(BFS\)</span>, nếu ta gặp một cạnh có trọng số bằng <span class="arithmatex">\(0\)</span> thì đỉnh sẽ được đẩy vào <strong>phía trước</strong> của hàng đợi hai đầu. Ngược lại, nếu ta gặp một cạnh có trọng số bằng <span class="arithmatex">\(1\)</span> thì đỉnh sẽ được đẩy vào <strong>phía sau</strong> của hàng đợi hai đầu.
    - <strong>Giải thích:</strong> Ta <em>push</em> đỉnh kết nối bởi cạnh có trọng số <span class="arithmatex">\(0\)</span> vào đầu <em>deque</em> để giữ cho hàng đợi luôn được sắp xếp theo khoảng cách từ đỉnh nguồn tại mọi thời điểm. Bởi vì, các đỉnh ở gần đầu <em>queue/deque</em> hơn thì nó phải có khoảng cách từ gốc gần hơn, mà đỉnh ta <em>push</em> vào đầu có khoảng cách bằng chính khoảng cách đỉnh vừa <em>pop</em> ra, nên <em>deque</em> lúc này thỏa mãn tính chất của <em>queue</em> trong <span class="arithmatex">\(BFS\)</span>. 
    - Từ tính chất trên, ta có nhận xét sau: <strong>Kĩ thuật 0-1 BFS</strong> vẫn đúng cho trường hợp đồ thị có trọng số cạnh là <span class="arithmatex">\(0\)</span> hoặc <span class="arithmatex">\(x\)</span> <span class="arithmatex">\((x \ge 0)\)</span>.</p>
<p>Cách tiếp cận của <strong>kĩ thuật 0-1 BFS</strong> khá giống với thuật toán <span class="arithmatex">\(BFS\)</span> + <a href="../shortest-path/#2-thu%E1%BA%ADt-to%C3%A1n-dijkstra">Dijkstra</a>.</p>
<h3 id="cai-at_7"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>inf = 1000000000</code>.</li>
<li>Hằng số <code>maxN = 100007</code>.</li>
<li>Mảng <code>d[]</code> - Mảng lưu lại khoảng cách ngắn nhất từ đỉnh nguồn đến mỗi đỉnh.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi hai đầu <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">inf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1e9</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">inf</span><span class="p">);</span>
<span class="w">    </span><span class="n">deque</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="w">    </span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">edge</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">edge</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">});</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">bfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_6"><strong>Đánh giá</strong></h3>
<p>Ta cũng có thể giải quyết bài toán này bằng thuật toán <span class="arithmatex">\(Dijkstra\)</span> với độ phức tạp <span class="arithmatex">\(O(M \times logN)\)</span>. </p>
<p>Trong khi sử dụng <span class="arithmatex">\(BFS\)</span>, độ phức tạp sẽ là <span class="arithmatex">\(O(N + M)\)</span>. Nó tuyến tính và hiệu quả hơn thuật toán <span class="arithmatex">\(Dijkstra\)</span>.</p>
<h2 id="bai-tap-ap-dung_2"><strong>Bài tập áp dụng</strong></h2>
<p><a href="https://www.spoj.com/problems/KATHTHI/">KATHTHI - KATHTHI</a></p>
<p><a href="https://codeforces.com/problemset/problem/173/B">Chamber of Secrets - 173B</a></p>
<p><a href="https://codeforces.com/problemset/problem/590/C">Three States - 590C Codeforces</a></p>
<p><a href="https://codeforces.com/problemset/problem/877/D">Olya and Energy Drinks - 877D Codeforces</a></p>
<p><a href="https://onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=2620">UVA - Ocean Currents</a></p>
<p><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2621">UVA - Colliding Traffic</a></p>
<p><a href="https://www.e-olymp.com/en/contests/16775/problems/173743">Tram</a></p>
<p><a href="https://www.e-olymp.com/en/contests/16775/problems/173746">Jailbreak</a></p>
<p><a href="https://leetcode.com/problems/minimum-cost-to-make-at-least-one-valid-path-in-a-grid/">Minimum Cost to Make at Least One Valid Path in a Grid</a></p>
<h1 id="ung-dung-bfs-e-kiem-tra-o-thi-hai-phia-bipartite-graph">Ứng dụng BFS để kiểm tra đồ thị hai phía (Bipartite graph)</h1>
<h2 id="inh-nghia"><strong>Định nghĩa</strong></h2>
<p>Trong <em>Lý thuyết đồ thị</em>, <strong>đồ thị hai phía</strong> (<strong>đồ thị lưỡng phân</strong> hay <strong>đồ thị hai phần</strong> - <em>Bipartite graph</em>) là một đồ thị đặc biệt, trong đó tập hợp các đỉnh của đồ thị có thể được chia làm hai tập hợp <strong>không</strong> giao nhau thỏa mãn điều kiện <strong>không</strong> có cạnh nối hai đỉnh bất kỳ thuộc cùng một tập. </p>
<p>Có rất nhiều tình huống thực tế có thể mô phỏng bằng đồ thị hai phía:
- <strong>Ví dụ:</strong> Muốn biểu diễn mối quan hệ giữa một nhóm học sinh và một nhóm các trường học, ta có thể xây dựng một đồ thị với mỗi một học sinh và mỗi trường học là một đỉnh. Giữa một người <span class="arithmatex">\(A\)</span> và một trường <span class="arithmatex">\(X\)</span> sẽ có một cạnh nếu như <span class="arithmatex">\(A\)</span> đã hoặc đang đi học ở trường <span class="arithmatex">\(X\)</span>. Kiểu đồ thị này sẽ là một <strong>đồ thị hai phần</strong>, với một nhóm đỉnh là người và nhóm kia là trường; sẽ không có cạnh nối giữa hai người hoặc giữa hai trường.</p>
<p>Một tính chất thú vị của đồ thị hai phía là ta có thể tô màu các đỉnh đồ thị với hai màu sao cho không có hai đỉnh nào cùng màu kề nhau.</p>
<p><img alt="/uploads/breadth-first-search_img6.png" src="/uploads/breadth-first-search_img6.png" /></p>
<p>Bạn có thể tìm hiểu thêm về <strong>đồ thị hai phía</strong> tại <a href="https://vi.wikipedia.org/wiki/%C4%90%E1%BB%93_th%E1%BB%8B_hai_ph%C3%ADa"><strong>đây</strong></a>.</p>
<h2 id="bai-toan-8"><strong>Bài toán 8</strong></h2>
<p><a href="https://onlinejudge.org/index.php?option=onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=945">Bicoloring - UVA 10004</a></p>
<h3 id="e-bai_7"><strong>Đề bài</strong></h3>
<p>Cho một đồ thị vô hướng liên thông gồm <span class="arithmatex">\(n\)</span> đỉnh <span class="arithmatex">\((0 &lt; n &lt; 200)\)</span>. Các đỉnh được đánh số từ <span class="arithmatex">\(0\)</span> đến <span class="arithmatex">\(n-1\)</span>. Và không tồn tại cạnh nối từ một đỉnh đến chính nó <em>(đồ thị không có khuyên)</em>.</p>
<p>Bạn hãy kiểm tra xem đồ thị có thể được tô bằng <span class="arithmatex">\(2\)</span> màu hay không. Nghĩa là ta có thể gán màu (từ một bảng gồm <span class="arithmatex">\(2\)</span> màu) cho mỗi đỉnh của đồ thị theo cách sao cho không có <span class="arithmatex">\(2\)</span> đỉnh nào kề cạnh nhau có cùng màu.</p>
<h3 id="phan-tich_5"><strong>Phân tích</strong></h3>
<p>Theo đề bài, ta phải kiểm tra xem <span class="arithmatex">\(1\)</span> đồ thị có thể được tô bằng <span class="arithmatex">\(2\)</span> màu sao cho không có <span class="arithmatex">\(2\)</span> đỉnh nào kề cạnh nhau có cùng màu hay không. Điều đó tương đương với việc kiểm tra xem đồ thị đã cho có phải là <strong>đồ thị hai phía</strong> hay không.</p>
<p>Ta có thể dùng thuật toán <span class="arithmatex">\(BFS\)</span> để kiểm tra xem một đồ thị có phải đồ thị hai phía, bằng cách tìm kiếm từ một đỉnh bất kì và tô màu cho các đỉnh được xem xét. Nghĩa là, ta tô <strong>màu đen</strong> cho đỉnh gốc, tô <strong>màu xanh</strong> cho tất cả các đỉnh kề đỉnh gốc, tô <strong>màu đen</strong> cho tất cả các đỉnh kề với một đỉnh kề đỉnh gốc, và tiếp tục như vậy. Nếu ở một bước nào đó, hai đỉnh kề nhau có cùng màu, thì đồ thị <strong>không phải</strong> là hai phía. Nếu quá trình tìm kiếm kết thúc mà điều này <strong>không</strong> xảy ra thì đồ thị là hai phía.</p>
<p>Thuật toán này đúng với đồ thị liên thông. Với đồ thị gồm nhiều thành phần liên thông thì ta phải duyệt từng thành phần liên thông một như thuật toán tìm số thành phần liên thông và áp dụng thủ tục <span class="arithmatex">\(BFS\)</span> tương ứng.</p>
<h3 id="mo-ta_4"><strong>Mô tả</strong></h3>
<ul>
<li>Ví dụ mô tả đồ thị <strong>không phải</strong> là đồ thị hai phía:</li>
</ul>
<p><a href="/uploads/breadth-first-search_gif5.gif">/uploads/breadth-first-search_gif5.gif</a></p>
<ul>
<li>Ví dụ mô tả <strong>đồ thị hai phía</strong>:</li>
</ul>
<p><a href="/uploads/breadth-first-search_gif6.gif">/uploads/breadth-first-search_gif6.gif</a></p>
<h3 id="thuat-toan_4"><strong>Thuật toán</strong></h3>
<p>Để tô màu đồ thị, ta sẽ sử dụng <span class="arithmatex">\(1\)</span> mảng để lưu trạng thái của mỗi đỉnh. Có <span class="arithmatex">\(3\)</span> trạng thái:
- <strong>Trạng thái -1:</strong> Đỉnh vẫn chưa được tô màu <em>(đỉnh chưa được duyệt)</em>.
- <strong>Trạng thái 0:</strong> Đỉnh được tô màu đen.
- <strong>Trạng thái 1:</strong> Đỉnh được tô màu xanh.</p>
<p>Ban đầu, tất cả các đỉnh của đồ thị đều ở <strong>trạng thái -1</strong>.</p>
<p>Ta sử dụng <span class="arithmatex">\(BFS\)</span> để tô màu đồ thị:
- Bắt đầu từ một đỉnh bất kỳ và tô màu đen cho đỉnh đó.
- Với mỗi đỉnh <span class="arithmatex">\(v\)</span> kề với đỉnh đang xét <span class="arithmatex">\(u\)</span>, nếu đỉnh <span class="arithmatex">\(v\)</span> chưa được duyệt, ta sẽ tô màu <span class="arithmatex">\(v\)</span> ngược với màu của <span class="arithmatex">\(u\)</span> (nếu <span class="arithmatex">\(u\)</span> là màu xanh, ta sẽ tô <span class="arithmatex">\(v\)</span> màu đen và ngược lại).
- Nếu <span class="arithmatex">\(u\)</span> đã được thăm trước đó và có cùng màu với <span class="arithmatex">\(v\)</span>, ta sẽ dừng thuật toán và kết luận đồ thị <strong>không phải</strong> đồ thị hai phía.</p>
<p>Cuối cùng, nếu ta có thể tô màu tất cả các đỉnh mà <strong>không</strong> vi phạm quy tắc tô màu, ta có thể kết luận đồ thị là hai phía.</p>
<h3 id="cai-at_8"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong></p>
<ul>
<li>Hằng số <code>maxN = 210</code>.</li>
<li>Mảng <code>color[]</code> - Mảng lưu trạng thái tô màu của mỗi đỉnh.</li>
<li>Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh.</li>
<li>Hàng đợi <code>q</code> - Chứa các đỉnh sẽ được duyệt theo thứ tự ưu tiên chiều rộng.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">210</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">color</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">checkBipartiteGraph</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill_n</span><span class="p">(</span><span class="n">color</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>

<span class="w">    </span><span class="n">queue</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">){</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">            </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">checkBipartiteGraph</span><span class="p">())</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;NOT &quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;BICOLORABLE.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_7"><strong>Đánh giá</strong></h3>
<p>Ta cũng có thể sử dụng  thuật toán tìm kiếm theo chiều sâu <em>(Depth First Search – DFS)</em> để kiểm tra đồ thị hai phía.</p>
<p><strong>Độ phức tạp</strong></p>
<p>Độ phức tạp của thuật toán là <span class="arithmatex">\(O(t \times (n + l))\)</span>. Với <span class="arithmatex">\(t\)</span> là số lượng bộ test.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../js/jquery-3.7.1.min.js"></script>
      
        <script src="../../../js/webjs.js"></script>
      
    
  </body>
</html>