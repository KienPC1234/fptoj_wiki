
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/KienPC1234/fptoj_wiki/algo/graph-theory/minimum-spanning-tree/">
      
      
        <link rel="prev" href="../lubenica-vnoj/">
      
      
        <link rel="next" href="../shortest-path/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Bài toán tìm cây khung nhỏ nhất trong đồ thị - FPTOJ WIKI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bai-toan-tim-cay-khung-nho-nhat-trong-o-thi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FPTOJ WIKI" class="md-header__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FPTOJ WIKI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bài toán tìm cây khung nhỏ nhất trong đồ thị
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ tối"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ tối" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ sáng"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ sáng" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FPTOJ WIKI" class="md-nav__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    FPTOJ WIKI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trang chủ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giới thiệu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Markdown
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Thuật Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Thuật Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cơ Bản
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Cơ Bản
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/backtracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đệ quy và Thuật toán quay lui
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán tìm kiếm nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bitwise-operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phép toán bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/computational-complexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp thời gian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 1: vòng lặp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 2: bắt đầu từ đâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/meet-in-the-middle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán sắp xếp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/Tai-Lieu-Thuat-Toan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số Tài liệu hay về Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/two-pointers.md78" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật hai con trỏ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đại Số
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Đại Số
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/binary_exponentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lũy thừa nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/euclid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Euclid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/fft-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biến đổi Fourier nhanh - Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/nCk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cách tính số tổ hợp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/primality_check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kiểm tra số nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/prime_sieve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sàng nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/array-vs-linked-lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng và danh sách liên kết
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/C%C3%A2y-Palindrome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc của cây Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/data-structures-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng quan về Cấu Trúc Dữ Liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/deque-min-max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàng đợi hai đầu (deque) và Bài toán tìm max-min trong đoạn tịnh tiến
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Deque/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deque - hàng đợi hai đầu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set-union/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoints Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick-2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân 2 chiều (BIT 2 chiều)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân (Binary Indexed Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Table)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/heavy-light-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heavy-Light Decomposition (HLD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/interval-tree-tap-doan-thang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interval Tree trên tập đoạn thẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca-binlift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lowest Common Ancestor (LCA) - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các phương pháp giải bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/mo-algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/overview-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/persistent-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistent Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/prefix-sum-and-difference-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng cộng dồn và mảng hiệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/rmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Range Minimum Query (RMQ) - Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây Phân Đoạn (cơ bản)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-extend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tất tần tật về Cây Phân Đoạn (Segment Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Skip-Lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip Lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/sqrt-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack (ngăn xếp)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng hậu tố (Suffix Array)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-automaton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/trie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trie
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quy hoạch động
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Quy hoạch động
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số bài toán quy hoạch động điển hình
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/Mot-so-ky-thuat-toi-uu-hoa-thuat-toan-Quy-Hoach-Dong/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số kĩ thuật tối ưu hoá thuật toán Quy Hoạch Động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/palindrome-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một vài bài tập về Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/thac-mac-ve-qhd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phân tích về QHĐ - Thầy Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Games
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Games
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../games/Giai-Thuat-Cat-Tia-Alpha-beta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thuật cắt tỉa Alpha-beta
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hình học
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Hình học
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 1: Những khái niệm cơ bản
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 2: Sự giao nhau của đường thẳng và các ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/Sweep-Line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán đường quét
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lý thuyết Đồ Thị
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Lý thuyết Đồ Thị
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../breadth-first-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BFS (Breadth-first search)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../centroid-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán phân tách trọng tâm - Centroid decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Depth-First-Search-Tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây DFS (Depth-First Search Tree) và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-cycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi - Chu trình Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-tour-on-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi Euler trên cây
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../everything/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các chủ đề cơ bản về đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán Luồng cực đại trên mạng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lubenica-vnoj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán LUBENICA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Bài toán tìm cây khung nhỏ nhất trong đồ thị
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Bài toán tìm cây khung nhỏ nhất trong đồ thị
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mot-so-kien-thuc-can-biet" class="md-nav__link">
    <span class="md-ellipsis">
      Một số kiến thức cần biết
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cay-khung-nho-nhat-la-gi" class="md-nav__link">
    <span class="md-ellipsis">
      Cây khung nhỏ nhất là gì
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cây khung nhỏ nhất là gì">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inh-nghia" class="md-nav__link">
    <span class="md-ellipsis">
      Định nghĩa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinh-chat" class="md-nav__link">
    <span class="md-ellipsis">
      Tính chất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tính chất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chung-minh" class="md-nav__link">
    <span class="md-ellipsis">
      Chứng minh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cac-thuat-toan-tim-cay-khung-nho-nhat" class="md-nav__link">
    <span class="md-ellipsis">
      Các thuật toán tìm cây khung nhỏ nhất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Các thuật toán tìm cây khung nhỏ nhất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-thuat-toan-kruskal" class="md-nav__link">
    <span class="md-ellipsis">
      1. Thuật toán Kruskal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Thuật toán Kruskal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chung-minh-tinh-ung-an-cua-thuat-toan" class="md-nav__link">
    <span class="md-ellipsis">
      Chứng minh tính đúng đắn của thuật toán:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-thuat-toan-prim" class="md-nav__link">
    <span class="md-ellipsis">
      2. Thuật toán Prim
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mot-so-bai-toan-ap-dung" class="md-nav__link">
    <span class="md-ellipsis">
      Một số bài toán áp dụng
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Một số bài toán áp dụng">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bai-toan-nkcity" class="md-nav__link">
    <span class="md-ellipsis">
      1. Bài toán NKCITY
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Bài toán NKCITY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-phuc-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Độ phức tạp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cai-at" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bai-toan-tim-cay-khung-nho-nhat-cho-moi-canh-codeforces-609e" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bài toán tìm cây khung nhỏ nhất cho mỗi cạnh - Codeforces 609E
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Bài toán tìm cây khung nhỏ nhất cho mỗi cạnh - Codeforces 609E">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai_1" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan_1" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-mau" class="md-nav__link">
    <span class="md-ellipsis">
      Code mẫu:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bai-toan-160d-edges-in-mst" class="md-nav__link">
    <span class="md-ellipsis">
      3. Bài toán 160D - Edges in MST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Bài toán 160D - Edges in MST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai_2" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan_2" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-phuc-tap_1" class="md-nav__link">
    <span class="md-ellipsis">
      Độ phức tạp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cai-at_1" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#luyen-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Luyện tập
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shortest-path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các thuật toán về tìm đường đi ngắn nhất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topological-sort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sắp xếp Tô-pô (Topological Sort)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lý thuyết trò chơi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/Ham-Mobius/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/modular-inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4.5 - Nghịch đảo modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/multiplicative-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm nhân tính
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tìm Kiếm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Tìm Kiếm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/Local-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kỹ Năng Thi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Kỹ Năng Thi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Ki-nang-thi-cu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng hợp các lời khuyên cho các kỳ thi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Kinh-nghiem-thi-VOI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinh nghiệm thi VOI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/viet-trinh-cham/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tự code, tự chấm, tự sướng - Bí kíp thi offline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xâu kí tự
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Xâu kí tự
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xử lý xâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash: A String Matching Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán KMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/manacher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Manacher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mẹo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Mẹo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ph%E1%BB%8Fng-v%E1%BA%A5n-team-IOI-VN-2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phỏng Vấn Team IOI VN 2017
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/vojsol/ALAKE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALAKE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/convex_greedy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sum-constrained convex optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/counting-without-matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Khử nhân ma trận
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/FFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhân ma trận (Matrix multiplication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/mitm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/Roi-rac-hoa-va-ung-dung/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rời rạc hoá và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computer Science (Khoa học máy tính)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computer Science (Khoa học máy tính)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Cipher-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mật mã và Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Public-Key-Cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public Key Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/cipher/ROT13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROT13
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xử lý ảnh
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Xử lý ảnh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/Seam-Carving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seam Carving Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/setup-opencv-windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hướng dẫn cài đặt OpenCV trên Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ngôn Ngữ Lập Trình
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Ngôn Ngữ Lập Trình
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/pointers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Con trỏ trong C/C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xâu trong C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/Pascal-Vi-sao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hoài niệm về Pascal - Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dịch Thuật
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Dịch Thuật
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/functional-programming-part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming - Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/Efficient-and-easy-segment-trees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cài đặt cây phân đoạn hiệu quả (Efficient and easy segment trees)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Tables)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/palindrome-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palindrome tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/stack-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue & Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    E-Maxx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            E-Maxx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Aho-Corasick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aho Corasick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Tim-kiem-tam-phan-Ternary-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tìm kiếm tam phân - Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nâng Cao
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Nâng Cao
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Lucas-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Lucas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 2 - Số nguyên tố, Sàng Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 3 - Tính (a^b) % c
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4 - Phi hàm Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 5 - Các kiến thức cơ bản về Tổ hợp (Combinatorics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 6 - Xác suất (Probabilities)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 7 - Bao hàm - Loại trừ (Inclusion-Exclusion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/So-hoc-Phan-1-Modulo-gcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 1 - Modulo & gcd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Wilsons-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Wilson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Máy học (Machine Learning - ML)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Máy học (Machine Learning - ML)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ml/machine-learning-101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning 101 (1): Làm quen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/PyTorch-la-gi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Là Gì?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quora
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Quora
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/quora/mobius-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topcoder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Topcoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/dynamic-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhập môn Quy hoạch động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/fun-with-bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fun with Bits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Greedy-is-Good/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Tham lam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Hieu-ve-xac-suat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xác suất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Dissect-a-Topcoder-Problem-Statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ năng đọc đề Topcoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Find-a-Solution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nghệ thuật giải bài
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Mathematics-for-Topcoders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toán học trong Tin học
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/max-flow-1-luong-cuc-dai-tren-mang-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luồng cực đại trên mạng - Maxflow network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán RMQ và bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/The-Importance-of-Algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tầm Quan Trọng Của Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Using-Regular-Expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sử dụng Regex
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    USACO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            USACO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/USACO/Crafting-Winning-Solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viết lời giải chiến thắng trong kì thi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wcipeg
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            Wcipeg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Bao-l%E1%BB%93i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thích trực quan về bao lồi trên mặt phẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Binary-Heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull-Trick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật bao lồi (Convex Hull Trick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bao lồi (Convex Hull)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán luồng cực đại
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Knuth-Morris-Pratt (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây (Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mot-so-kien-thuc-can-biet" class="md-nav__link">
    <span class="md-ellipsis">
      Một số kiến thức cần biết
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cay-khung-nho-nhat-la-gi" class="md-nav__link">
    <span class="md-ellipsis">
      Cây khung nhỏ nhất là gì
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cây khung nhỏ nhất là gì">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inh-nghia" class="md-nav__link">
    <span class="md-ellipsis">
      Định nghĩa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinh-chat" class="md-nav__link">
    <span class="md-ellipsis">
      Tính chất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tính chất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chung-minh" class="md-nav__link">
    <span class="md-ellipsis">
      Chứng minh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cac-thuat-toan-tim-cay-khung-nho-nhat" class="md-nav__link">
    <span class="md-ellipsis">
      Các thuật toán tìm cây khung nhỏ nhất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Các thuật toán tìm cây khung nhỏ nhất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-thuat-toan-kruskal" class="md-nav__link">
    <span class="md-ellipsis">
      1. Thuật toán Kruskal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Thuật toán Kruskal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chung-minh-tinh-ung-an-cua-thuat-toan" class="md-nav__link">
    <span class="md-ellipsis">
      Chứng minh tính đúng đắn của thuật toán:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-thuat-toan-prim" class="md-nav__link">
    <span class="md-ellipsis">
      2. Thuật toán Prim
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mot-so-bai-toan-ap-dung" class="md-nav__link">
    <span class="md-ellipsis">
      Một số bài toán áp dụng
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Một số bài toán áp dụng">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bai-toan-nkcity" class="md-nav__link">
    <span class="md-ellipsis">
      1. Bài toán NKCITY
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Bài toán NKCITY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-phuc-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Độ phức tạp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cai-at" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bai-toan-tim-cay-khung-nho-nhat-cho-moi-canh-codeforces-609e" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bài toán tìm cây khung nhỏ nhất cho mỗi cạnh - Codeforces 609E
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Bài toán tìm cây khung nhỏ nhất cho mỗi cạnh - Codeforces 609E">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai_1" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan_1" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-mau" class="md-nav__link">
    <span class="md-ellipsis">
      Code mẫu:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bai-toan-160d-edges-in-mst" class="md-nav__link">
    <span class="md-ellipsis">
      3. Bài toán 160D - Edges in MST
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Bài toán 160D - Edges in MST">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tom-tat-e-bai_2" class="md-nav__link">
    <span class="md-ellipsis">
      Tóm tắt đề bài
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thuat-toan_2" class="md-nav__link">
    <span class="md-ellipsis">
      Thuật toán
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-phuc-tap_1" class="md-nav__link">
    <span class="md-ellipsis">
      Độ phức tạp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cai-at_1" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#luyen-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Luyện tập
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="bai-toan-tim-cay-khung-nho-nhat-trong-o-thi">Bài toán tìm cây khung nhỏ nhất trong đồ thị</h1>
<p><strong>Tác giả</strong>: 
* Hoàng Việt Cường - Đại học Bách Khoa Hà Nội
* Phan Thành Long - THPT Chuyên Thái Bình (K17-20)</p>
<p><strong>Reviewer</strong>:
Vương Hoàng Long - Đại học Quốc Gia Singapore </p>
<h2 id="mot-so-kien-thuc-can-biet">Một số kiến thức cần biết</h2>
<p>Vì bài viết nói về cây khung nhỏ nhất, các bạn nên đọc một số kiến thức liên quan đến cây trước mà mình liệt kê dưới đây vì đây là những kiến thức rất thường gặp trong những bài tập về cây khung, trong khuôn khổ bài viết mình sẽ không giải thích lại về những kiến thức này nữa:
* <a href="https://vnoi.info/wiki/translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor.md#b%C3%A0i-to%C3%A1n-lowest-common-ancestor-lca">Lowest Common Accessor</a>
* <a href="https://vnoi.info/wiki/algo/data-structures/disjoint-set.md">Disjoin Set Union</a></p>
<p><strong>Lưu ý:</strong> Toàn bộ phần code phía dưới sử dụng cho <code>C++11</code> trở lên, các bạn lưu ý kiểm tra trình biên dịch của mình.</p>
<h2 id="cay-khung-nho-nhat-la-gi">Cây khung nhỏ nhất là gì</h2>
<h3 id="inh-nghia">Định nghĩa</h3>
<p>Theo lý thuyết đồ thị, chúng ta đều biết rằng 1 đồ thị được biểu diễn bằng công thức <span class="arithmatex">\(G = (V, E)\)</span>, trong đó đồ thị <span class="arithmatex">\(G\)</span> của chúng ta bao gồm tập các đỉnh <span class="arithmatex">\(V\)</span> và tập các cạnh <span class="arithmatex">\(E\)</span>.</p>
<ul>
<li><strong>Cây khung (<em>spanning tree</em>)</strong> của đồ thị là một tập hợp các cạnh của đồ thị thỏa mãn tập cạnh này <strong><em>không chứa chu trình</em></strong> và <strong><em>liên thông</em></strong> (từ một đỉnh bất kì có thể đi tới bất kỳ đỉnh nào khác theo mà chỉ dùng các cạnh trên <strong>cây khung</strong>)</li>
<li>
<p>Trong đồ thị <strong>có trọng số</strong>, <strong>cây khung nhỏ nhất (<em>minimum spanning tree</em>)</strong> là <strong>cây khung</strong> có tổng trọng số các cạnh trong cây <strong>nhỏ nhất</strong>.</p>
</li>
<li>
<p>Một ví dụ về cây khung trong đồ thị vô hướng không trọng số:</p>
</li>
</ul>
<!--
![Đồ thị G có 3 cây khung](https://i.imgur.com/2vA7dPt.png)
-->
<p><img alt="" src="https://i.imgur.com/QqWCZO0.png" /></p>
<ul>
<li>Một ví dụ về cây khung <strong>nhỏ nhất</strong> trong đồ thị vô hướng có trọng số:
<img alt="" src="https://i.imgur.com/egYfsfI.jpg" /></li>
</ul>
<p>Trong khuôn khổ bài viết, chúng ta sẽ làm việc với <strong>đồ thị vô hướng có trọng số</strong>.</p>
<h3 id="tinh-chat">Tính chất</h3>
<p>Một vài tính chất của cây khung nhỏ nhất trong đồ thị vô hướng có trọng số:
* <strong>1. Tính chất chu trình</strong>: Trong một chu trình <span class="arithmatex">\(C\)</span> bất kỳ, nếu <span class="arithmatex">\(e\)</span> là cạnh có trọng số lớn nhất <strong>tuyệt đối</strong> (không có cạnh nào có trọng số bằng <span class="arithmatex">\(e\)</span>) thì <span class="arithmatex">\(e\)</span> không thể nằm trên bất kỳ cây khung nhỏ nhất nào.</p>
<ul>
<li>
<p><strong>2. Đường đi hẹp nhất</strong>: Xét 2 đỉnh <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(v\)</span> bất kỳ trong đồ thị. Nếu <span class="arithmatex">\(w\)</span> là trọng số của cạnh lớn nhất trên đường đi từ <span class="arithmatex">\(u\)</span> đến <span class="arithmatex">\(v\)</span> trên cây khung nhỏ nhất của đồ thị thì ta không thể tìm được đường đi nào từ <span class="arithmatex">\(u\)</span> đến <span class="arithmatex">\(v\)</span> trên đồ thị ban đầu chỉ đi qua những cạnh có trọng số nhỏ hơn <span class="arithmatex">\(w\)</span>.</p>
</li>
<li>
<p><strong>3. Tính duy nhất</strong>: Nếu tất cả các cạnh đều có trọng số khác nhau thì chỉ có duy một cây khung nhỏ nhất. Ngược lại, nếu một vài cạnh có trọng số giống nhau thì có thể có nhiều hơn một cây khung nhỏ nhất.</p>
</li>
<li>
<p><strong>4. Tính chất cạnh nhỏ nhất</strong>: Nếu <span class="arithmatex">\(e\)</span> là cạnh có trọng số nhỏ nhất của đồ thị, và không có cạnh nào có trọng số bằng <span class="arithmatex">\(e\)</span> thì <span class="arithmatex">\(e\)</span> nằm trong mọi cây khung nhỏ nhất của đồ thị.</p>
</li>
</ul>
<h4 id="chung-minh">Chứng minh</h4>
<blockquote>
<p><strong>Lưu ý :</strong> các bạn mới học cây khung lần đầu cân nhắc việc đọc chứng minh, tác giả khuyên các bạn nên tạm thời bỏ qua phần này</p>
</blockquote>
<p>Xuyên suốt cả bốn tính chất, ta đều sử dụng phép phản chứng để chứng minh
* <strong>1. Tính chất chu trình</strong>:
    Giả sử <span class="arithmatex">\(e\)</span> thuộc một cây khung <span class="arithmatex">\(T\)</span> của đồ thị, ta sẽ chứng minh luôn tồn tại một cây khung khác của đồ thị có trọng số nhỏ hơn <span class="arithmatex">\(T\)</span>. 
    - Ta thử xóa cạnh <span class="arithmatex">\(e\)</span> khỏi cây khung <span class="arithmatex">\(T\)</span>. Lúc này, <span class="arithmatex">\(T\)</span> sẽ bị chia làm 2 thành phần liên thông và tổng trọng số giảm đi <span class="arithmatex">\(w_e\)</span>.
    - Xét các đỉnh nằm trong chu trình <span class="arithmatex">\(C\)</span>, giả sử sau khi xóa <span class="arithmatex">\(e\)</span> khỏi cây khung, các đỉnh này vẫn liên thông với nhau. Vì thế, khi thêm <span class="arithmatex">\(e\)</span> trở lại vào cây khung, <span class="arithmatex">\(e\)</span> sẽ kết nối 2 đỉnh đã liên thông với nhau <span class="arithmatex">\(\Rightarrow\)</span> tồn tại chu trình trong cây khung <span class="arithmatex">\(\Rightarrow\)</span> Trái với giả thiết <span class="arithmatex">\(T\)</span> là cây khung. 
    ⇒ Vậy nên, khi xóa <span class="arithmatex">\(e\)</span> khỏi <span class="arithmatex">\(T\)</span>, các đỉnh nằm trong chu trình <span class="arithmatex">\(C\)</span> sẽ bị tách làm 2 thành phần liên thông. Do đó, ta có thể chọn ra cạnh <span class="arithmatex">\(e'\)</span> khác <span class="arithmatex">\(e\)</span> thuộc chu trình <span class="arithmatex">\(C\)</span> để kết nối 2 thành liên thông này, biến <span class="arithmatex">\(T\)</span> trở lại thành một cây khung của đồ thị. Mặt khác, <span class="arithmatex">\(e\)</span> là cạnh có trọng số lớn nhất tuyệt đối trên <span class="arithmatex">\(C\)</span>, nên khi thay <span class="arithmatex">\(e\)</span> bằng <span class="arithmatex">\(e'\)</span>, trọng số của T sẽ giảm đi <span class="arithmatex">\(w_e - w_{e'}\)</span>
    <strong>Kết luận:</strong> T không phải là cây khung nhỏ nhất của đồ thị.</p>
<ul>
<li><strong>2. Đường đi hẹp nhất</strong>: <ul>
<li>Xét cây khung nhỏ nhất <span class="arithmatex">\(T\)</span> bất kỳ của đồ thị <span class="arithmatex">\(G\)</span> mà tồn tại đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(G\)</span> có cạnh lớn nhất <strong>nhỏ hơn</strong> cạnh lớn nhất của đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(T\)</span>. </li>
<li>Gọi đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(G\)</span> là <span class="arithmatex">\(path\)</span>, cạnh lớn nhất của đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(T\)</span> là <span class="arithmatex">\(e\)</span>. 
⇒ Như vậy, nếu xóa <span class="arithmatex">\(e\)</span> khỏi cây khung ban đầu, cây khung sẽ bị chia thành 2 TPLT rời nhau, một TPLT chứa <span class="arithmatex">\(u\)</span> và TPLT còn lại chứa <span class="arithmatex">\(v\)</span>. </li>
<li>Do <span class="arithmatex">\(path\)</span> là đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(G\)</span> nên trên <span class="arithmatex">\(path\)</span> sẽ tồn tại cạnh <span class="arithmatex">\(e'\)</span> có thể kết nối 2 TPLT này. Mà mọi cạnh trên <span class="arithmatex">\(path\)</span> đều có trọng số nhỏ hơn <span class="arithmatex">\(e\)</span> (như giả thiết) 
⇒ Khi xoá <span class="arithmatex">\(e\)</span> và thay bằng <span class="arithmatex">\(e'\)</span>, ta sẽ thu được 1 cây khung <span class="arithmatex">\(T'\)</span> có trọng số nhỏ hơn cây khung ban đầu 
<strong>Kết luận:</strong> <span class="arithmatex">\(T\)</span> không phải cây khung nhỏ nhất của đồ thị.</li>
</ul>
</li>
<li>
<p><strong>3. Tính duy nhất</strong>: </p>
<ul>
<li>Giả sử tồn tại 2 cây khung nhỏ nhất <span class="arithmatex">\(T\)</span> và <span class="arithmatex">\(T'\)</span>. Xét cạnh <span class="arithmatex">\(u-v\)</span> nằm trong <span class="arithmatex">\(T\)</span> nhưng không trong <span class="arithmatex">\(T'\)</span>. </li>
<li>Gọi đường đi <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(T\)</span> là <span class="arithmatex">\(path\)</span>, trên <span class="arithmatex">\(T'\)</span> là <span class="arithmatex">\(path'\)</span>. Hiển nhiên, <span class="arithmatex">\(path'\)</span> không chứa cạnh <span class="arithmatex">\(u-v\)</span>. </li>
<li>Vì trọng số các cạnh của đồ thị đều khác nhau <span class="arithmatex">\(\Rightarrow\)</span> Cạnh lớn nhất của <span class="arithmatex">\(path\)</span> sẽ có trọng số lớn hơn trọng số cạnh lớn nhất của <span class="arithmatex">\(path'\)</span> hoặc ngược lại.
⇒ Theo tính chất đường đi hẹp nhất, <span class="arithmatex">\(T\)</span> hoặc <span class="arithmatex">\(T'\)</span> sẽ không phải là cây khung nhỏ nhất. </li>
</ul>
</li>
<li>
<p><strong>4. Tính chất cạnh nhỏ nhất</strong>: 
    &gt; Ta sẽ chứng minh mọi cây khung không chứa <span class="arithmatex">\(e\)</span> của đồ thị đều không phải là cây khung nhỏ nhất.</p>
<ul>
<li>Giả sử <span class="arithmatex">\(e\)</span> nối 2 đỉnh <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(v\)</span> của đồ thị. Gọi <span class="arithmatex">\(T\)</span> là 1 cây khung không chứa <span class="arithmatex">\(e\)</span> của đồ thị. </li>
<li>Xét cạnh <span class="arithmatex">\(e'\)</span> bất kỳ thuộc đường đi từ <span class="arithmatex">\(u \rightarrow v\)</span> trên <span class="arithmatex">\(T\)</span>. Khi xóa <span class="arithmatex">\(e'\)</span> khỏi <span class="arithmatex">\(T\)</span>, <span class="arithmatex">\(T\)</span> sẽ bị tách làm 2 thành phần liên thông, 1 thành phần liên thông chứa <span class="arithmatex">\(u\)</span>, 1 phần phần liên thông chứa <span class="arithmatex">\(v\)</span>. 
⇒ Do đó, ta hoàn toàn có thể thêm cạnh <span class="arithmatex">\(e\)</span> (nối 2 đỉnh <span class="arithmatex">\(u- v\)</span>) vào <span class="arithmatex">\(T\)</span> để kết nối 2 thành phần liên thông này, khi đó <span class="arithmatex">\(T\)</span> sẽ trở lại thành 1 cây khung của đồ thị.</li>
<li>Mặt khác, <span class="arithmatex">\(e\)</span> là cạnh có trọng số nhỏ nhất tuyệt đối của đồ thị, nên khi thay <span class="arithmatex">\(e'\)</span> bằng <span class="arithmatex">\(e\)</span> trên cây khung <span class="arithmatex">\(T\)</span>, trọng số của <span class="arithmatex">\(T\)</span> sẽ giảm đi 1 lượng dương 
<strong>Kết luận:</strong> <span class="arithmatex">\(T\)</span> ban đầu không phải là cây khung nhỏ nhất của đồ thị.</li>
</ul>
</li>
</ul>
<h2 id="cac-thuat-toan-tim-cay-khung-nho-nhat">Các thuật toán tìm cây khung nhỏ nhất</h2>
<h3 id="1-thuat-toan-kruskal">1. Thuật toán Kruskal</h3>
<p><strong>Ý tưởng thuật toán</strong>: Ban đầu mỗi đỉnh là một cây riêng biệt, ta tìm cây khung nhỏ nhất bằng cách duyệt các cạnh theo trọng số từ nhỏ đến lớn, rồi hợp nhất các cây lại với nhau.</p>
<p>Cụ thể hơn, giả sử cạnh đang xét nối 2 đỉnh <span class="arithmatex">\(u\)</span> và <span class="arithmatex">\(v\)</span>, nếu 2 đỉnh này nằm ở 2 cây khác nhau thì ta thêm cạnh này vào cây khung, đồng thời hợp nhất 2 cây chứa <span class="arithmatex">\(u\)</span> và <span class="arithmatex">\(v\)</span>.</p>
<p>Giả sử ta cần tìm cây khung nhỏ nhất của đồ thị <span class="arithmatex">\(G\)</span>. Thuật toán bao gồm các bước sau:
* Khởi tạo rừng <span class="arithmatex">\(F\)</span> (tập hợp các cây), trong đó mỗi đỉnh của G tạo thành một cây riêng biệt.
* Khởi tạo tập <span class="arithmatex">\(S\)</span> chứa tất cả các cạnh của <span class="arithmatex">\(G\)</span>.
* Chừng nào <span class="arithmatex">\(S\)</span> còn <strong>khác rỗng</strong> và <span class="arithmatex">\(F\)</span> gồm <strong>hơn một cây</strong>
    *  Xóa cạnh nhỏ nhất trong <span class="arithmatex">\(S\)</span>
    *  Nếu cạnh đó nối hai cây khác nhau trong <span class="arithmatex">\(F\)</span>, thì thêm nó vào <span class="arithmatex">\(F\)</span> và hợp hai cây kề với nó làm một
    *  Nếu không thì loại bỏ cạnh đó.</p>
<p>Khi thuật toán kết thúc, rừng chỉ gồm đúng một cây và đó là một cây khung nhỏ nhất của đồ thị <span class="arithmatex">\(G\)</span></p>
<p>Ví dụ các bước giải bài toán tìm cây khung nhỏ nhất với thuật toán Kruskal :
<img alt="" src="https://i.imgur.com/ZvvusBq.gif" /></p>
<!--
![](https://i.imgur.com/J6J8NhG.gif)
![](https://i.imgur.com/5T4aefO.png)
![](https://i.imgur.com/0TUNAZD.png)
![](https://i.imgur.com/qmLu49x.png)
![](https://i.imgur.com/gAZe9Uq.png)
-->

<p>Để thực hiện thao tác kiểm tra cạnh và hợp nhất 2 cây một cách nhanh chóng, ta sử dụng cấu trúc <strong><a href="https://vnoi.info/wiki/algo/data-structures/disjoint-set.md">Disjoint Set</a></strong>, dưới đây là đoạn code dùng để cài đặt thuật toán:
<div class="highlight"><pre><span></span><code><span class="cm">/*input</span>
<span class="cm">4 4</span>
<span class="cm">1 2 1</span>
<span class="cm">2 3 2</span>
<span class="cm">3 4 3</span>
<span class="cm">4 1 4</span>
<span class="cm">*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="c1">// Cấu trúc để lưu các cạnh đồ thị</span>
<span class="c1">// u, v là 2 đỉnh, c là trọng số cạnh</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Edge</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="n">Edge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_c</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Dsu</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">par</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">dsu</span><span class="p">;</span>

<span class="c1">// n và m là số đỉnh và số cạnh</span>
<span class="c1">// totalWeight là tổng trọng số các cạnh trong cây khung nhỏ nhất</span>
<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Fast IO</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Sắp xếp lại các cạnh theo trọng số tăng dần</span>
<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="p">[](</span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Duyệt qua các cạnh theo thứ tự đã sắp xếp</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">edges</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Nếu không hợp nhất được 2 đỉnh u và v thì bỏ qua</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Nếu hợp nhất được u, v ta thêm trọng số cạnh vào kết quả</span>
<span class="w">        </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Xuất ra kết quả</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="chung-minh-tinh-ung-an-cua-thuat-toan">Chứng minh tính đúng đắn của thuật toán:</h4>
<p>Ta phải chứng minh hai điều: 
1. đầu ra của thuật toán là một cây khung
2. cây đó có trọng số nhỏ nhất trong số tất cả các cây khung của đồ thị.</p>
<p><strong>Chứng minh (1)</strong>
- Mỗi cạnh <span class="arithmatex">\((u, v)\)</span> được xét đến, nó chỉ kết nạp vào câu khung nếu <span class="arithmatex">\(u, v\)</span> thuộc 2 thành phần liên thông khác nhau <span class="arithmatex">\(T_u, T_v\)</span> ⇒ Do đó các cạnh được thêm không tạo thành chu trình
- Do <span class="arithmatex">\(T\)</span> không có chu trình ⇒ số cạnh được thêm <span class="arithmatex">\(≤ n - 1\)</span>. Ta sẽ chứng minh <span class="arithmatex">\(T\)</span> có đúng <span class="arithmatex">\(n - 1\)</span> cạnh
    - Giả sử số cạnh được thêm <span class="arithmatex">\(&lt; n - 1\)</span> ⇒ <span class="arithmatex">\(T\)</span> gồm hai hay nhiều thành phần liên thông
    - Mặt khác, do <span class="arithmatex">\(G\)</span> liên thông ⇒ tồn tại các cạnh thuộc <span class="arithmatex">\(G\)</span> nối các thành phần liên thông đó mà không thuộc <span class="arithmatex">\(T\)</span>. Do đó cạnh đầu tiên nhỏ nhất trong số các cạnh này sẽ được đưa vào do nó không tạo thành chu trình, mâu thuẫn với giả thiết ở trên ⇒ Giả sử sai
    - Vậy số cạnh được thêm vào bằng đúng <span class="arithmatex">\(n - 1\)</span></p>
<p><strong>Chứng minh (2)</strong></p>
<blockquote>
<p><strong><em>Lưu ý</em></strong> : Nếu bạn mới học cây khung lần đầu tiên chưa nên đọc ngay chứng minh này, vì chúng có thể khiến bạn hoang mang. Chứng minh có sử dụng một số khái niệm như <strong><em>lát cắt</em></strong>, <strong><em>lát cắt hẹp nhất</em></strong></p>
</blockquote>
<p>Trong chứng minh này, mình có quy ước sử dụng một số kí hiệu: 
* <span class="arithmatex">\(\|A\|\)</span> : số lượng phần tử có trong tập hợp <span class="arithmatex">\(A\)</span>
* <span class="arithmatex">\(A - B\)</span> : tập hợp các phần tử thuộc <span class="arithmatex">\(A\)</span> mà không thuộc <span class="arithmatex">\(B\)</span></p>
<p>Giờ cùng đi vào chi tiết chứng minh nhé (づ◔ ͜ʖ◔)づ
- Gọi <span class="arithmatex">\(T\)</span> là cây khung đầu ra của thuật toán Kruskal và <span class="arithmatex">\(T^\*\)</span> là một cây khung nhỏ nhất, ta sẽ chứng minh tổng trọng số trên <span class="arithmatex">\(T\)</span> và <span class="arithmatex">\(T^\*\)</span> bằng nhau : <span class="arithmatex">\(c(T)\)</span> = <span class="arithmatex">\(c(T^\*)\)</span>
- Nếu <span class="arithmatex">\(c(T)\)</span> = <span class="arithmatex">\(c(T^\*)\)</span> ⇒ hiển nhiên đúng
- Nếu <span class="arithmatex">\(c(T)\)</span> ≠ <span class="arithmatex">\(c(T^\*)\)</span> gọi <span class="arithmatex">\((u, v)\)</span> là cạnh <span class="arithmatex">\(\in\)</span> <span class="arithmatex">\(T\)</span> mà <span class="arithmatex">\(\notin\)</span> <span class="arithmatex">\(T^\*\)</span> hay thuộc <span class="arithmatex">\(T - T^\*\)</span>. Gọi <span class="arithmatex">\(S\)</span> là thành phần liên thông chứa u tại thời điểm <span class="arithmatex">\((u, v)\)</span> được thêm vào <span class="arithmatex">\(T\)</span>.
    <strong>Nhận xét:</strong> 
    Dễ thấy nếu xóa cạnh <span class="arithmatex">\((u, v)\)</span> trên <span class="arithmatex">\(T\)</span> thì sẽ tách thành 2 <strong>thành phần liên thông</strong> <span class="arithmatex">\(S\)</span> và <span class="arithmatex">\(G - S\)</span>. 
    Đây là một <strong>lát cắt</strong>, ta có thể thêm bất cứ cạnh nào nối giữa 2 <strong>thành phần liên thông</strong> này để tạo thành một cây mới ⇒ <span class="arithmatex">\((u, v)\)</span> <span class="arithmatex">\(\in\)</span> lát cắt <span class="arithmatex">\((S, G - S)\)</span>.
    &gt; <strong>Định nghĩa :</strong> Một lát cắt <span class="arithmatex">\(s\)</span> - <span class="arithmatex">\(t\)</span> là một tập con của 𝐸 mà khi loại bỏ những cạnh này thì không còn đường đi từ <span class="arithmatex">\(s\)</span> tới <span class="arithmatex">\(t\)</span>. (<a href="https://vnoi.info//wiki/translate/wcipeg/Flows#bài-toán-lát-cắt-hẹp-nhất-minimun-s-t-cut">Bài toán lát cắt hẹp nhất</a>)</p>
<pre><code>Ta sẽ chứng minh $(u, v)$ thuộc **lát cắt nhỏ nhất** $(S, G - S)$
- Nếu tồn tại đường đi trọng số $e$ từ $S$ đến $G - S$ có trọng số nhỏ hơn $(u, v)$, thuật toán kruskal sẽ chọn $e$ thay vì $(u, v)$ ⇒ vô lý.
⇒ *Ta khẳng định $(u, v)$ có **trọng số nhỏ nhất** trong các cạnh từ $S$ đến $(G - S)$.* **(1)**
- Mặt khác, bởi vì $T^\*$ là 1 cây khung nhỏ nhất nên  có một đường từ $S$ tới $G - S$, gọi cạnh thuộc đường này là $(x, y)$. Xét cây khung :
${T^\*}' = T^\* \cup (u, v) - (x, y)$ ⇒ $c({T^\*}') = c(T^\*) + c(u, v) - c(x, y)$
- Do theo **(1)** có:  $c(u, v) ≤ c(x, y)$ nên $c({T^\*}') ≤ c(T^\*)$ mà $T^\*$ là cây khung nhỏ nhất ⇒ $c({T^\*}')$ = $c(T^\*)$ và ${T^\*}'$ cũng là **cây khung nhỏ nhất** ⇒ $|T - {T^\*}'|$ = $|T - T^\*| - 1$
***Ý nghĩa :** Như vậy ta đã biến đổi được **cây khung nhỏ nhất** ${T^\*}$ thành cây khung ${T^\*}'$ cũng là **cây khung nhỏ nhất** mà làm giảm số cạnh khác nhau của $T$ và ${T^\*}$ đi 1 cạnh*
- Lặp lại cách chứng minh với mỗi cạnh thuộc $T - {T^\*}'$, ta sẽ biến đổi được ${T^\*}'$ thành ${T}$, hay nói cách khác đã đã biến đổi cây khung nhỏ nhất ban đầu về cây khung đầu ra của Kruskal : $c(T) = c(T^\*)$.
</code></pre>
<p><strong>Đánh giá độ phức tạp thuật toán:</strong> 
Gọi <span class="arithmatex">\(n\)</span> là số đỉnh, <span class="arithmatex">\(m\)</span> là số cạnh của đồ thị</p>
<p>Thuật toán gồm 2 phần: 
* Sắp xếp mảng <span class="arithmatex">\(m\)</span> cạnh theo trọng số tăng dần mất độ phức tạp <span class="arithmatex">\(O(m \log{m})\)</span>.
* Ta duyệt <span class="arithmatex">\(m\)</span> cạnh, mỗi cạnh dùng Disjoint Set mất độ phức tạp <span class="arithmatex">\(O(\log{n})\)</span>, vậy tổng cộng mất độ phức tạp <span class="arithmatex">\(O(m\log{n})\)</span>.</p>
<p><span class="arithmatex">\(\Rightarrow\)</span> độ phức tạp của thuật toán Kruskal là <span class="arithmatex">\(O(m\log{m} +m\log{n})\)</span></p>
<h3 id="2-thuat-toan-prim">2. Thuật toán Prim</h3>
<p><strong>Ý tưởng thuật toán</strong>: Ý tưởng của thuật toán Prim rất giống với ý tưởng của thuật toán Dijkstra (tìm đường đi ngắn nhất trên đồ thị). 
Nếu như thuật toán <strong>Kruskal</strong> xây dựng cây khung nhỏ nhất bằng cách kết nạp từng <strong>cạnh</strong> vào đồ thị thì thuật toán <strong>Prim</strong> lại kết nạp từng <strong>đỉnh</strong> vào đồ thị theo tiêu chí: đỉnh được nạp vào tiếp theo phải <strong>chưa được nạp</strong> và <strong>gần nhất</strong> với các đỉnh đã được nạp vào đồ thị.</p>
<p>Thuật toán bao gồm các bước sau:
* Khởi tạo tập <span class="arithmatex">\(S\)</span> là cây khung hiện tại, ban đầu <strong>S</strong> chưa có đỉnh nào.
* Khởi tạo mảng <span class="arithmatex">\(D\)</span> trong đó <span class="arithmatex">\(D_i\)</span> là khoảng cách ngắn nhất từ đỉnh <span class="arithmatex">\(i\)</span> đến 1 đỉnh đã được kết nạp vào tập <span class="arithmatex">\(S\)</span>, ban đầu <span class="arithmatex">\(D[i]\)</span> = <span class="arithmatex">\(+\infty\)</span>
* Lặp lại các thao tác sau <span class="arithmatex">\(n\)</span> lần(<span class="arithmatex">\(n\)</span> là số cạnh của đồ thị)
    *  Tìm đỉnh <span class="arithmatex">\(u\)</span> không thuộc <span class="arithmatex">\(S\)</span> có <span class="arithmatex">\(D_u\)</span> nhỏ nhất, thêm <span class="arithmatex">\(u\)</span> vào tập <span class="arithmatex">\(S\)</span>.
    *  Xét tất cả các đỉnh <span class="arithmatex">\(v\)</span> kề <span class="arithmatex">\(u\)</span>, cập nhật <span class="arithmatex">\(D_v = min(D_v, w_{u,v})\)</span> với <span class="arithmatex">\(w_{u,v}\)</span> là trọng số cạnh <span class="arithmatex">\(u-v\)</span>. Nếu <span class="arithmatex">\(D_v\)</span> được cập nhật theo <span class="arithmatex">\(w_{u,v}\)</span> thì đánh dấu <span class="arithmatex">\(trace_v = u\)</span>.
    *  Thêm cạnh <span class="arithmatex">\(u-trace[u]\)</span> vào tập cạnh thuộc cây khung nhỏ nhất.</p>
<p>Mặc dù không bắt buộc, các bạn có thể đọc chứng minh tính đúng đắn thuật toán của Wiki tại <a href="https://vi.wikipedia.org/wiki/Thu%E1%BA%ADt_to%C3%A1n_Prim#Ch%E1%BB%A9ng_minh">đây</a>.</p>
<p>Khi hoàn thành xong <span class="arithmatex">\(n\)</span> bước trên, ta thu được cây khung nhỏ nhất của đồ thị gồm <span class="arithmatex">\(n\)</span> đỉnh và <span class="arithmatex">\(n - 1\)</span> cạnh.</p>
<p>Ví dụ các bước giải bài toán tìm cây khung nhỏ nhất với thuật toán Prim:
<img alt="" src="https://i.imgur.com/E8xqn14.gif" /></p>
<p>Đoạn code sử dụng để cài đặt thuật toán Prim:
<div class="highlight"><pre><span></span><code><span class="cm">/*input</span>
<span class="cm">4 4</span>
<span class="cm">1 2 1</span>
<span class="cm">2 3 2</span>
<span class="cm">3 4 3</span>
<span class="cm">4 1 4</span>
<span class="cm">*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;bits/stdc++.h&quot;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>
<span class="cp">#define fi first</span>
<span class="cp">#define se second</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e9</span><span class="p">;</span>

<span class="c1">// khai báo đồ thị. g[u] chứa các cạnh nối với đỉnh u. Các cạnh sẽ được lưu dưới dạng pair&lt;v,c&gt;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="w"> </span><span class="c1">// mảng d lưu khoảng cách của toàn bộ đỉnh</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">prim</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// thuật toán Prim bắt đầu chạy từ đỉnh nguồn s</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Sử dụng priority_queue lưu khoảng cách của các đỉnh tăng dần đối với cây khung</span>
<span class="w">    </span><span class="c1">// Vì priority_queue.top luôn là phần tử lớn nhất, ta sẽ phải sử dụng greater&lt;pair&lt;int,int&gt;&gt;</span>
<span class="w">    </span><span class="c1">// để priority_queue.top là phần tử nhỏ nhất</span>
<span class="w">    </span><span class="c1">// các phần tử lưu trong priority queue sẽ có dạng pair&lt;dis[u],u&gt;</span>
<span class="w">    </span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">greater</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// khởi tạo khoảng cách của các đỉnh là vô cùng lớn</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INF</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// khởi tạo đỉnh nguồn có khoảng cách là 0 và push đỉnh này vào</span>
<span class="w">    </span><span class="n">dis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">});</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// lấy đỉnh có khoảng cách nhỏ nhất chưa được kết nạp</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">curDis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">curDis</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// kết nạp đỉnh u vào cây khung</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">INF</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// cập nhất khoảng cách cho các đỉnh kề u</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">                </span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="w"> </span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="w"> </span><span class="n">v</span><span class="p">});</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">});</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">prim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
Đánh giá độ phức tạp thuật toán: 
- Ta duyệt tổng cộng <span class="arithmatex">\(n\)</span> lần, mỗi lần lấy 1 đỉnh ra khỏi heap mất <span class="arithmatex">\(O(\log{n})\)</span> và cập nhật trọng số của tất cả các đỉnh kề với đỉnh đó, tổng số lần cập nhật là <span class="arithmatex">\(m\)</span> lần, mỗi lần cập nhật ta mất độ phức tạp <span class="arithmatex">\(O(\log{n})\)</span>. 
- Như vậy, độ phức tạp của thuật toán Prim là <span class="arithmatex">\(O((m + n)\log{n})\)</span> với n là số đỉnh và m là số cạnh của đồ thị.</p>
<p><strong>Fact</strong>: Trong các bài toán tìm cây khung, phần lớn mọi người sẽ sử dụng thuật toán <strong>Kruskal</strong> do tính dễ cài đặt cũng như dễ hiểu của nó. </p>
<blockquote>
<p><strong>Bonus :</strong> Các bạn có thể sử dụng <a href="https://visualgo.net/en/mst">Visualgo</a> để  mô phỏng thuật toán Kruskal và Prim thông qua hoạt ảnh, qua đó hiểu thêm về các thuật toán trên</p>
</blockquote>
<h2 id="mot-so-bai-toan-ap-dung">Một số bài toán áp dụng</h2>
<h3 id="1-bai-toan-nkcity">1. Bài toán <a href="https://oj.vnoi.info/problem/nkcity">NKCITY</a></h3>
<h4 id="tom-tat-e-bai">Tóm tắt đề bài</h4>
<p>1 thành phố gồm <span class="arithmatex">\(N\)</span> trọng điểm, <span class="arithmatex">\(M\)</span> tuyến đường có thể được xây dựng với chi phí xây dựng khác nhau. Yêu cầu chọn ra một số tuyến đường sao cho <span class="arithmatex">\(N\)</span> trọng điểm phải được liên thông với nhau và chi phí xây dựng tuyến đường lớn nhất là nhỏ nhất có thể.</p>
<h4 id="thuat-toan">Thuật toán</h4>
<p>Dựa vào tính chất <strong>đường đi hẹp nhất</strong> của cây khung mà ta đã trình bày ở trên, đường đi giữa 2 đỉnh <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(v\)</span> bất kỳ trên cây khung nhỏ nhất là đường đi có cạnh lớn nhất là nhỏ nhất của đồ thị. 
Như vậy việc chọn ra các tuyến đường để xây dựng chỉ đơn giản là chọn các cạnh trên cây khung nhỏ nhất của đồ thị.</p>
<h4 id="o-phuc-tap">Độ phức tạp</h4>
<p>Chính là độ phức tạp của thuật toán tìm cây khung nhỏ nhất mà các bạn sẽ cài đặt. </p>
<h4 id="cai-at">Cài đặt</h4>
<p>Ở đây ta sẽ dùng Kruskal để tìm cây khung nhỏ nhất
<div class="highlight"><pre><span></span><code><span class="cm">/*input</span>
<span class="cm">4 4</span>
<span class="cm">1 2 1</span>
<span class="cm">2 3 2</span>
<span class="cm">3 4 3</span>
<span class="cm">4 1 4</span>
<span class="cm">*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Edge</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="n">Edge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_c</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Dsu</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">par</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">dsu</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">maxWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="p">[](</span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">edges</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="n">maxWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">maxWeight</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">maxWeight</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<h3 id="2-bai-toan-tim-cay-khung-nho-nhat-cho-moi-canh-codeforces-609e">2. Bài toán <a href="https://codeforces.com/contest/609/problem/E">tìm cây khung nhỏ nhất cho mỗi cạnh - Codeforces 609E</a></h3>
<h4 id="tom-tat-e-bai_1">Tóm tắt đề bài</h4>
<p>Cho đồ thị vô hướng <span class="arithmatex">\(G\)</span> gồm <span class="arithmatex">\(n\)</span> đỉnh và <span class="arithmatex">\(m\)</span> cạnh. Yêu cầu với mỗi cạnh trong đồ thị, tìm cây khung nhỏ nhất <strong>chứa cạnh đó</strong> của đồ thị và in ra trọng số của cây khung đó.</p>
<p>Đây là 1 bài tập khá kinh điển về cây khung nhỏ nhất. Để giải được bài tập này, chúng ta cần giải bài LUBENICA trước. Các bạn có thể đọc thêm về bài ở <a href="lubenica-vnoj">đây</a></p>
<h4 id="thuat-toan_1">Thuật toán:</h4>
<ul>
<li>Đầu tiên, ta dựng cây khung nhỏ nhất <span class="arithmatex">\(S\)</span> của đồ thị ban đầu:</li>
<li>Sau đó, ta lần lượt đi tìm cây khung nhỏ nhất chứa mỗi cạnh của đồ thị. Với 1 cạnh i nối 2 đỉnh <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(v\)</span> với trọng số <span class="arithmatex">\(w\)</span>, có 2 trường hợp xảy ra:<ul>
<li>Cạnh <span class="arithmatex">\(u-v\)</span> đã thuộc cây khung nhỏ nhất <span class="arithmatex">\(S\)</span> ban đầu, cây khung cần tìm chính là <span class="arithmatex">\(S\)</span>.</li>
<li>Cạnh <span class="arithmatex">\(u-v\)</span> không thuộc cây khung nhỏ nhất <span class="arithmatex">\(S\)</span>. Như vậy nếu thêm cạnh <span class="arithmatex">\(u-v\)</span> vào cây khung sẽ tạo thành chu trình từ <span class="arithmatex">\(u\rightarrow v\)</span>. Do đó ta phải xóa đi 1 cạnh trên chu trình này để đảm bảo tính chất của cây khung. Và đương nhiên để tối ưu thì ta sẽ chọn xóa đi cạnh có <strong>trọng số lớn nhất</strong> trên đường đi từ <span class="arithmatex">\(u \rightarrow v\)</span> (đã được trình bày trong bài LUBENICA ở trên) và thêm cạnh <span class="arithmatex">\(u-v\)</span> vào cây khung sau khi đã xóa cạnh đó.</li>
</ul>
</li>
</ul>
<h4 id="code-mau">Code mẫu:</h4>
<div class="highlight"><pre><span></span><code><span class="cm">/*input</span>
<span class="cm">8 10</span>
<span class="cm">8 7 11</span>
<span class="cm">3 5 23</span>
<span class="cm">2 1 23</span>
<span class="cm">7 2 13</span>
<span class="cm">6 4 18</span>
<span class="cm">1 4 20</span>
<span class="cm">8 4 17</span>
<span class="cm">2 8 8</span>
<span class="cm">3 2 9</span>
<span class="cm">5 6 29</span>
<span class="cm">*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>
<span class="cp">#define fi first</span>
<span class="cp">#define se second</span>
<span class="cp">#define bit(x, k) (1ll&amp;(x &gt;&gt; k))</span>

<span class="k">using</span><span class="w"> </span><span class="n">ll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="n">ll</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e18</span><span class="p">;</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Edge</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="n">Edge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_id</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Data</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">par</span><span class="p">;</span><span class="w"> </span><span class="n">ll</span><span class="w"> </span><span class="n">maxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">INF</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Dsu</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">par</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">dsu</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">ll</span><span class="w"> </span><span class="n">mstWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="w"> </span><span class="n">ll</span><span class="w"> </span><span class="n">res</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="n">pair</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">Data</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">21</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// tìm cạnh có trọng số lớn nhất trên đường đi u, v như bài LUBENICA</span>
<span class="n">ll</span><span class="w"> </span><span class="nf">lca</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ll</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">INF</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">);</span>
<span class="w">            </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">({</span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">});</span>
<span class="w">            </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">({</span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">buildMST</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="p">[](</span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">edges</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">});</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">});</span>
<span class="w">        </span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">// đánh dấu là cạnh này thuộc cây khung nhỏ nhất</span>
<span class="w">        </span><span class="n">mstWeight</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">buildLCA</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">u</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
<span class="w">            </span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">[</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">maxc</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// dựng cây khung nhỏ nhất</span>
<span class="w">    </span><span class="n">buildMST</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// dựng LCA</span>
<span class="w">    </span><span class="n">buildLCA</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// tìm cây khung nhỏ nhất cho từng cạnh</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">edges</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mstWeight</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mstWeight</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lca</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// in ra kết quả</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="3-bai-toan-160d-edges-in-mst">3. Bài toán <a href="https://codeforces.com/problemset/problem/160/D">160D - Edges in MST</a></h3>
<h4 id="tom-tat-e-bai_2">Tóm tắt đề bài</h4>
<p>Cho đồ thị vô hướng có trọng số <span class="arithmatex">\(G\)</span> gồm <span class="arithmatex">\(n\)</span> đỉnh và <span class="arithmatex">\(m\)</span> cạnh. Yêu cầu với mỗi cạnh trong đồ thị, kiểm tra xem cạnh đó <strong>không thuộc</strong> bất kỳ cây khung nhỏ nhất nào, thuộc <strong>một số</strong> cây khung nhỏ nhất hay nằm trong <strong>mọi</strong> cây khung nhỏ nhất của đồ thị.</p>
<h4 id="thuat-toan_2">Thuật toán</h4>
<ul>
<li>Ban đầu, khởi tạo đồ thị <span class="arithmatex">\(G'\)</span> rỗng. Ta sẽ xét lần lượt từng nhóm các cạnh có cùng trọng số và thêm chúng vào đồ thị <span class="arithmatex">\(G'\)</span>. Đồng thời, với mỗi cạnh ta không quan tâm nó nối 2 đỉnh nào mà chỉ quan tâm nó nối 2 <strong>TPLT</strong> nào trong đồ thị hiện tại. </li>
<li>Nhận xét rằng nếu có cạnh kết nối 2 <strong>TPLT khác nhau</strong>, các cạnh này sẽ xuất hiện trong <strong>ít nhất</strong> 1 cây khung nhỏ nhất. Ngược lại, nếu 1 cạnh nối 2 đỉnh <strong>đã liên thông</strong> từ trước thì cạnh này sẽ <strong>không thuộc</strong> bất kỳ cây khung nhỏ nhất nào.</li>
<li>Xét các nhóm cạnh có <strong>cùng trọng số</strong> mà thuộc <strong>2 thành phần liên thông khác nhau</strong>, ta dựng đồ thị <span class="arithmatex">\(G\)</span> mới từ các nhóm cạnh đó với các đỉnh là các thành phần liên thông.</li>
<li><strong>Dễ thấy</strong> : Chọn tập cạnh từ <span class="arithmatex">\(G\)</span> để thêm vào cây khung, tập cạnh đó phải thỏa mãn  không tạo ra chu trình và không làm tăng thành phần liên thông của <span class="arithmatex">\(G\)</span> bởi vì : <ul>
<li>Nếu tập cạnh chọn chứa chu trình thì đầu ra không còn là cây khung</li>
<li>Nếu tập cạnh làm tăng số lượng thành phần liên thông của <span class="arithmatex">\(G\)</span> thì cây khung sẽ mất tính <strong>nhỏ nhất</strong> </li>
</ul>
</li>
<li>Vậy cạnh nằm trong <strong>mọi cây khung</strong> sẽ phải là cạnh mà nằm trong <strong>mọi tập cạnh</strong> mình chọn ở trên, nếu tập cạnh thiếu nó thì vi phạm tính <strong>nhỏ nhất</strong>. 
⇒ Có nghĩa là nếu thiếu cạnh đó thì sẽ làm tăng <strong>thành phần liên thông</strong> của <span class="arithmatex">\(G\)</span>. Vậy đó chỉ có thể là <strong>cạnh cầu</strong>.</li>
<li>Kết luận : <ul>
<li>Các <strong>cạnh cầu</strong> sẽ nằm trong <strong>mọi</strong> cây khung nhỏ nhất của đồ thị</li>
<li>Các cạnh còn lại <strong>không phải cạnh cầu</strong> sẽ thuộc <strong>một số</strong> cây khung nhỏ nhất</li>
<li><strong>Xem thêm</strong> : <a href="https://vnoi.info/wiki/algo/graph-theory/Depth-First-Search-Tree.md#tìm-cạnh-cầu">Tìm cạnh cầu</a></li>
</ul>
</li>
</ul>
<h4 id="o-phuc-tap_1">Độ phức tạp</h4>
<ul>
<li>Đầu tiên, ta phải sắp xếp lại các cạnh theo trọng số tăng dần mất đpt <span class="arithmatex">\(O(m\log{m})\)</span>. Sau đó, ta phải duy trì 1 đồ thị hiện tại trong quá trình lần lượt thêm các nhóm cạnh vào đồ thị, ở đây ta sử dụng <strong>Disjoint Set</strong> để kiểm tra 2 đỉnh nối 2 TPLT nào cũng như thêm các cạnh vào đồ thị hiện tại.</li>
<li>Thuật toán <strong>Tarjan</strong> để tìm <strong>cầu</strong> có độ phức tạp <span class="arithmatex">\(O(m + n)\)</span> cho toàn đồ thị 
⇒ Như vậy, độ phức tạp tổng của bài toán là <span class="arithmatex">\(O(m\log{m} + m\log{n} + n)\)</span>.</li>
</ul>
<h4 id="cai-at_1">Cài đặt</h4>
<div class="highlight"><pre><span></span><code><span class="cm">/*input</span>
<span class="cm">4 5</span>
<span class="cm">1 2 101</span>
<span class="cm">1 3 100</span>
<span class="cm">2 3 2</span>
<span class="cm">2 4 2</span>
<span class="cm">3 4 1</span>
<span class="cm">*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;bits/stdc++.h&quot;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>
<span class="cp">#define fi first</span>
<span class="cp">#define se second</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="k">enum</span><span class="w"> </span><span class="nc">EdgeType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NONE</span><span class="p">,</span><span class="w"> </span><span class="c1">// không cây nào chứa</span>
<span class="w">    </span><span class="n">ANY</span><span class="p">,</span><span class="w"> </span><span class="c1">// tất cả các cây đều chứa</span>
<span class="w">    </span><span class="n">ATL</span><span class="w"> </span><span class="c1">// ít nhất 1 cây chứa</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Edge</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="n">Edge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_v</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_c</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_id</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span><span class="w"> </span><span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Dsu</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">par</span><span class="p">;</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">dsu</span><span class="p">;</span>

<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="n">EdgeType</span><span class="w"> </span><span class="n">res</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">Time</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// nếu cạnh là cầu thì mọi cây đều phải chứa</span>
<span class="w">                </span><span class="n">res</span><span class="p">[</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EdgeType</span><span class="o">::</span><span class="n">ANY</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// xử lý các nhóm cạnh có cùng trọng số</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pen</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// khởi tạo đồ thị nối các thành phần liên thông</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pen</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// sử dụng đỉnh cha trong dsu làm đỉnh đại diện cho thành phần liên thông</span>
<span class="w">        </span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">num</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// nếu 2 đỉnh cùng thuộc 1 thành phần liên thông</span>
<span class="w">            </span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EdgeType</span><span class="o">::</span><span class="n">NONE</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// nếu 2 đỉnh nối 2 thành phần liên thông khác nhau lại với nhau</span>
<span class="w">            </span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EdgeType</span><span class="o">::</span><span class="n">ATL</span><span class="p">;</span>
<span class="w">            </span><span class="c1">// thêm cạnh vào đồ thị</span>
<span class="w">            </span><span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">});</span>
<span class="w">            </span><span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// tìm cạnh cầu</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pen</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// sau khi hoàn thành, ta thực hiện hợp các cạnh vào cây khung</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pen</span><span class="p">)</span><span class="w"> </span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="p">[](</span><span class="n">Edge</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Edge</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pen</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">edges</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pen</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pen</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">pen</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">solve</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
<span class="w">            </span><span class="n">pen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">e</span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">solve</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// in ra kết quả</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EdgeType</span><span class="o">::</span><span class="n">NONE</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;none</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EdgeType</span><span class="o">::</span><span class="n">ANY</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;any</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;at least one</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="luyen-tap">Luyện tập</h2>
<p>Các bạn có thể thử sức với một số bài tập sau:
* <a href="https://www.spoj.com/PTIT/problems/P186SUMF/">P186SUMF</a> - <a href="https://codeforces.com/problemset/problem/959/E">959E</a>
* <a href="https://vn.spoj.com/problems/VMST/">VMST</a>
* <a href="https://codeforces.com/group/FLVn1Sc504/contest/274809/problem/B">C11WATER</a>
* <a href="https://codeforces.com/group/FLVn1Sc504/contest/274809/problem/M">CHEER</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../js/jquery-3.7.1.min.js"></script>
      
        <script src="../../../js/webjs.js"></script>
      
    
  </body>
</html>