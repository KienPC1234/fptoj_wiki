
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/KienPC1234/fptoj_wiki/algo/graph-theory/Depth-First-Search-Tree/">
      
      
        <link rel="prev" href="../centroid-decomposition/">
      
      
        <link rel="next" href="../euler-cycle/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Cây DFS (Depth-First Search Tree) và ứng dụng - FPTOJ WIKI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cay-dfs-depth-first-search-tree-va-ung-dung" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FPTOJ WIKI" class="md-header__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FPTOJ WIKI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cây DFS (Depth-First Search Tree) và ứng dụng
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ tối"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ tối" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ sáng"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ sáng" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FPTOJ WIKI" class="md-nav__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    FPTOJ WIKI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trang chủ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giới thiệu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Markdown
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Thuật Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Thuật Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cơ Bản
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Cơ Bản
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/backtracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đệ quy và Thuật toán quay lui
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán tìm kiếm nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bitwise-operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phép toán bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/computational-complexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp thời gian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 1: vòng lặp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 2: bắt đầu từ đâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/meet-in-the-middle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán sắp xếp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/Tai-Lieu-Thuat-Toan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số Tài liệu hay về Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/two-pointers.md78" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật hai con trỏ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đại Số
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Đại Số
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/binary_exponentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lũy thừa nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/euclid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Euclid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/fft-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biến đổi Fourier nhanh - Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/nCk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cách tính số tổ hợp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/primality_check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kiểm tra số nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/prime_sieve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sàng nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/array-vs-linked-lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng và danh sách liên kết
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/C%C3%A2y-Palindrome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc của cây Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/data-structures-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng quan về Cấu Trúc Dữ Liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/deque-min-max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàng đợi hai đầu (deque) và Bài toán tìm max-min trong đoạn tịnh tiến
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Deque/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deque - hàng đợi hai đầu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set-union/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/disjoint-set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoints Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick-2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân 2 chiều (BIT 2 chiều)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/fenwick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân (Binary Indexed Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Table)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/heavy-light-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heavy-Light Decomposition (HLD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/interval-tree-tap-doan-thang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interval Tree trên tập đoạn thẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca-binlift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lowest Common Ancestor (LCA) - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/lca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các phương pháp giải bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/mo-algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/overview-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/persistent-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistent Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/prefix-sum-and-difference-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng cộng dồn và mảng hiệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/rmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Range Minimum Query (RMQ) - Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây Phân Đoạn (cơ bản)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/segment-tree-extend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tất tần tật về Cây Phân Đoạn (Segment Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Skip-Lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip Lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/sqrt-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/Stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack (ngăn xếp)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng hậu tố (Suffix Array)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/suffix-automaton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-structures/trie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trie
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quy hoạch động
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Quy hoạch động
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số bài toán quy hoạch động điển hình
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/Mot-so-ky-thuat-toi-uu-hoa-thuat-toan-Quy-Hoach-Dong/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số kĩ thuật tối ưu hoá thuật toán Quy Hoạch Động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/palindrome-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một vài bài tập về Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/thac-mac-ve-qhd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phân tích về QHĐ - Thầy Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Games
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Games
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../games/Giai-Thuat-Cat-Tia-Alpha-beta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thuật cắt tỉa Alpha-beta
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hình học
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Hình học
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 1: Những khái niệm cơ bản
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 2: Sự giao nhau của đường thẳng và các ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/Sweep-Line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán đường quét
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lý thuyết Đồ Thị
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Lý thuyết Đồ Thị
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../breadth-first-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BFS (Breadth-first search)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../centroid-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán phân tách trọng tâm - Centroid decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Cây DFS (Depth-First Search Tree) và ứng dụng
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-cycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi - Chu trình Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-tour-on-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi Euler trên cây
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../everything/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các chủ đề cơ bản về đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán Luồng cực đại trên mạng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lubenica-vnoj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán LUBENICA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../minimum-spanning-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán tìm cây khung nhỏ nhất trong đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shortest-path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các thuật toán về tìm đường đi ngắn nhất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topological-sort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sắp xếp Tô-pô (Topological Sort)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lý thuyết trò chơi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/Ham-Mobius/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/modular-inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4.5 - Nghịch đảo modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/multiplicative-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm nhân tính
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tìm Kiếm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Tìm Kiếm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/Local-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kỹ Năng Thi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Kỹ Năng Thi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Ki-nang-thi-cu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng hợp các lời khuyên cho các kỳ thi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Kinh-nghiem-thi-VOI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinh nghiệm thi VOI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/viet-trinh-cham/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tự code, tự chấm, tự sướng - Bí kíp thi offline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xâu kí tự
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Xâu kí tự
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xử lý xâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash: A String Matching Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán KMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/manacher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Manacher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mẹo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Mẹo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ph%E1%BB%8Fng-v%E1%BA%A5n-team-IOI-VN-2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phỏng Vấn Team IOI VN 2017
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/vojsol/ALAKE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALAKE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/convex_greedy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sum-constrained convex optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/counting-without-matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Khử nhân ma trận
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/FFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhân ma trận (Matrix multiplication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/mitm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/Roi-rac-hoa-va-ung-dung/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rời rạc hoá và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computer Science (Khoa học máy tính)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computer Science (Khoa học máy tính)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Cipher-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mật mã và Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Public-Key-Cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public Key Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/cipher/ROT13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROT13
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xử lý ảnh
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Xử lý ảnh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/Seam-Carving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seam Carving Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/setup-opencv-windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hướng dẫn cài đặt OpenCV trên Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ngôn Ngữ Lập Trình
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Ngôn Ngữ Lập Trình
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/pointers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Con trỏ trong C/C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xâu trong C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/Pascal-Vi-sao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hoài niệm về Pascal - Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dịch Thuật
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Dịch Thuật
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/functional-programming-part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming - Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/Efficient-and-easy-segment-trees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cài đặt cây phân đoạn hiệu quả (Efficient and easy segment trees)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Tables)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/palindrome-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palindrome tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/stack-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue & Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    E-Maxx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            E-Maxx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Aho-Corasick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aho Corasick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Tim-kiem-tam-phan-Ternary-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tìm kiếm tam phân - Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nâng Cao
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Nâng Cao
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Lucas-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Lucas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 2 - Số nguyên tố, Sàng Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 3 - Tính (a^b) % c
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4 - Phi hàm Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 5 - Các kiến thức cơ bản về Tổ hợp (Combinatorics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 6 - Xác suất (Probabilities)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 7 - Bao hàm - Loại trừ (Inclusion-Exclusion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/So-hoc-Phan-1-Modulo-gcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 1 - Modulo & gcd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Wilsons-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Wilson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Máy học (Machine Learning - ML)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Máy học (Machine Learning - ML)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ml/machine-learning-101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning 101 (1): Làm quen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/PyTorch-la-gi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Là Gì?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quora
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Quora
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/quora/mobius-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topcoder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Topcoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/dynamic-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhập môn Quy hoạch động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/fun-with-bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fun with Bits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Greedy-is-Good/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Tham lam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Hieu-ve-xac-suat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xác suất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Dissect-a-Topcoder-Problem-Statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ năng đọc đề Topcoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Find-a-Solution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nghệ thuật giải bài
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Mathematics-for-Topcoders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toán học trong Tin học
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/max-flow-1-luong-cuc-dai-tren-mang-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luồng cực đại trên mạng - Maxflow network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán RMQ và bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/The-Importance-of-Algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tầm Quan Trọng Của Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Using-Regular-Expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sử dụng Regex
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    USACO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            USACO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/USACO/Crafting-Winning-Solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viết lời giải chiến thắng trong kì thi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wcipeg
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            Wcipeg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Bao-l%E1%BB%93i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thích trực quan về bao lồi trên mặt phẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Binary-Heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull-Trick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật bao lồi (Convex Hull Trick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bao lồi (Convex Hull)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán luồng cực đại
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Knuth-Morris-Pratt (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây (Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cay-dfs-depth-first-search-tree-va-ung-dung">Cây DFS (Depth-First Search Tree) và ứng dụng</h1>
<p><strong>Tác giả:</strong>
- <strong>Nguyễn Châu Khanh</strong> - THPT Chuyên Hùng Vương - Phú Thọ
- <strong>Bùi Minh Hoạt</strong> - THPT Chuyên Hùng Vương - Phú Thọ
- <strong>Trần Thế Hưng</strong> - THPT Chuyên Biên Hòa - Hà Nam</p>
<p><strong>Reviewer:</strong>
- <strong>Đỗ Đình Đắc</strong> - Đại học Bách Khoa Hà Nội </p>
<h1 id="mo-au">Mở đầu</h1>
<ul>
<li>Bài viết này sẽ giúp bạn tìm hiểu về cây <span class="arithmatex">\(DFS\)</span> <em>(Depth First Search Tree – DFS Tree)</em>. Cây <span class="arithmatex">\(DFS\)</span> là một ứng dụng quan trọng có được từ kỹ thuật duyệt đồ thị ưu tiên chiều sâu, giúp giải các bài toán tìm khớp cầu và thành phần liên thông mạnh.</li>
</ul>
<h1 id="cay-duyet-chieu-sau-dfs-cay-dfs">Cây duyệt chiều sâu DFS (cây DFS)</h1>
<ul>
<li>Trong quá trình <span class="arithmatex">\(DFS\)</span>, với mỗi đỉnh <span class="arithmatex">\(u\)</span> ta có đỉnh <span class="arithmatex">\(par[u]\)</span> là số hiệu của đỉnh mà từ đỉnh đó thủ tục <span class="arithmatex">\(DFS\)</span> gọi đệ quy đến <span class="arithmatex">\(u\)</span>. Xây dựng đồ thị con với các cạnh là <span class="arithmatex">\((par[u], u)\)</span> ta có được một cây. Cây này được gọi là <strong>cây <em>DFS</em></strong>.</li>
<li>Các cạnh thuộc cây <span class="arithmatex">\(DFS\)</span> được gọi là các “cạnh nét liền”. </li>
<li>Các cạnh còn lại không thuộc cây <span class="arithmatex">\(DFS\)</span> được gọi là các “cạnh nét đứt".</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img1.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img1.png" /></p>
<ul>
<li>
<p>Trong đồ thị có hướng, xét các cung được thăm và không được thăm bởi <span class="arithmatex">\(DFS\)</span>, ta có <span class="arithmatex">\(4\)</span> loại cung sau:</p>
<ul>
<li>Cung của cây <span class="arithmatex">\(DFS\)</span> <strong><em>(Tree edge)</em></strong>:  là các cung thuộc cây <span class="arithmatex">\(DFS\)</span> được định hướng theo chiều từ cha đến con. (ví dụ cạnh <span class="arithmatex">\((u,v)\)</span> thuộc cây <span class="arithmatex">\(DFS\)</span> mà <span class="arithmatex">\(u\)</span> được thăm trước <span class="arithmatex">\(v\)</span> hay <span class="arithmatex">\(u\)</span> là cha của <span class="arithmatex">\(v\)</span> thì ta có cung <span class="arithmatex">\(u \rightarrow v\)</span> là cung của cây <span class="arithmatex">\(DFS\)</span>). <em><span class="arithmatex">\(&lt;\)</span> Các cung của cây <span class="arithmatex">\(DFS\)</span> được đánh dấu là các cạnh màu đen trong hình bên dưới <span class="arithmatex">\(&gt;\)</span></em></li>
<li>Cung xuôi <strong><em>(Forward edge)</em></strong>: là các cung không thuộc cây <span class="arithmatex">\(DFS\)</span> và có dạng <span class="arithmatex">\(u \rightarrow v\)</span> trong đó <span class="arithmatex">\(u\)</span> là tổ tiên của <span class="arithmatex">\(v\)</span> trong cây <span class="arithmatex">\(DFS\)</span>. <em><span class="arithmatex">\(&lt;\)</span> Các cung xuôi được đánh dấu là các cạnh màu xanh lá trong hình bên dưới <span class="arithmatex">\(&gt;\)</span></em></li>
<li>Cung ngược <strong><em>(Back edge)</em></strong>: là các cung không thuộc cây <span class="arithmatex">\(DFS\)</span> và có dạng <span class="arithmatex">\(v \rightarrow u\)</span> trong đó <span class="arithmatex">\(u\)</span> là tổ tiên của <span class="arithmatex">\(v\)</span> trong cây <span class="arithmatex">\(DFS\)</span>. <em><span class="arithmatex">\(&lt;\)</span> Các cung ngược được đánh dấu là các cạnh màu đỏ trong hình bên dưới <span class="arithmatex">\(&gt;\)</span></em></li>
<li>Cung chéo <strong><em>(Cross edge)</em></strong>: là các cung không thuộc cây <span class="arithmatex">\(DFS\)</span> có dạng <span class="arithmatex">\(u \rightarrow v\)</span> trong đó <span class="arithmatex">\(u\)</span> và <span class="arithmatex">\(v\)</span> thuộc hai nhánh khác nhau của cùng một cây <span class="arithmatex">\(DFS\)</span>. <em><span class="arithmatex">\(&lt;\)</span> Các cung chéo được đánh dấu là các cạnh màu xanh dương trong hình bên dưới <span class="arithmatex">\(&gt;\)</span></em></li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img2.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img2.png" /></p>
</li>
<li>
<p>Trong đồ thị vô hướng:</p>
<ul>
<li>Không tồn tại cung chéo. Vì khi đỉnh <span class="arithmatex">\(u\)</span> được duyệt trong hàm <span class="arithmatex">\(DFS\)</span> ta sẽ duyệt tất cả các đỉnh <span class="arithmatex">\(v\)</span> kề <span class="arithmatex">\(u\)</span> mà <span class="arithmatex">\(v\)</span> chưa được thăm. Như vậy nếu tồn tại một cung chéo <span class="arithmatex">\((u, v)\)</span> chứng tỏ khi duyệt đến đỉnh <span class="arithmatex">\(u\)</span> hoặc đỉnh <span class="arithmatex">\(v\)</span> ta đã không duyệt cạnh <span class="arithmatex">\((u, v)\)</span>. </li>
<li>Vì các cạnh trên đồ thị vô hướng không được định chiều nên không thể định nghĩa <span class="arithmatex">\(2\)</span> loại cung xuôi và cung ngược như ở đồ thị có hướng. Do đó, ở đồ thị vô hướng, cung xuôi và cung ngược sẽ được định nghĩa như sau:<ul>
<li>Cung xuôi <strong><em>(Forward edge)</em></strong>: là các cung thuộc cây <span class="arithmatex">\(DFS\)</span>. Hay còn có cách gọi khác là "cạnh nét liền" hoặc "cung của cây <span class="arithmatex">\(DFS\)</span>".</li>
<li>Cung ngược <strong><em>(Back edge)</em></strong>: là các cung không thuộc cây <span class="arithmatex">\(DFS\)</span>. Hay còn có cách gọi khác là "cạnh nét đứt". </li>
</ul>
</li>
<li>Như vậy trên đồ thị vô hướng lúc này chỉ còn <span class="arithmatex">\(2\)</span> loại cung là cung ngược và cung xuôi (cung của cây <span class="arithmatex">\(DFS\)</span>). </li>
</ul>
</li>
</ul>
<p><strong>Một số mảng quan trọng trong cây DFS :</strong></p>
<ul>
<li>Mảng <span class="arithmatex">\(num\)</span>[]: cho biết thứ tự duyệt <span class="arithmatex">\(DFS\)</span> của các đỉnh (thứ tự mà mỗi đỉnh bắt đầu duyệt).</li>
<li>Mảng <span class="arithmatex">\(low\)</span>[]: Với mỗi đỉnh <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(low[u]\)</span> cho biết thứ tự (giá trị <span class="arithmatex">\(num\)</span>) nhỏ nhất có thể đi đến được từ <span class="arithmatex">\(u\)</span> bằng cách đi xuôi xuống theo các cạnh nét liền (các cung trên cây <span class="arithmatex">\(DFS\)</span>) và kết thúc đi ngược lên không quá <span class="arithmatex">\(1\)</span> lần theo cạnh nét đứt. Ngoài ra ta cũng có thể hiểu ý nghĩa của <span class="arithmatex">\(low[u]\)</span> là thứ tự thăm của đỉnh có thứ tự thăm sớm nhất nằm trong cây con gốc <span class="arithmatex">\(u\)</span> hoặc kề cạnh với <span class="arithmatex">\(1\)</span> đỉnh bất kì nằm trong cây con gốc <span class="arithmatex">\(u\)</span>.</li>
<li>Mảng <span class="arithmatex">\(tail\)</span>[]: cho biết thời điểm kết thúc duyệt <span class="arithmatex">\(DFS\)</span> của mỗi đỉnh cũng là thời điểm duyệt xong của đỉnh đó . </li>
</ul>
<p><strong>Nhận xét :</strong> Các đỉnh có thứ tự thăm nằm trong khoảng từ <span class="arithmatex">\(num[u]\)</span> đến <span class="arithmatex">\(tail[u]\)</span> chính là các đỉnh nằm trong cây con gốc <span class="arithmatex">\(u\)</span> trong cây <span class="arithmatex">\(DFS\)</span>.</p>
<p><strong>Cách tính mảng low[], num[], tail[] :</strong></p>
<ul>
<li><strong>Ý tưởng chính :</strong> Mảng <span class="arithmatex">\(num[],tail[]\)</span> ta có thể tính dễ dàng bằng cách <span class="arithmatex">\(DFS\)</span> xác định thời điểm duyệt tới và thời điểm duyệt xong của các đỉnh. Với mảng <span class="arithmatex">\(low[]\)</span> ta có: <ul>
<li>Trước hết, với <span class="arithmatex">\(1\)</span> đỉnh <span class="arithmatex">\(u\)</span> bất kì có thể tự đi tới chính nó nên ta gán <span class="arithmatex">\(low[u]=num[u]\)</span>.</li>
<li>Từ <span class="arithmatex">\(u\)</span> có thể đến các đỉnh <span class="arithmatex">\(v\)</span> kề <span class="arithmatex">\(u\)</span> bằng <span class="arithmatex">\(1\)</span> cạnh nét đứt nên ta có <span class="arithmatex">\(low[u]=min(low[u],num[v])\)</span> với <span class="arithmatex">\((u,v)\)</span> là một cạnh nét đứt.</li>
<li>Ngược lại, nếu <span class="arithmatex">\((u,v)\)</span> là một cạnh nét liền và <span class="arithmatex">\(v\)</span> không phải cha <span class="arithmatex">\(u\)</span> ta có <span class="arithmatex">\(low[u]=min(low[u],low[v])\)</span> do từ <span class="arithmatex">\(u\)</span> ta có thể đi xuống <span class="arithmatex">\(v\)</span> sau đó đi theo con đường đã xác định ở đỉnh <span class="arithmatex">\(v\)</span> để tới đỉnh có thứ tự thăm là <span class="arithmatex">\(low[v]\)</span>.</li>
</ul>
</li>
<li><strong><em>Chú ý</em></strong>: Giá trị thực sự của <span class="arithmatex">\(num[u]\)</span> được xác định khi duyệt tới đỉnh <span class="arithmatex">\(u\)</span> còn giá trị thực sự của <span class="arithmatex">\(low[u],\)</span> <span class="arithmatex">\(tail[u]\)</span> chỉ được xác định khi đã duyệt xong đỉnh <span class="arithmatex">\(u\)</span>. Thời điểm duyệt tới của một đỉnh <span class="arithmatex">\(u\)</span> luôn diễn ra trước thời điểm duyệt tới của các đỉnh trong cây con gốc <span class="arithmatex">\(u\)</span> của cây <span class="arithmatex">\(DFS\)</span> , thời điểm duyệt xong của đỉnh <span class="arithmatex">\(u\)</span> luôn diễn ra sau thời điểm duyệt xong của các đỉnh trong cây con gốc <span class="arithmatex">\(u\)</span>. </li>
<li><strong>Cách thực hiện :</strong><ul>
<li>Đầu tiên ta sẽ bắt đầu duyệt <span class="arithmatex">\(DFS\)</span> từ đỉnh gốc. Khi duyệt tới đỉnh <span class="arithmatex">\(u\)</span> ta sẽ cập nhật thời điểm duyệt tới. Lúc này <span class="arithmatex">\(low[u] = num[u] =\)</span> <strong>thứ tự duyệt <em>DFS</em></strong>. Ta sẽ duyệt tất cả các con <span class="arithmatex">\(v\)</span> trong gốc <span class="arithmatex">\(u\)</span>. </li>
<li><strong>Trường hợp 1:</strong> Nếu đỉnh <span class="arithmatex">\(v\)</span> chưa được thăm thì sau khi hoàn thành <span class="arithmatex">\(DFS\)</span> của <span class="arithmatex">\(v\)</span> thì ta sẽ cập nhật lại giá trị của <span class="arithmatex">\(low [u]\)</span>: <span class="arithmatex">\(low [u] = min (low[u], low[v]);\)</span></li>
<li><strong>Trường hợp 2:</strong> Nếu đỉnh <span class="arithmatex">\(v\)</span> đã được thăm, thì ta sẽ cập nhật lại giá trị cho <span class="arithmatex">\(low[u]\)</span>: <span class="arithmatex">\(low [u] = min (low [u], num[v]);\)</span><ul>
<li>Ở trường hợp này ta không thể cập nhật <span class="arithmatex">\(low[u] = min(low[u], low[v])\)</span> được. Vì khi ta thăm đến đỉnh <span class="arithmatex">\(u\)</span> mà đỉnh <span class="arithmatex">\(v\)</span> đã được thăm thì tức là <span class="arithmatex">\((u,v)\)</span> là một cạnh nét đứt, do đó khi đi từ <span class="arithmatex">\(u\)</span> tới <span class="arithmatex">\(v\)</span> ta đã sử dụng <span class="arithmatex">\(1\)</span> cạnh nét đứt nên không thể tiếp tục di chuyển nữa (theo định nghĩa của mảng <span class="arithmatex">\(low[]\)</span> ) suy ra ta chỉ cập nhật <span class="arithmatex">\(low[u]=min(low[u],num[v])\)</span>. </li>
</ul>
</li>
<li><em>*</em><strong>Chú ý : Nếu v là cha trực tiếp của u thì ta bỏ qua không xét đến.</strong><em>*</em> </li>
<li>Khi đã duyệt xong đỉnh <span class="arithmatex">\(u\)</span> và các nút trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(u\)</span> ta sẽ tiến hành cập nhật giá trị <span class="arithmatex">\(tail[u]=\)</span> <strong>thời gian duyệt <em>DFS</em> hiện tại</strong>.</li>
</ul>
</li>
<li><strong>Cài đặt :</strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// Thứ tự duyệt DFS</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tail</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeDfs</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<ul>
<li>
<p><strong>Ví dụ minh họa :</strong></p>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img3.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img3.png" /></p>
</li>
<li>
<p><strong>Mô tả quá trình :</strong></p>
<p><a href="/fptoj_wiki/uploads/Depth-First-Search-Tree_gif1.gif">/fptoj_wiki/uploads/Depth-First-Search-Tree_gif1.gif</a></p>
</li>
</ul>
<h1 id="ung-dung-cay-dfs-trong-bai-toan-tim-khop-cau">Ứng dụng cây DFS trong bài toán tìm khớp, cầu</h1>
<h2 id="inh-nghia">Định nghĩa</h2>
<ul>
<li>Trong đồ thị vô hướng, một đỉnh được gọi là đỉnh khớp nếu như loại bỏ đỉnh này và các cạnh liên thuộc với nó ra khỏi đồ thị thì số thành phần liên thông của đồ thị tăng lên.</li>
<li>
<p>Trong đồ thị vô hướng, một cạnh được gọi là cạnh cầu nếu như loại bỏ cạnh này ra khỏi đồ thị thì số thành phần liên thông của đồ thị tăng lên.</p>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img4.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img4.png" /></p>
</li>
</ul>
<h2 id="bai-toan-1">Bài toán 1</h2>
<p><a href="https://oj.vnoi.info/problem/graph_">GRAPH_ - Tìm khớp và cầu (Cơ bản)</a></p>
<h3 id="e-bai"><strong>Đề bài</strong></h3>
<p>Xét đơn đồ thị vô hướng <span class="arithmatex">\(G=(V, E)\)</span> có <span class="arithmatex">\(N\)</span> <span class="arithmatex">\((1 \le N \le 10000)\)</span> đỉnh và <span class="arithmatex">\(M\)</span> <span class="arithmatex">\((1 \le M \le 50000)\)</span> cạnh. Người ta định nghĩa một đỉnh gọi là khớp nếu như xoá đỉnh đó sẽ làm tăng số thành phần liên thông của đồ thị. Tương tự như vậy, một cạnh được gọi là cầu nếu xoá cạnh đó sẽ làm tăng số thành phần liên thông của đồ thị.</p>
<p>Vấn đề đặt ra là cần phải đếm tất cả các khớp và cầu của đồ thị <span class="arithmatex">\(G\)</span>.</p>
<p><strong>Input</strong></p>
<ul>
<li>Dòng đầu: chứa hai số tự nhiên <span class="arithmatex">\(N, M\)</span>.</li>
<li><span class="arithmatex">\(M\)</span> dòng sau mỗi dòng chứa một cặp số <span class="arithmatex">\((u, v)\)</span> <span class="arithmatex">\((u\)</span> khác <span class="arithmatex">\(v\)</span>, <span class="arithmatex">\(1 \le u \le N, 1 \le v \le N)\)</span> mô tả một cạnh của <span class="arithmatex">\(G\)</span>.</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>Gồm một dòng duy nhất ghi hai số, số thứ nhất là số khớp, số thứ hai là số cầu của <span class="arithmatex">\(G\)</span>.</li>
</ul>
<p><strong>Example</strong> </p>
<p><strong>Input</strong>
<div class="highlight"><pre><span></span><code>10 12
1 10
10 2
10 3
2 4
4 5
5 2
3 6
6 7
7 3
7 8
8 9
9 7
</code></pre></div>
<strong>Output</strong>
<div class="highlight"><pre><span></span><code>4 3
</code></pre></div></p>
<p><strong>Note</strong></p>
<ul>
<li>Các cạnh màu đỏ là cạnh cầu.</li>
<li>Các đỉnh màu xanh lá là đỉnh khớp.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img5.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img5.png" /></p>
<h3 id="phan-tich"><strong>Phân tích</strong></h3>
<h4 id="tim-canh-cau"><strong>Tìm cạnh cầu</strong></h4>
<ul>
<li>Dễ thấy rằng cạnh cầu của đồ thị không thể là cạnh nét đứt vì việc bỏ đi cạnh nét đứt sẽ không ảnh hưởng đến tính liên thông giữa các đỉnh của đồ thị. Do vậy cạnh cầu chỉ có thể là cạnh nét liền.</li>
<li>
<p>Ta sẽ xét riêng từng thành phần liên thông của đồ thị. Xét vùng liên thông <span class="arithmatex">\(G\)</span> như sau: </p>
<ul>
<li>
<p>Xét cây con gốc <span class="arithmatex">\(v\)</span> trong cây <span class="arithmatex">\(DFS\)</span> của <span class="arithmatex">\(G\)</span> có <span class="arithmatex">\(u\)</span> là cha trực tiếp của <span class="arithmatex">\(v\)</span>. Gọi tập hợp các đỉnh thuộc cây con gốc <span class="arithmatex">\(v\)</span> là <span class="arithmatex">\(A\)</span>, tập hợp các đỉnh không thuộc cây con gốc <span class="arithmatex">\(v\)</span> là <span class="arithmatex">\(B\)</span>. Khi xoá đi cạnh <span class="arithmatex">\((u, v)\)</span> thì giữa <span class="arithmatex">\(2\)</span> đỉnh bất kì thuộc cùng <span class="arithmatex">\(1\)</span> tập hợp vẫn có thể đến với nhau bằng các cạnh nét liền. Một đỉnh thuộc <span class="arithmatex">\(A\)</span> với một đỉnh thuộc <span class="arithmatex">\(B\)</span> muốn đi đến với nhau bằng các <strong>cạnh nét liền</strong> thì đều phải thông qua cạnh <span class="arithmatex">\((u, v)\)</span>.</p>
<ul>
<li><strong>Ví dụ minh họa:</strong> Xét cạnh nét liền <span class="arithmatex">\((7, 9)\)</span> với đỉnh <span class="arithmatex">\(9\)</span> là con trực tiếp của đỉnh <span class="arithmatex">\(7\)</span> trên cây <span class="arithmatex">\(DFS\)</span>. Tập đỉnh <span class="arithmatex">\(A\)</span> là các đỉnh được đánh dấu màu hồng. Tập đỉnh <span class="arithmatex">\(B\)</span> là các đỉnh được đánh dấu màu vàng. Đỉnh <span class="arithmatex">\(11\)</span> thuộc tập <span class="arithmatex">\(A\)</span> muốn đi đến đỉnh <span class="arithmatex">\(6\)</span> thuộc tập <span class="arithmatex">\(B\)</span> bằng các cạnh nét liền thì đều phải thông qua cạnh <span class="arithmatex">\((7, 9)\)</span>.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img6.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img6.png" /></p>
</li>
<li>
<p>Giả sử không có cạnh nét đứt nào nối giữa <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(A\)</span> với <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(B\)</span> thì khi xoá cạnh <span class="arithmatex">\((u, v)\)</span>, <span class="arithmatex">\(G\)</span> sẽ tách ra thành <span class="arithmatex">\(2\)</span> vùng liên thông <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span>. Ngược lại nếu tồn tại cạnh nét đứt nối giữa <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(B\)</span> đồ thị vẫn liên thông . Do đó ta chỉ cần xét xem có tồn tại cạnh nét đứt nối giữa <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> hay không để kết luận <span class="arithmatex">\((u, v)\)</span> có phải cầu không?</p>
</li>
<li>Ta có từ <span class="arithmatex">\(v\)</span> có thể đi đến một đỉnh <span class="arithmatex">\(p\)</span> nào đó có <span class="arithmatex">\(num[p]=low[v]\)</span> bằng cách đi theo các cung của cây <span class="arithmatex">\(DFS\)</span> và đi qua không quá <span class="arithmatex">\(1\)</span> cạnh nét đứt và <span class="arithmatex">\(p\)</span> có thứ tự thăm sớm nhất khi <span class="arithmatex">\(DFS\)</span>. Nếu <span class="arithmatex">\(p\)</span> nằm trong <span class="arithmatex">\(B\)</span> thì <span class="arithmatex">\(p\)</span> phải là tổ tiên của <span class="arithmatex">\(v\)</span> cũng đồng nghĩa với việc <span class="arithmatex">\(num[p]&lt;num[v]\)</span> hay <span class="arithmatex">\(low[v]&lt;num[v]\)</span> <strong>(vì đồ thị không có cung chéo)</strong>, nghĩa là tồn tại <span class="arithmatex">\(1\)</span> cạnh nét đứt nối giữa <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(A\)</span> với <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(B\)</span> (vì nếu chỉ đi bằng các cung của cây <span class="arithmatex">\(DFS\)</span> thì <span class="arithmatex">\(v\)</span> không thể tới một tổ tiên của nó).</li>
<li>Do đó nếu <span class="arithmatex">\(low[v] \ge num[v]\)</span> chắc chắn đỉnh <span class="arithmatex">\(p\)</span> thuộc cây con gốc <span class="arithmatex">\(v\)</span> hay <span class="arithmatex">\(p\)</span> thuộc tập hợp <span class="arithmatex">\(A\)</span> khi đó không tồn tại cạnh nét đứt nối giữa <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(A\)</span> với <span class="arithmatex">\(1\)</span> đỉnh thuộc <span class="arithmatex">\(B\)</span>. Tuy nhiên, ta dễ dàng nhận thấy <span class="arithmatex">\(low[v] \le num[v]\)</span> vì đỉnh <span class="arithmatex">\(v\)</span> luôn tới được chính nó. </li>
<li><strong>Kết luận:</strong> Nếu <span class="arithmatex">\(low[v] = num[v]\)</span> thì <span class="arithmatex">\((u, v)\)</span> là một cạnh cầu trong đồ thị. </li>
</ul>
</li>
</ul>
<h4 id="tim-inh-khop"><strong>Tìm đỉnh khớp</strong></h4>
<ul>
<li>
<p>Ta sẽ xét riêng từng thành phần liên thông của đồ thị. Xét vùng liên thông <span class="arithmatex">\(G\)</span> như sau: </p>
<ul>
<li>
<p>Xét cây con gốc <span class="arithmatex">\(u\)</span> trong cây <span class="arithmatex">\(DFS\)</span> của <span class="arithmatex">\(G\)</span>, nếu mọi nhánh con của <span class="arithmatex">\(u\)</span> đều có cung ngược lên tới tổ tiên của <span class="arithmatex">\(u\)</span> (<span class="arithmatex">\(low[v] &lt; num[u]\)</span>, với <span class="arithmatex">\(v\)</span> là tất cả các con trực tiếp của <span class="arithmatex">\(u\)</span> trên cây <span class="arithmatex">\(DFS\)</span>) thì đỉnh <span class="arithmatex">\(u\)</span> không thể là đỉnh khớp. Bởi trong đồ thị ban đầu, nếu ta loại bỏ đỉnh <span class="arithmatex">\(u\)</span> đi thì từ mỗi đỉnh bất kỳ thuộc nhánh con vẫn có thể đi lên một tổ tiên của <span class="arithmatex">\(u\)</span>, rồi đi sang nhánh con khác hoặc đi sang tất cả những đỉnh còn lại của cây nên số thành phần liên thông của đồ thị không thay đổi.</p>
<ul>
<li><strong>Ví dụ minh họa:</strong> Xét đỉnh <span class="arithmatex">\(9\)</span> không phải là đỉnh khớp vì cả <span class="arithmatex">\(2\)</span> nhánh con của nó là cây con gốc <span class="arithmatex">\(10\)</span> và cây con gốc <span class="arithmatex">\(13\)</span> trong cây <span class="arithmatex">\(DFS\)</span> đều có cung ngược lên tới đỉnh <span class="arithmatex">\(7\)</span> là tổ tiên của đỉnh <span class="arithmatex">\(9\)</span>.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img7.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img7.png" /></p>
</li>
<li>
<p>Nếu <span class="arithmatex">\(u\)</span> không phải là đỉnh gốc của cây <span class="arithmatex">\(DFS\)</span>, và tồn tại ít nhất một nhánh con trong cây con gốc <span class="arithmatex">\(u\)</span> không có cung ngược lên một tổ tiên của <span class="arithmatex">\(u\)</span> (<span class="arithmatex">\(low[v] \ge num[u]\)</span>, với <span class="arithmatex">\(v\)</span> là một con trực tiếp bất kì của <span class="arithmatex">\(u\)</span> trên cây <span class="arithmatex">\(DFS\)</span>) thì đỉnh <span class="arithmatex">\(u\)</span> là đỉnh khớp. Bởi khi đó, tất cả những cung xuất phát từ nhánh con đó chỉ có thể đi tới những đỉnh thuộc cây con gốc <span class="arithmatex">\(u\)</span> mà thôi, trên đồ thị ban đầu, không tồn tại cạnh nối từ những đỉnh thuộc nhánh con đó tới một tổ tiên của <span class="arithmatex">\(u\)</span>. Vậy nên từ một đỉnh bất kì thuộc nhánh con đó muốn đi lên một tổ tiên của <span class="arithmatex">\(u\)</span> thì bắt buộc phải đi qua <span class="arithmatex">\(u\)</span> nên việc loại bỏ đỉnh <span class="arithmatex">\(u\)</span> ra khỏi đồ thị sẽ làm tăng số thành phần liên thông của đồ thị.</p>
<ul>
<li><strong>Ví dụ minh họa:</strong> Xét đỉnh <span class="arithmatex">\(2\)</span> là đỉnh khớp vì tồn tại <span class="arithmatex">\(1\)</span> nhánh con của nó là cây con gốc <span class="arithmatex">\(4\)</span> không có cung ngược lên tới tổ tiên của đỉnh <span class="arithmatex">\(2\)</span>.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img8.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img8.png" /></p>
</li>
<li>
<p>Nếu <span class="arithmatex">\(u\)</span> là đỉnh gốc của cây <span class="arithmatex">\(DFS\)</span>, thì <span class="arithmatex">\(u\)</span> là đỉnh khớp khi và chỉ khi <span class="arithmatex">\(u\)</span> có ít nhất <span class="arithmatex">\(2\)</span> nhánh con. Vì đồ thị không có cung chéo nên khi <span class="arithmatex">\(u\)</span> có <span class="arithmatex">\(2\)</span> nhánh con thì đường đi giữa hai đỉnh thuộc hai nhánh con đó bắt buộc phải đi qua <span class="arithmatex">\(u\)</span>. Việc loại bỏ đỉnh <span class="arithmatex">\(u\)</span> ra khỏi đồ thị sẽ làm tăng số thành phần liên thông của đồ thị.</p>
<ul>
<li><strong>Ví dụ minh họa:</strong> Xét đỉnh <span class="arithmatex">\(1\)</span> là đỉnh khớp vì đỉnh <span class="arithmatex">\(1\)</span> là đỉnh gốc của cây <span class="arithmatex">\(DFS\)</span> và có tới <span class="arithmatex">\(3\)</span> nhánh con.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img9.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img9.png" /></p>
</li>
</ul>
</li>
<li>
<p><strong>Kết luận:</strong> Đỉnh <span class="arithmatex">\(u\)</span> là đỉnh khớp khi:</p>
<ul>
<li>Đỉnh <span class="arithmatex">\(u\)</span> không phải là gốc của cây <span class="arithmatex">\(DFS\)</span> và <span class="arithmatex">\(low[v] \ge num[u]\)</span> (với <span class="arithmatex">\(v\)</span> là một con trực tiếp bất kì của <span class="arithmatex">\(u\)</span> trong cây <span class="arithmatex">\(DFS\)</span>).</li>
</ul>
<p><strong>Hoặc</strong></p>
<ul>
<li>Đỉnh <span class="arithmatex">\(u\)</span> là gốc của cây <span class="arithmatex">\(DFS\)</span> và có ít nhất <span class="arithmatex">\(2\)</span> con trực tiếp trong cây <span class="arithmatex">\(DFS\)</span>.</li>
</ul>
</li>
</ul>
<h3 id="cai-at"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong>
- Hằng số <code>maxN = 10010</code> 
- Biến <code>timeDfs</code> - Thứ tự <span class="arithmatex">\(DFS\)</span>
- Biến <code>bridge</code> - Số lượng cạnh cầu
- Mảng <code>low[], num[]</code>
- Mảng <code>joint[]</code> - Đánh dấu đỉnh khớp
- Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh </p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10010</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bridge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// Số lượng con trực tiếp của đỉnh u trong cây DFS</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="n">bridge</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">child</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Nếu u là đỉnh gốc của cây DFS</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cntJoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">cntJoint</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">cntJoint</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bridge</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="anh-gia"><strong>Đánh giá</strong></h3>
<ul>
<li>Độ phức tạp của bài toán là <span class="arithmatex">\(O(N + M)\)</span>.</li>
</ul>
<h2 id="bai-toan-2">Bài toán 2</h2>
<p><a href="https://oj.vnoi.info/problem/nkpolice">NKPOLICE - Police</a></p>
<h3 id="e-bai_1"><strong>Đề bài</strong></h3>
<p>Để truy bắt tội phạm, cảnh sát xây dựng một hệ thống máy tính mới. Bản đồ khu vực bao gồm <span class="arithmatex">\(N\)</span> thành phố và <span class="arithmatex">\(M\)</span> đường nối <span class="arithmatex">\(2\)</span> chiều. Các thành phố được đánh số từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>.</p>
<p>Cảnh sát muốn bắt các tội phạm di chuyển từ thành phố này đến thành phố khác. Các điều tra viên, theo dõi bản đồ, phải xác định vị trí thiết lập trạm gác. Hệ thống máy tính mới phải trả lời được <span class="arithmatex">\(2\)</span> loại truy vấn sau:</p>
<ul>
<li><span class="arithmatex">\(1\)</span>. Đối với hai thành phố <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span> và một đường nối giữa hai thành phố <span class="arithmatex">\(G1\)</span>, <span class="arithmatex">\(G2\)</span>; hỏi tội phạm có thể di chuyển từ <span class="arithmatex">\(A\)</span> đến <span class="arithmatex">\(B\)</span> nếu đường nối này bị chặn (nghĩa là tên tội phạm không thể sử dụng con đường này) không?</li>
<li><span class="arithmatex">\(2\)</span>. Đối với <span class="arithmatex">\(3\)</span> thành phố <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(C\)</span>; hỏi tội phạm có thể di chuyển từ <span class="arithmatex">\(A\)</span> đến <span class="arithmatex">\(B\)</span> nếu như toàn bộ thành phố <span class="arithmatex">\(C\)</span> bị kiểm soát (nghĩa là tên tội phạm không thể đi vào thành phố này) không?</li>
</ul>
<p><strong>Input</strong>
- Dòng đầu tiên chứa <span class="arithmatex">\(2\)</span> số nguyên <span class="arithmatex">\(N\)</span> và <span class="arithmatex">\(M\)</span> <span class="arithmatex">\((2 \le N \le 100000, 1 \le M \le 500000)\)</span>, số thành phố và số đường nối.
- Mỗi dòng trong số <span class="arithmatex">\(M\)</span> dòng tiếp theo chứa <span class="arithmatex">\(2\)</span> số nguyên phân biệt thuộc phạm vi <span class="arithmatex">\([1, N]\)</span> - cho biết nhãn của hai thành phố nối với nhau bởi một con đường. Giữa hai thành phố có nhiều nhất một đường nối.
- Dòng tiếp theo chứa số nguyên <span class="arithmatex">\(Q\)</span> <span class="arithmatex">\((1 \le Q \le 300000)\)</span>, số truy vấn được thử nghiệm trên hệ thống.
- Mỗi dòng trong <span class="arithmatex">\(Q\)</span> dòng tiếp theo chứa <span class="arithmatex">\(4\)</span> hoặc <span class="arithmatex">\(5\)</span> số nguyên. Số đầu tiên cho biết loại truy vấn <span class="arithmatex">\(1\)</span> hoặc <span class="arithmatex">\(2\)</span>.
    * Nếu loại truy vấn là <span class="arithmatex">\(1\)</span>, tiếp theo trên cùng dòng là <span class="arithmatex">\(4\)</span> số nguyên <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(G1\)</span>, <span class="arithmatex">\(G2\)</span> với ý nghĩa như đã mô tả. <span class="arithmatex">\(A\)</span> khác <span class="arithmatex">\(B\)</span>; <span class="arithmatex">\(G1\)</span>, <span class="arithmatex">\(G2\)</span> mô tả một con đường có sẵn.
    * Nếu loại truy vấn là <span class="arithmatex">\(2\)</span>, tiếp theo trên cùng dòng là <span class="arithmatex">\(3\)</span> số nguyên <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(C\)</span> với ý nghĩa như đã mô tả. <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(C\)</span> đôi một khác nhau.</p>
<p>Dữ liệu được cho sao cho ban đầu luôn có cách di chuyển giữa hai thành phố bất kỳ.</p>
<p><strong>Output</strong>
- Gồm <span class="arithmatex">\(Q\)</span> dòng, mỗi dòng chứa câu trả lời cho một truy vấn. Nếu câu trả lời là khẳng định, in ra "yes". Nếu câu trả lời là phủ định, in ra "no".</p>
<p><strong>Example</strong></p>
<p><strong>Input</strong>
<div class="highlight"><pre><span></span><code>13 15
1 2
2 3
3 5
2 4
4 6
2 6
1 4
1 7
7 8
7 9
7 10
8 11
8 12
9 12
12 13
5
1 5 13 1 2
1 6 2 1 4
1 13 6 7 8
2 13 6 7
2 13 6 8
</code></pre></div></p>
<p><strong>Output</strong>
<div class="highlight"><pre><span></span><code>yes
yes
yes
no
yes
</code></pre></div></p>
<p><strong>Note</strong></p>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img10.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img10.png" /></p>
<h3 id="phan-tich_1"><strong>Phân tích</strong></h3>
<ul>
<li>Để tồn tại ít nhất một cách di chuyển từ thành phố <span class="arithmatex">\(A\)</span> đến thành phố <span class="arithmatex">\(B\)</span> thì cả <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> phải cùng thuộc một thành phần liên thông.</li>
</ul>
<h4 id="truy-van-1"><strong>Truy vấn 1</strong></h4>
<ul>
<li>Dễ thấy rằng, nếu đường nối giữa <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(G1,\)</span> <span class="arithmatex">\(G2\)</span> không phải là cạnh cầu thì việc loại bỏ nó đi sẽ không ảnh hưởng đến tính liên thông giữa thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span>.</li>
<li>Ngược lại, nếu đường nối giữa <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(G1,\)</span> <span class="arithmatex">\(G2\)</span> là cạnh cầu thì ta phải kiểm tra xem <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> có thuộc cùng một thành phần liên thông sau khi loại bỏ cạnh <span class="arithmatex">\((G1,G2)\)</span> hay không?</li>
<li>Mỗi khi loại bỏ một cạnh cầu của đồ thị vô hướng thì số thành phần liên thông của đồ thị sẽ tăng thêm <span class="arithmatex">\(1\)</span>. Nghĩa là khi ta loại bỏ cạnh cầu <span class="arithmatex">\((G1,G2)\)</span> (với <span class="arithmatex">\(G2\)</span> là con trực tiếp của <span class="arithmatex">\(G1\)</span>) thì đồ thị sẽ chia ra làm <span class="arithmatex">\(2\)</span> thành phần liên thông: <ul>
<li>Thành phần liên thông thứ nhất là tập hợp các đỉnh thuộc cây con gốc <span class="arithmatex">\(G2\)</span> của cây <span class="arithmatex">\(DFS\)</span>.</li>
<li>Thành phần liên thông thứ nhất là tập hợp các đỉnh còn lại không thuộc cây con gốc <span class="arithmatex">\(G2\)</span> của cây <span class="arithmatex">\(DFS\)</span>.</li>
</ul>
</li>
<li>
<p><strong>Ví dụ minh họa:</strong> Loại bỏ cạnh cầu <span class="arithmatex">\((1,7)\)</span> (với đỉnh <span class="arithmatex">\(7\)</span> là con trực tiếp của đỉnh <span class="arithmatex">\(1\)</span>)</p>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img11.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img11.png" /></p>
</li>
<li>
<p>Bây giờ, ta có thể xác định vị trí của <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A,\)</span> <span class="arithmatex">\(B\)</span> có nằm trong cây con gốc <span class="arithmatex">\(G2\)</span> hay không.</p>
<ul>
<li>Nếu chỉ có đúng duy nhất <span class="arithmatex">\(1\)</span> trong <span class="arithmatex">\(2\)</span> đỉnh nằm trong cây con gốc <span class="arithmatex">\(G2\)</span> thì <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> không thuộc cùng một thành phần liên thông sau khi loại bỏ cạnh <span class="arithmatex">\((G1,G2)\)</span>.</li>
<li>Ngược lại, nếu cả <span class="arithmatex">\(2\)</span> đỉnh cùng nằm trong cây con gốc <span class="arithmatex">\(G2\)</span> hoặc cả <span class="arithmatex">\(2\)</span> đỉnh đều không nằm trong cây con gốc <span class="arithmatex">\(G2\)</span> thì <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều thuộc cùng một thành phần liên thông sau khi loại bỏ cạnh <span class="arithmatex">\((G1,G2)\)</span>.</li>
</ul>
</li>
<li><strong>Nhắc lại:</strong> Nếu <span class="arithmatex">\(num[u] \le num[v] \le tail[u]\)</span> thì đỉnh <span class="arithmatex">\(v\)</span> nằm trong cây con gốc <span class="arithmatex">\(u\)</span> của cây <span class="arithmatex">\(DFS\)</span>.</li>
</ul>
<h4 id="truy-van-2"><strong>Truy vấn 2</strong></h4>
<ul>
<li>Dễ thấy rằng, nếu thành phố <span class="arithmatex">\(C\)</span> không phải là đỉnh khớp thì việc loại bỏ nó đi sẽ không ảnh hưởng đến tính liên thông giữa thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span>.</li>
<li>Ngược lại, nếu thành phố <span class="arithmatex">\(C\)</span> là đỉnh khớp thì ta phải kiểm tra xem <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> có thuộc cùng một thành phần liên thông sau khi loại bỏ đỉnh <span class="arithmatex">\(C\)</span> và các cạnh liên thuộc với nó đi hay không?</li>
<li>Vì đồ thị không có cung chéo nên khi loại bỏ đỉnh khớp <span class="arithmatex">\(C\)</span> ra khỏi đồ thị thì số thành phần liên thông của đồ thị tăng thêm một lượng bằng số lượng đỉnh <span class="arithmatex">\(v\)</span> là con trực tiếp của <span class="arithmatex">\(C\)</span> trong cây <span class="arithmatex">\(DFS\)</span> sao cho không tồn tại cung ngược (cạnh nét đứt) từ một đỉnh thuộc cây con gốc <span class="arithmatex">\(v\)</span> trong cây <span class="arithmatex">\(DFS\)</span> nối lên tổ tiên của <span class="arithmatex">\(C\)</span> (đồng nghĩa với việc <span class="arithmatex">\(low[v] \ge num[C]\)</span>). Nghĩa là khi ta loại bỏ đỉnh khớp <span class="arithmatex">\(C\)</span> ra khỏi đồ thị thì đồ thị sẽ chia ra làm các thành phần liên thông:<ul>
<li>Một số thành phân liên thông, mỗi thành phần liên thông là <span class="arithmatex">\(1\)</span> tập hợp các đỉnh thuộc cây con gốc <span class="arithmatex">\(v\)</span> với <span class="arithmatex">\(v\)</span> là con trực tiếp của <span class="arithmatex">\(C\)</span> trong cây <span class="arithmatex">\(DFS\)</span> và <span class="arithmatex">\(low[v] \ge num[C]\)</span>.</li>
<li>Một thành phần liên thông là tập hợp tất cả các đỉnh còn lại (bao gồm các đỉnh là tổ tiên của của <span class="arithmatex">\(C\)</span> và các đỉnh thuộc các cây con gốc <span class="arithmatex">\(u\)</span> với <span class="arithmatex">\(u\)</span> là các con trực tiếp của <span class="arithmatex">\(C\)</span> trong cây <span class="arithmatex">\(DFS\)</span> và <span class="arithmatex">\(low[u] &lt; num[C]\)</span>).</li>
</ul>
</li>
<li>
<p><strong>Ví dụ minh họa:</strong> Loại bỏ đỉnh khớp <span class="arithmatex">\(8\)</span>. Đỉnh <span class="arithmatex">\(11\)</span> và <span class="arithmatex">\(12\)</span> là các con trực tiếp của đỉnh <span class="arithmatex">\(8\)</span> trong cây <span class="arithmatex">\(DFS\)</span>. Nhưng chỉ có cây con gốc <span class="arithmatex">\(11\)</span> là tách riêng ra thành <span class="arithmatex">\(1\)</span> thành phần liên thông riêng biệt. Còn cây con gốc <span class="arithmatex">\(12\)</span> thì có <span class="arithmatex">\(1\)</span> cung ngược nối lên đỉnh <span class="arithmatex">\(7\)</span> (tổ tiên của đỉnh <span class="arithmatex">\(8\)</span>) nên số lượng thành phần liên thông của cả đồ thị chỉ tăng thêm <span class="arithmatex">\(1\)</span>.</p>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img12.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img12.png" /></p>
</li>
<li>
<p>Với mỗi đỉnh <span class="arithmatex">\(v\)</span> là con trực tiếp của <span class="arithmatex">\(C\)</span> trong cây <span class="arithmatex">\(DFS\)</span> và <span class="arithmatex">\(low[v] \ge num[C]\)</span>, ta kiểm tra xem nếu chỉ có đúng duy nhất <span class="arithmatex">\(1\)</span> trong <span class="arithmatex">\(2\)</span> đỉnh nằm trong cây con gốc <span class="arithmatex">\(v\)</span> thì <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> không thuộc cùng một thành phần liên thông sau khi loại bỏ đỉnh <span class="arithmatex">\(C\)</span> và các cạnh liên thuộc với đỉnh <span class="arithmatex">\(C\)</span> đi. </p>
</li>
<li>Ngược lại, với <span class="arithmatex">\(v\)</span> là các con trực tiếp của <span class="arithmatex">\(C\)</span> trong cây <span class="arithmatex">\(DFS\)</span> và <span class="arithmatex">\(low[v] \ge num[C]\)</span>, nếu cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> cùng nằm trong <span class="arithmatex">\(1\)</span> cây con gốc <span class="arithmatex">\(v\)</span> hoặc cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều không nằm trong bất cứ <span class="arithmatex">\(1\)</span> cây con gốc <span class="arithmatex">\(v\)</span> nào cả (đồng nghĩa với việc cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A,\)</span> <span class="arithmatex">\(B\)</span> sẽ cùng nằm trong thành phần liên thông còn lại) thì <span class="arithmatex">\(2\)</span> thành phố <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều thuộc cùng một thành phần liên thông sau khi loại bỏ đỉnh <span class="arithmatex">\(C\)</span> và các cạnh liên thuộc với đỉnh <span class="arithmatex">\(C\)</span> đi.</li>
<li><strong>Tuy nhiên theo thuật toán trên thì với mỗi truy vấn ta sẽ phải duyệt hết tất cả các con trực tiếp của đỉnh <em>C</em> nên khi xử lí các truy vấn sẽ mất độ phức tạp là <em>O(Q⋅ bậc của C)</em>. Trong trường hợp tệ nhất thì đỉnh <em>C</em> có thể lên đến <em>N - 1</em> con trực tiếp <em>(100000 - 1)</em> với số lượng truy vấn <em>Q = 300000</em>, khiến cho thuật toán trên sẽ bị quá thời gian. Bây giờ ta cần phải cải tiến thuật toán :</strong></li>
<li>Thay vì duyệt hết tất cả các con trực tiếp của <span class="arithmatex">\(C\)</span> để xác định được tổ tiên của <span class="arithmatex">\(A\)</span>, tổ tiên của <span class="arithmatex">\(B\)</span>. Ta có thể sử dụng <span class="arithmatex">\(Sparse Table\)</span> để tìm ra tổ tiên của đỉnh <span class="arithmatex">\(A\)</span> (hoặc <span class="arithmatex">\(B\)</span>) là con trực tiếp của đỉnh <span class="arithmatex">\(C\)</span> nếu <span class="arithmatex">\(A\)</span> (hoặc <span class="arithmatex">\(B\)</span>) nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span>.
<strong>Bạn có thể tìm hiểu thêm về <em>Sparse Table</em> và ứng dụng của nó tại <a href="translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor">đây</a></strong>.</li>
<li>Gọi đỉnh <span class="arithmatex">\(pa\)</span> là tổ tiên của đỉnh <span class="arithmatex">\(A\)</span> và là con trực tiếp của đỉnh <span class="arithmatex">\(C\)</span>.</li>
<li>Gọi đỉnh <span class="arithmatex">\(pb\)</span> là tổ tiên của đỉnh <span class="arithmatex">\(B\)</span> và là con trực tiếp của đỉnh <span class="arithmatex">\(C\)</span>.</li>
<li><span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> thuộc cùng một thành phần liên thông sau khi loại bỏ đỉnh <span class="arithmatex">\(C\)</span> và các cạnh liên thuộc với đỉnh <span class="arithmatex">\(C\)</span> đi khi thỏa mãn một trong số các điều kiện sau:<ul>
<li>Nếu cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều <strong>không</strong> nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span>.</li>
<li>Nếu <span class="arithmatex">\(pa = pb\)</span> (nghĩa là cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(pa\)</span> ).</li>
<li>Nếu <span class="arithmatex">\(A\)</span> <strong>không</strong> nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span> và <span class="arithmatex">\(B\)</span> nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span> sao cho <span class="arithmatex">\(low[pb] &lt; num[C]\)</span> (nghĩa là có tồn tại cung ngược nối từ cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(pb\)</span> lên tổ tiên của <span class="arithmatex">\(C\)</span> ).</li>
<li>Nếu <span class="arithmatex">\(B\)</span> <strong>không</strong> nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span> và <span class="arithmatex">\(A\)</span> nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span> sao cho <span class="arithmatex">\(low[pa] &lt; num[C]\)</span> (nghĩa là có tồn tại cung ngược nối từ cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(pa\)</span> lên tổ tiên của <span class="arithmatex">\(C\)</span> ).</li>
<li>Nếu cả <span class="arithmatex">\(2\)</span> đỉnh <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> đều nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(C\)</span> và  <span class="arithmatex">\(low[pa] &lt; num[c]\)</span> và <span class="arithmatex">\(low[pb] &lt; num[c]\)</span> (nghĩa là cả <span class="arithmatex">\(2\)</span> cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(pa\)</span> và cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(pb\)</span> đều có cung ngược nối lên tổ tiên của <span class="arithmatex">\(C\)</span> )</li>
</ul>
</li>
<li>Ngược lại, nếu không thỏa mãn tất cả các điều kiện trên thì <span class="arithmatex">\(A\)</span> và <span class="arithmatex">\(B\)</span> không thuộc cùng một thành phần liên thông sau khi loại bỏ đỉnh <span class="arithmatex">\(C\)</span> và các cạnh liên thuộc với đỉnh <span class="arithmatex">\(C\)</span> đi. </li>
<li>Lúc này, độ phức tạp để xử lí các truy vấn sẽ là <span class="arithmatex">\(O(Q \cdot logN)\)</span>.</li>
</ul>
<h3 id="cai-at_1"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong>
- Hằng số <code>maxN = 100010</code> 
- Biến <code>timeDfs</code> - Thứ tự <span class="arithmatex">\(DFS\)</span>
- Mảng <code>low[], num[], tail[]</code>
- Mảng <code>depth[]</code> - Lưu chiều sâu của mỗi đỉnh trong cây <span class="arithmatex">\(DFS\)</span>
- Mảng <code>p[][]</code> - Mảng ứng dụng <span class="arithmatex">\(Sparse Table\)</span> với <span class="arithmatex">\(p[i][j]\)</span> là tổ tiên thứ <span class="arithmatex">\(2^j\)</span> của <span class="arithmatex">\(i\)</span> trong cây <span class="arithmatex">\(DFS\)</span>
- Mảng <code>joint[]</code> - Đánh dấu đỉnh khớp
- Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh </p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">100010</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">tail</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">depth</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">maxN</span><span class="p">][</span><span class="mi">20</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="cm">/* Tính mảng p */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">calP</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">19</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="cm">/* Tìm tổ tiên của đỉnh u là con trực tiếp của đỉnh par */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">findParent</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">par</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">19</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">depth</span><span class="p">[</span><span class="n">par</span><span class="p">])</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Tìm khớp cầu */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">child</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">            </span><span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">depth</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="n">joint</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tail</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeDfs</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Kiểm tra xem đỉnh u có nằm trong cây con DFS gốc root hay không? */</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">checkInSubtree</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">root</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">tail</span><span class="p">[</span><span class="n">root</span><span class="p">];</span>
<span class="p">}</span>

<span class="cm">/* Xử lí truy vấn 1 */</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">solve1</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">g2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Vì ta coi g2 là con trực tiếp của g1 nên khi g1 là con của g2, </span>
<span class="cm">    ta phải đổi chỗ 2 giá trị g1 và g2 cho nhau */</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">g1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">g2</span><span class="p">])</span><span class="w"> </span><span class="n">swap</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">);</span><span class="w"> </span>

<span class="w">    </span><span class="cm">/* Kiểm tra nếu cạnh (g1, g2) không phải là cầu */</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">g2</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">g2</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Xử lí truy vấn 2 */</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">solve2</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">joint</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">pb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="n">pa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findParent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkInSubtree</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="n">pb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findParent</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pa</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">pb</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pb</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pa</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">pb</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pb</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">pa</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pa</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pb</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">pa</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">pb</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">depth</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">calP</span><span class="p">();</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g1</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g2</span><span class="p">;</span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">solve1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;yes</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;no</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">solve2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;yes</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;no</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_1"><strong>Đánh giá</strong></h3>
<ul>
<li>Độ phức tạp của bài toán là <span class="arithmatex">\(O(N + M + Q \cdot logN)\)</span></li>
</ul>
<h2 id="bai-toan-3">Bài toán 3</h2>
<p><a href="https://oj.vnoi.info/problem/kbuild">KBUILD - Sửa cầu</a></p>
<h3 id="e-bai_2"><strong>Đề bài</strong></h3>
<p>Cho <span class="arithmatex">\(N\)</span> hòn đảo và <span class="arithmatex">\(N - 1\)</span> cây cầu, mỗi cây cầu nối hai hòn đảo lại với nhau. Đảm bảo rằng từ một đảo bất kì luôn có thể đến được hết mọi đảo còn lại. Pirate đưa ra một lịch trình như sau: vào mỗi ngày sẽ đi kiểm tra mọi cây cầu trên đường đi từ đảo <span class="arithmatex">\(a\)</span> đến đảo <span class="arithmatex">\(b\)</span>. Hỏi sau khi Pirate thực hiện xong lịch trình đó, thì còn có bao nhiêu cây cầu chưa được kiểm tra?</p>
<p><strong>Input</strong>
- Dòng thứ nhất: số nguyên <span class="arithmatex">\(N\)</span> - số lượng hòn đảo.
- <span class="arithmatex">\(N - 1\)</span> dòng tiếp theo: mỗi dòng chứa <span class="arithmatex">\(2\)</span> số nguyên <span class="arithmatex">\(a\)</span> và <span class="arithmatex">\(b\)</span> - có một cây cầu nối đảo <span class="arithmatex">\(a\)</span> và <span class="arithmatex">\(b\)</span>.
- Dòng thứ <span class="arithmatex">\(N + 1\)</span>: Số nguyên <span class="arithmatex">\(M\)</span> - số ngày kiểm tra.
- <span class="arithmatex">\(M\)</span> dòng tiếp theo: mỗi dòng chứa <span class="arithmatex">\(2\)</span> số nguyên <span class="arithmatex">\(a\)</span> và <span class="arithmatex">\(b\)</span> - ngày hôm đó, Pirate sẽ đi kiểm tra mọi cây cầu trên đường đi từ đảo <span class="arithmatex">\(a\)</span> đến đảo <span class="arithmatex">\(b\)</span>.</p>
<p><span class="arithmatex">\(1 \le N, M \le 200000\)</span></p>
<p><strong>Output</strong>
- Một số nguyên duy nhất thể hiện số cây cầu chưa được kiểm tra.</p>
<p><strong>Input</strong></p>
<div class="highlight"><pre><span></span><code>6
1 2
2 3
2 4
4 5
4 6
2
3 6
5 6
</code></pre></div>
<p><strong>Output</strong></p>
<div class="highlight"><pre><span></span><code>1
</code></pre></div>
<p><strong>Note</strong>
- Ngày thứ nhất, Pirate kiểm tra các cây cầu <span class="arithmatex">\((2, 3), (2, 4)\)</span> và <span class="arithmatex">\((4, 6)\)</span>. Ngày thứ hai, anh kiểm tra các cây cầu <span class="arithmatex">\((5, 4)\)</span> và <span class="arithmatex">\((4, 6)\)</span>. Cây cầu duy nhất chưa được kiểm tra là <span class="arithmatex">\((1, 2)\)</span>.</p>
<h3 id="phan-tich_2"><strong>Phân tích</strong></h3>
<p>Vì đồ thị ban đầu liên thông và có <span class="arithmatex">\(N - 1\)</span> cạnh nên đây là đồ thị dạng <a href="https://vi.wikipedia.org/wiki/C%C3%A2y_(l%C3%BD_thuy%E1%BA%BFt_%C4%91%E1%BB%93_th%E1%BB%8B)">cây</a>.</p>
<p>Để đánh dấu các cạnh thuộc đường đi từ đỉnh <span class="arithmatex">\(u\)</span> đến đỉnh <span class="arithmatex">\(v\)</span> trên cây, thì ta có thể thêm một cạnh <span class="arithmatex">\((u,v)\)</span> vào đồ thị. Khi đó, các cạnh thuộc đường đi từ <span class="arithmatex">\(u \rightarrow v\)</span> trên cây sẽ nằm trong <span class="arithmatex">\(1\)</span> chu trình. Từ đó, bài toán sẽ quy về thành bài toán đếm số lượng cạnh cầu của đồ thị.
- <strong>Ví dụ minh họa:</strong> Để dánh dấu đường đi từ đỉnh <span class="arithmatex">\(3 \rightarrow 6\)</span> và đường đi từ đỉnh <span class="arithmatex">\(5 \rightarrow 6\)</span>, ta thêm cạnh <span class="arithmatex">\((3, 6)\)</span>, <span class="arithmatex">\((5, 6)\)</span> vào đồ thị. Khi đó, đồ thị có một cạnh cầu là cạnh <span class="arithmatex">\((1, 2)\)</span>.</p>
<pre><code>![/fptoj_wiki/uploads/Depth-First-Search-Tree_img13.png](/fptoj_wiki/uploads/Depth-First-Search-Tree_img13.png)
</code></pre>
<h3 id="cai-at_2"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong>
- Hằng số <code>maxN = 200010</code> 
- Biến <code>timeDfs</code> - Thứ tự <span class="arithmatex">\(DFS\)</span>
- Biến <code>bridge</code> - Số lượng cạnh cầu
- Mảng <code>low[], num[]</code>
- Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh </p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2e5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bridge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pre</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="n">bridge</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">b</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">b</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bridge</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_2"><strong>Đánh giá</strong></h3>
<ul>
<li>Độ phức tạp của bài toán là <span class="arithmatex">\(O(N + (N - 1 + M))\)</span>.</li>
</ul>
<h1 id="ung-dung-cay-dfs-trong-bai-toan-liet-ke-thanh-phan-lien-thong-manh">Ứng dụng cây DFS trong bài toán liệt kê thành phần liên thông mạnh</h1>
<h2 id="inh-nghia_1">Định nghĩa</h2>
<ul>
<li>Một đồ thị có hướng là liên thông mạnh nếu như từ một đỉnh bất kì luôn tồn tại ít nhất một đường đi đến bất kì đỉnh nào khác. </li>
<li>Một thành phần liên thông mạnh của một đồ thị có hướng là một đồ thị con tối đại liên thông mạnh. Nếu mỗi thành phần liên thông mạnh được co lại thành một đỉnh, thì đồ thị sẽ trở thành một đồ thị có hướng không có chu trình.</li>
<li>Thuật toán <span class="arithmatex">\(Kosaraju\)</span>, thuật toán <span class="arithmatex">\(Tarjan\)</span>, và thuật toán <span class="arithmatex">\(Gabow\)</span> đều có thể tìm các thành phần liên thông mạnh của một đồ thị cho trước trong thời gian tuyến tính. Tuy nhiên, các thuật toán của <span class="arithmatex">\(Tarjan\)</span>  thường được sử dụng nhiều hơn do chúng chỉ cần thực hiện tìm kiếm theo chiều sâu một lần trong khi thuật toán của <span class="arithmatex">\(Kosaraju\)</span> cần hai lần.</li>
</ul>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img14.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img14.png" /></p>
<h2 id="mot-so-inh-ly-quan-trong">Một số định lý quan trọng</h2>
<ul>
<li>
<p><strong>Định lý 1:</strong> Nếu <span class="arithmatex">\(a\)</span>, <span class="arithmatex">\(b\)</span> là hai đỉnh thuộc thành phần liên thông mạnh <span class="arithmatex">\(C\)</span> thì với mọi đường đi từ <span class="arithmatex">\(a\)</span> tới <span class="arithmatex">\(b\)</span> cũng như từ <span class="arithmatex">\(b\)</span> tới <span class="arithmatex">\(a\)</span>. Tất cả đỉnh trung gian trên đường đi đó đều phải thuộc <span class="arithmatex">\(C\)</span>.
<strong>Chứng minh:</strong> Nếu <span class="arithmatex">\(a\)</span> và <span class="arithmatex">\(b\)</span> là hai đỉnh thuộc <span class="arithmatex">\(C\)</span> thì tức là có một đường đi từ <span class="arithmatex">\(a\)</span> đến <span class="arithmatex">\(b\)</span> và một đường khác đi từ <span class="arithmatex">\(b\)</span> về <span class="arithmatex">\(a\)</span>. Suy ra với một đỉnh <span class="arithmatex">\(v\)</span> nằm trên đường đi từ <span class="arithmatex">\(a\)</span> tới <span class="arithmatex">\(b\)</span> thì <span class="arithmatex">\(a\)</span> tới được <span class="arithmatex">\(v\)</span>, <span class="arithmatex">\(v\)</span> tới được <span class="arithmatex">\(b\)</span>, mà <span class="arithmatex">\(b\)</span> có đường tới <span class="arithmatex">\(a\)</span> nên <span class="arithmatex">\(v\)</span> cũng tới được <span class="arithmatex">\(a\)</span>. Vậy <span class="arithmatex">\(v\)</span> nằm trong thành phần liên thông mạnh chứa <span class="arithmatex">\(a\)</span> tức là <span class="arithmatex">\(v\)</span> thuộc <span class="arithmatex">\(C\)</span>. Tương tự với một đỉnh nằm trên đường đi từ <span class="arithmatex">\(b\)</span> tới <span class="arithmatex">\(a\)</span>.</p>
</li>
<li>
<p><strong>Định lý 2:</strong> Với một thành phần liên thông mạnh <span class="arithmatex">\(C\)</span> bất kỳ, tồn tại một đỉnh <span class="arithmatex">\(r\)</span> thuộc <span class="arithmatex">\(C\)</span> sao cho mọi đỉnh của <span class="arithmatex">\(C\)</span> đều thuộc cây con gốc <span class="arithmatex">\(r\)</span> trong cây <span class="arithmatex">\(DFS\)</span>.
<strong>Chứng minh:</strong> Trước hết, nhắc lại một thành phần liên thông mạnh là một đồ thị con liên thông mạnh của đồ thị ban đầu thoả mãn tính chất <strong>tối đại</strong> tức là việc thêm vào thành phần đó một tập hợp đỉnh khác sẽ làm mắt đi tính liên thông mạnh.</p>
<p>Trong số các đỉnh của <span class="arithmatex">\(C\)</span>, chọn <span class="arithmatex">\(r\)</span> là đỉnh được thăm đầu tiên theo thuật toán tìm kiếm theo chiều sâu. Ta sẽ chứng minh <span class="arithmatex">\(C\)</span> nằm trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(r\)</span>. Thật vậy, với một đỉnh <span class="arithmatex">\(v\)</span> bất kỳ của <span class="arithmatex">\(C\)</span>, do <span class="arithmatex">\(C\)</span> liên thông mạnh nên phải tồn tại một đường đi từ <span class="arithmatex">\(r\)</span> tới <span class="arithmatex">\(v\)</span>: <span class="arithmatex">\((r = x_0, x_1,..., x_k = v)\)</span></p>
<p>Từ định lý <span class="arithmatex">\(1\)</span>, tất cả các đỉnh <span class="arithmatex">\(x_1, x_2,..., x_k\)</span> đều thuộc <span class="arithmatex">\(C\)</span> nên chúng sẽ phải thăm sau đỉnh <span class="arithmatex">\(r\)</span>. Khi thủ tục <span class="arithmatex">\(DFS(r)\)</span> được gọi thì tất cả các đỉnh <span class="arithmatex">\(x_1, x_2,..., x_k\)</span> đều chưa thăm; vì thủ tục <span class="arithmatex">\(DFS(r)\)</span> sẽ liệt kê tất cả những đỉnh chưa thăm đến được từ <span class="arithmatex">\(r\)</span> bằng cách xây dựng nhánh gốc <span class="arithmatex">\(r\)</span> của cây <span class="arithmatex">\(DFS\)</span>, nên các đỉnh <span class="arithmatex">\(x_1, x_2,..., x_k = v\)</span> sẽ thuộc nhánh gốc <span class="arithmatex">\(r\)</span> của cây <span class="arithmatex">\(DFS\)</span>. Bởi chọn <span class="arithmatex">\(v\)</span> là đỉnh bất kỳ trong <span class="arithmatex">\(C\)</span> nên ta có điều phải chứng minh.</p>
<p>Đỉnh <span class="arithmatex">\(r\)</span> trong chứng minh định lý - đỉnh thăm trước tất cả các đỉnh khác trong <span class="arithmatex">\(C\)</span> - gọi là chốt của thành phần <span class="arithmatex">\(C\)</span>. Mỗi thành phần liên thông mạnh có duy nhất một chốt. Xét về vị trí trong cây tìm kiếm <span class="arithmatex">\(DFS\)</span>, chốt của một thành phân liên thông là đỉnh nằm cao nhất so với các đỉnh khác thuộc thành phần đó, hay nói cách khác: là tiền bối của tất cả các đỉnh thuộc thành phần đó.</p>
</li>
<li>
<p><strong>Định lý 3:</strong> Luôn tìm được đỉnh chốt <span class="arithmatex">\(a\)</span> thỏa mãn: Quá trình tìm kiếm theo chiều sâu bắt đầu từ <span class="arithmatex">\(a\)</span> không thăm được bất kỳ một chốt nào khác. (Tức là nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> không chứa một chốt nào ngoài <span class="arithmatex">\(a\)</span>) chẳng hạn ta chọn <span class="arithmatex">\(a\)</span> là chốt được thăm sau cùng trong một dây chuyền đệ quy hoặc chọn <span class="arithmatex">\(a\)</span> là chốt thăm sau tất cả các chốt khác. Với chốt <span class="arithmatex">\(a\)</span> như vậy thì các đỉnh thuộc nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> chính là thành phần liên thông mạnh chứa <span class="arithmatex">\(a\)</span>.
<strong>Chứng minh</strong>: Với mọi đỉnh <span class="arithmatex">\(v\)</span> nằm trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span>, xét <span class="arithmatex">\(b\)</span> là chốt của thành phần liên thông mạnh chứa <span class="arithmatex">\(v\)</span>. Ta sẽ chứng minh <span class="arithmatex">\(a = b\)</span>. Thật vậy, theo định lý <span class="arithmatex">\(2\)</span>, <span class="arithmatex">\(v\)</span> phải nằm trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(b\)</span>. Vậy <span class="arithmatex">\(v\)</span> nằm trong cả nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> và nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(b\)</span>. Giả sử phản chứng rằng <span class="arithmatex">\(a\)</span> khác <span class="arithmatex">\(b\)</span> thì sẽ có hai trường hợp xảy ra:</p>
<ul>
<li><strong>Trường hợp 1:</strong> Nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> chứa nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(b\)</span>, có nghĩa là thủ tục <span class="arithmatex">\(DFS(b)\)</span> sẽ do thủ tục <span class="arithmatex">\(DFS(a)\)</span> gọi tới, điều này mâu thuẫn với giả thiết rằng <span class="arithmatex">\(a\)</span> là chốt mà quá trình tìm kiếm theo chiều sâu bắt đầu từ <span class="arithmatex">\(a\)</span> không thăm một chốt nào khác.</li>
<li><strong>Trường hợp 2:</strong> Nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> nằm trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(b\)</span>, có nghĩa là <span class="arithmatex">\(a\)</span> nằm trên một đường đi từ <span class="arithmatex">\(b\)</span> tới <span class="arithmatex">\(v\)</span>. Do <span class="arithmatex">\(b\)</span> và <span class="arithmatex">\(v\)</span> thuộc cùng một thành phần liên thông mạnh nên theo định lý <span class="arithmatex">\(1\)</span>, <span class="arithmatex">\(a\)</span> cũng phải thuộc thành phần liên thông mạnh đó. Vậy thì thành phần liên thông mạnh này có hai chốt <span class="arithmatex">\(a\)</span> và <span class="arithmatex">\(b\)</span>. Điều này vô lý.</li>
</ul>
<p>Theo định lý <span class="arithmatex">\(2\)</span>, ta đã có thành phân liên thông mạnh chứa <span class="arithmatex">\(a\)</span> nằm trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span>, theo chứng minh trên ta lại có: Mọi đỉnh trong nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> nằm trong thành phân liên thông mạnh chứa <span class="arithmatex">\(a\)</span>. Kết hợp lại được: Nhánh <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(a\)</span> chính là thành phần liên thông mạnh chứa <span class="arithmatex">\(a\)</span>.</p>
</li>
</ul>
<h2 id="bai-toan-4">Bài toán 4</h2>
<p><a href="https://oj.vnoi.info/problem/tjalg">TJALG - Tìm TPLT mạnh</a></p>
<h3 id="e-bai_3"><strong>Đề bài</strong></h3>
<p>Cho đồ thị <span class="arithmatex">\(G(V, E)\)</span> có hướng <span class="arithmatex">\(N\)</span> <span class="arithmatex">\((1 \le N \le 10^4)\)</span> đỉnh, <span class="arithmatex">\(M\)</span> <span class="arithmatex">\((1 \le M \le 10^5)\)</span> cung. Hãy đếm số thành phần liên thông mạnh của <span class="arithmatex">\(G\)</span>.</p>
<p><strong>Input</strong>
- Dòng đầu tiên là <span class="arithmatex">\(N, M\)</span>.
- <span class="arithmatex">\(M\)</span> dòng tiếp theo mô tả một cung của <span class="arithmatex">\(G\)</span>.</p>
<p><strong>Output</strong>
- Gồm một dòng duy nhất là số TPLT mạnh.</p>
<p><strong>Examples</strong></p>
<p><strong>Input</strong>
<div class="highlight"><pre><span></span><code>3 2
1 2
2 3
</code></pre></div></p>
<p><strong>Output</strong>
<div class="highlight"><pre><span></span><code>3
</code></pre></div></p>
<p><strong>Input</strong>
<div class="highlight"><pre><span></span><code>3 3
1 2
2 3
3 1
</code></pre></div></p>
<p><strong>Output</strong>
<div class="highlight"><pre><span></span><code>1
</code></pre></div></p>
<h3 id="thuat-toan-tarjan"><strong>Thuật toán Tarjan</strong></h3>
<p><img alt="/fptoj_wiki/uploads/Depth-First-Search-Tree_img15.png" src="/fptoj_wiki/uploads/Depth-First-Search-Tree_img15.png" /></p>
<p><strong>Thuật toán Tarjan được xây dựng dựa trên các dữ kiện sau:</strong>
- Tìm kiếm <span class="arithmatex">\(DFS\)</span> tạo ra cây/ rừng <span class="arithmatex">\(DFS\)</span>
- Các thành phần liên thông mạnh tạo thành các cây con của cây <span class="arithmatex">\(DFS\)</span>.
- Nếu ta có thể tìm được đỉnh gốc của các cây con như vậy, ta có thể in/ lưu trữ tất cả các nút trong cây con đó (bao gồm cả đỉnh gốc) và đó sẽ là một thành phần liên thông mạnh <span class="arithmatex">\((Strongly\)</span> <span class="arithmatex">\(Connected\)</span> <span class="arithmatex">\(Components\)</span> - <span class="arithmatex">\(SCC).\)</span>
- Không có cung ngược từ <span class="arithmatex">\(SCC\)</span> này sang <span class="arithmatex">\(SCC\)</span> khác (Có thể có các cung chéo, nhưng các cung chéo sẽ không được sử dụng trong khi xử lý đồ thị).</p>
<h4 id="mo-ta-thuat-toan"><strong>Mô tả thuật toán</strong></h4>
<p><a href="/fptoj_wiki/uploads/Depth-First-Search-Tree_gif2.gif">/fptoj_wiki/uploads/Depth-First-Search-Tree_gif2.gif</a></p>
<h4 id="y-tuong"><strong>Ý tưởng</strong></h4>
<ul>
<li><strong>Nhận xét:</strong> Xét cây con gốc <span class="arithmatex">\(u\)</span> trong cây <span class="arithmatex">\(DFS\)</span>. Gọi tập hợp các đỉnh thuộc cây con gốc <span class="arithmatex">\(u\)</span> là <span class="arithmatex">\(A\)</span>, tập hợp các đỉnh không thuộc cây con gốc <span class="arithmatex">\(u\)</span> là <span class="arithmatex">\(B\)</span>. Nếu tồn tại <span class="arithmatex">\(1\)</span> đỉnh <span class="arithmatex">\(x\)</span> thuộc <span class="arithmatex">\(A\)</span> tới được <span class="arithmatex">\(1\)</span> đỉnh <span class="arithmatex">\(y\)</span> thuộc <span class="arithmatex">\(B\)</span> thì <span class="arithmatex">\(y\)</span> phải có thứ tự thăm sớm hơn <span class="arithmatex">\(u\)</span>. Vì nếu <span class="arithmatex">\(y\)</span> được thăm sau <span class="arithmatex">\(u\)</span> ta có thể duyệt từ <span class="arithmatex">\(u\)</span> qua <span class="arithmatex">\(x\)</span> tới <span class="arithmatex">\(y\)</span> khi đó <span class="arithmatex">\(y\)</span> sẽ trở thành con của <span class="arithmatex">\(u\)</span>.</li>
<li>Đầu tiên ta thực hiện <span class="arithmatex">\(DFS\)</span> kết hợp tính mảng <span class="arithmatex">\(low[], num[]\)</span> như đã trình bày ở trên. Song song với việc này, khi duyệt tới đỉnh <span class="arithmatex">\(u\)</span> ta sẽ thực hiện đẩy <span class="arithmatex">\(u\)</span> vào <span class="arithmatex">\(stack\)</span>.</li>
<li>Khi đã duyệt xong đỉnh <span class="arithmatex">\(u\)</span> (sau khi duyệt hết toàn bộ các đỉnh nằm trong cây con <span class="arithmatex">\(DFS\)</span> gốc <span class="arithmatex">\(u\)</span>), nếu <span class="arithmatex">\(num[u] = low[u]\)</span> thì đây chính là đỉnh có thứ tự thăm sớm nhất của một thành phần liên thông mạnh.</li>
<li>Khi đó ta sẽ loại bỏ tất cả các đỉnh trong thành phần liên thông mạnh này ra khỏi đồ thị và các đỉnh này là các đỉnh đang nằm trên <span class="arithmatex">\(u\)</span> trong <span class="arithmatex">\(stack\)</span> hiện tại vì các đỉnh này chính là các đỉnh nằm trên cây con gốc <span class="arithmatex">\(u\)</span> trong cây <span class="arithmatex">\(DFS\)</span> do các nút được đẩy vào <span class="arithmatex">\(stack\)</span> theo thứ tự thăm. </li>
<li>Mặt khác, giả sử ta có đỉnh <span class="arithmatex">\(x\)</span> thuộc cây con gốc <span class="arithmatex">\(u\)</span> và <span class="arithmatex">\(x\)</span> thuộc một thành phần liên thông mạnh không chứa <span class="arithmatex">\(u\)</span> có đỉnh có thứ tự thăm sớm nhất là <span class="arithmatex">\(y\)</span>, dễ thấy <span class="arithmatex">\(y\)</span> phải là con của <span class="arithmatex">\(u\)</span> nên thời điểm duyệt xong của <span class="arithmatex">\(y\)</span> sớm hơn <span class="arithmatex">\(u\)</span> chứng tỏ <span class="arithmatex">\(y\)</span> và thành phần liên thông mạnh chứa nó sẽ bị loại bỏ trước đó không còn trong <span class="arithmatex">\(stack\)</span> nữa (nếu <span class="arithmatex">\(y\)</span> không phải con <span class="arithmatex">\(u\)</span> thì vô lí vì ta đang xét mọi đỉnh trong cây con gốc <span class="arithmatex">\(u\)</span> chưa được xác định nằm trong thành phần liên thông mạnh nào hiện tại không tới được các đỉnh không nằm trong cây con gốc <span class="arithmatex">\(u\)</span>). </li>
<li>Ta sẽ đánh dấu tất cả các đỉnh thuộc thành phần liên thông mạnh này bằng <span class="arithmatex">\(1\)</span> mảng để sau này không xét lại đỉnh đấy nữa. Đồng thời, ta loại bỏ cách đỉnh này ra khỏi <span class="arithmatex">\(stack\)</span> để không làm ảnh hưởng tới các đỉnh khác vẫn còn nằm trong đồ thị.</li>
</ul>
<h3 id="cai-at_3"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong>
- Hằng số <code>maxN = 100010</code> 
- Biến <code>timeDfs</code> - Thứ tự <span class="arithmatex">\(DFS\)</span>
- Biến <code>scc</code> - Số lượng thành phần liên thông mạnh
- Mảng <code>low[], num[]</code>
- Mảng <code>deleted[]</code> - Đánh dấu các đỉnh đã bị xóa
- Vector <code>g[]</code> - Danh sách cạnh kề của mỗi đỉnh 
- Ngăn xếp <code>st</code> - Lưu lại các đỉnh trong thành phần liên thông mạnh</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100010</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">scc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">deleted</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="n">stack</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">st</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">deleted</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">scc</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="w"> </span>
<span class="w">            </span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">            </span><span class="n">deleted</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">scc</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_3"><strong>Đánh giá</strong></h3>
<ul>
<li>Độ phức tạp của thuật toán <span class="arithmatex">\(Tarjan\)</span> là <span class="arithmatex">\(O(N + M)\)</span></li>
</ul>
<h2 id="bai-toan-5">Bài toán 5</h2>
<p><a href="https://oj.vnoi.info/problem/kcollect">KCOLLECT - Thu hoạch</a></p>
<h3 id="e-bai_4"><strong>Đề bài</strong></h3>
<p>Khu vườn của Pirate có hình chữ nhật, và được chia thành <span class="arithmatex">\(M \cdot N\)</span> ô vuông bằng nhau. Trong mỗi ô vuông có một cây thuộc một loại quả khác nhau, đánh số từ <span class="arithmatex">\(0\)</span> đến <span class="arithmatex">\(9\)</span>. Những con số này thể hiện giá trị kinh tế của các loại cây.
Tuy nhiên, nhìn mặt con Robot trái cây này có vẻ ngu ngu nên trong lần đầu tiên thử việc, Pirate muốn test AI của nó. Cụ thể là Robot phải tuân theo các quy định sau:
1. Tại mỗi ô, Robot chỉ có thể đi sang hướng đông hoặc hướng nam sang ô kề cạnh.
2. Có một số ô đặc biệt mà tại đó Robot có thể đi được thêm hướng tây hoặc hướng bắc sang ô kề cạnh (chỉ một trong hai).
3. Robot không được đi vào những ô có cây dừa.
4. Robot được đi qua một ô nhiều lần. Khi đi qua một ô, Robot phải hái hết quả ở cây trong ô đó. Lợi nhuận thu được sẽ bằng chỉ số của loại cây vừa được thu hái. Và sau này, không thể đạt thêm lợi nhuận gì từ ô đó nữa.</p>
<p>Xuất phát từ ô ở góc tây bắc của khu vườn, hãy giúp Robot trái cây xác định hành trình để đạt được lợi nhuận tối đa.</p>
<p><strong>Input</strong></p>
<ul>
<li>Dòng thứ nhất: ghi hai số nguyên <span class="arithmatex">\(M\)</span> và <span class="arithmatex">\(N\)</span> - kích thước của khu vườn.</li>
<li><span class="arithmatex">\(M\)</span> dòng tiếp theo: mỗi dòng ghi <span class="arithmatex">\(N\)</span> kí tự liên tiếp nhau mô tả khu vườn:<ul>
<li>'0' - '9': các loại trái cây;</li>
<li>'#': cây dừa;</li>
<li>'W': được quyền đi theo hướng tây;</li>
<li>'N': được quyền đi theo hướng bắc.</li>
</ul>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>Ghi một số nguyên duy nhất là lợi nhuận tối đa đạt được.</li>
</ul>
<p><strong>Example</strong></p>
<p><strong>Input</strong>
<div class="highlight"><pre><span></span><code>2 3
264
3WW
</code></pre></div></p>
<p><strong>Output</strong>
<div class="highlight"><pre><span></span><code>15
</code></pre></div></p>
<p><strong>Note</strong>
- Robot sẽ đi theo hành trình như sau <span class="arithmatex">\((1, 1) \rightarrow (1, 2) \rightarrow (1, 3) \rightarrow (2, 3) \rightarrow (2, 2) \rightarrow (2, 1)\)</span> 
(ô <span class="arithmatex">\((i, j)\)</span> là ô ở dòng <span class="arithmatex">\(i\)</span> và cột <span class="arithmatex">\(j\)</span>). Tổng lợi nhuận sẽ là <span class="arithmatex">\(2 + 6 + 4 + 3 = 15\)</span>.</p>
<h3 id="phan-tich_3"><strong>Phân tích</strong></h3>
<ul>
<li><strong>Tại sao ta không thể Quy hoạch động ngay được?</strong>
    Theo đề bài, ở tại mỗi ô Robot có thể đi sang hướng đông (đi sang phải) hoặc hướng nam (đi xuống dưới) sang ô kề cạnh. Tuy nhiên ở những ô đặc biệt thì Robot có thể đi thêm hướng tây (đi sang trái) hoặc hướng bắc (đi lên trên). Và một ô có thể được Robot đi qua nhiều lần. Chính vì lí do này thế nên cách đi của Robot sẽ tạo thành chu trình. Khi đường đi tạo thành chu trình thì khi ta QHĐ sẽ bị vô hạn.</li>
<li><strong>Làm sao để đường đi không tạo thành chu trình?</strong>
    Một đồ thị có hướng là <strong>liên thông mạnh</strong> nếu như có đường từ bất kì đỉnh này tới bất kì đỉnh nào khác. <strong>Một thành phần liên thông mạnh</strong> của một đồ thị có hướng là một đồ thị con tối đại liên thông mạnh. Nếu mỗi <strong>thành phần liên thông mạnh</strong> được <strong>co lại</strong> thành một đỉnh, thì đồ thị sẽ trở thành một <strong>đồ thị có hướng không có chu trình</strong>. Khi dựng đồ thị mới ta sẽ có cung <span class="arithmatex">\((u,v)\)</span> nếu tồn tại một đỉnh <span class="arithmatex">\(x\)</span> bất kì nằm trong thành phần liên thông mạnh mang nhãn <span class="arithmatex">\(u\)</span> có cung tới một đỉnh <span class="arithmatex">\(y\)</span> bất kì nằm trong thành phần liên thông mạnh mang nhãn <span class="arithmatex">\(v\)</span>.</li>
<li><strong>Mấu chốt của bài toán này là:</strong> Tìm ra được các thành phần liên thông mạnh, co từng thành phần liên thông mạnh thành <span class="arithmatex">\(1\)</span> đỉnh. Lúc này đồ thị mới sẽ là <strong>đồ thị DAG (Directed Acyclic Graph)</strong>. Đây là đồ thị <strong>"một đi không trở lại"</strong>, vậy nên ta dễ dàng <strong>QHĐ trên đồ thị DAG</strong>.</li>
<li><strong>Công thức QHĐ trên đồ thị DAG:</strong> <span class="arithmatex">\(f[u] = max(f[v]) + C[u]\)</span> với mọi <span class="arithmatex">\(u\)</span> có cung trực tiếp đi tới <span class="arithmatex">\(v\)</span>; trong đó <span class="arithmatex">\(C[u]\)</span> là tổng giá trị kinh tế của đỉnh <span class="arithmatex">\(u\)</span> , <span class="arithmatex">\(f[u]\)</span> là tổng giá trị kinh tế lớn nhất khi ta xuất phát tại <span class="arithmatex">\(u\)</span> và kết thúc tại <span class="arithmatex">\(1\)</span> đỉnh bất kì vì ta có thể đi từ <span class="arithmatex">\(u\)</span> sang <span class="arithmatex">\(v\)</span> rồi đi theo đường đi tối ưu xuất phát tại <span class="arithmatex">\(v\)</span> (<span class="arithmatex">\(u,v\)</span> ở đây là các đỉnh trên đồ thị <span class="arithmatex">\(DAG\)</span> được tạo ra). </li>
</ul>
<h3 id="cai-at_4"><strong>Cài đặt</strong></h3>
<p><strong>Cấu trúc dữ liệu:</strong>
- Để có thể dễ dàng cài đặt thì ta sẽ sử dụng kĩ thuật <strong>"Biến mảng 2 chiều thành mảng 1 chiều"</strong> nhằm mục đích lưu giá trị ô <span class="arithmatex">\((i, j)\)</span> vào ô <span class="arithmatex">\((i - 1) \cdot N + j\)</span>.
- Hằng số <code>maxN = 100010</code> 
- Hằng số <code>INF = 1000000007</code> 
- Biến <code>timeDfs</code> - Thứ tự <span class="arithmatex">\(DFS\)</span>
- Biến <code>scc</code> - Số lượng thành phần liên thông mạnh
- Mảng <code>a[]</code> - Lưu các dữ liệu vào.
- Mảng <code>val[]</code> - Lưu giá trị kinh tế của loại cây.
- Mảng <code>totalScc[]</code> - Lưu tổng giá trị kinh tế của từng thành phần liên thông mạnh.
- Mảng <code>root[]</code> - Lưu ô <span class="arithmatex">\((i, j)\)</span> thuộc thành phần liên thông nào? Ta sẽ lấy thứ tự của thành phần liên thông làm đỉnh ảo trong đồ thị <span class="arithmatex">\(DAG\)</span>.
- Mảng <code>low[], num[]</code>
- Mảng <code>deleted[]</code> - Đánh dấu các đỉnh đã bị xóa
- Mảng <code>f[]</code> - Mảng quy hoạch động
- Vector <code>g[]</code> - Lưu đồ thị ban đầu.
- Vector <code>h[]</code> - Lưu đồ thị mới (<strong>đồ thị <em>DAG</em></strong>).</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100010</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">INF</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1e9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">dx</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">dy</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">-1</span><span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">totalScc</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="cm">/* Lưu đồ thị ban đầu*/</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="cm">/* Lưu đồ thị mới*/</span>
<span class="n">vector</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="cm">/* Kỹ thuật &quot;Biến mảng 2 chiều thành mảng 1 chiều&quot; */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">getId</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">){</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Kiểm tra ô (i, j) có được đi vào không? */</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Tìm thành phần liên thông mạnh*/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">root</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">maxN</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">deleted</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeDfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">scc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">stack</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">st</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">timeDfs</span><span class="p">;</span>
<span class="w">    </span><span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">deleted</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">scc</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<span class="w">            </span><span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">            </span><span class="n">deleted</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">            </span><span class="cm">/* Tính tổng giá trị kinh tế của thành phần liên thông */</span>
<span class="w">            </span><span class="n">totalScc</span><span class="p">[</span><span class="n">scc</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">val</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>

<span class="w">            </span><span class="cm">/*Đỉnh scc sẽ là đỉnh ảo đại diện cho v trong đồ thị DAG*/</span>
<span class="w">            </span><span class="n">root</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scc</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>


<span class="cm">/* Quy hoạch động trên đồ thị DAG */</span>
<span class="kt">int</span><span class="w"> </span><span class="n">f</span><span class="p">[</span><span class="n">maxN</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">totalScc</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">INF</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">cur</span><span class="p">,</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">totalScc</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Xử lý dữ liệu đầu vào */</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">            </span><span class="n">val</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/* Xây dựng đồ thị ban đầu */</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">));</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;W&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span>
<span class="w">                </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;N&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span>
<span class="w">                </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/* Tìm thành phần liên thông mạnh*/</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/* Xây dựng đồ thị mới */</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">u</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">getId</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">ru</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ru</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">rv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Có cung đi từ ru đến rv trên đồ thị mới do đỉnh </span>
<span class="cm">                u trong TPLTM ru đi được tới đỉnh v trong TPLTM rv*/</span>
<span class="w">                    </span><span class="n">h</span><span class="p">[</span><span class="n">ru</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">rv</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">fill</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">getId</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="anh-gia_4"><strong>Đánh giá</strong></h3>
<ul>
<li>Độ phức tạp của bài toán là <span class="arithmatex">\(O(N \cdot M)\)</span></li>
</ul>
<h1 id="bai-tap-van-dung">Bài tập vận dụng</h1>
<h3 id="khop-cau">Khớp cầu</h3>
<p><a href="https://oj.vnoi.info/problem/weather">WEATHER - Điều kiện thời tiết</a></p>
<p><a href="https://oj.vnoi.info/problem/critical/">CRITICAL - Thành phố trọng yếu</a></p>
<p><a href="https://www.spoj.com/PTIT/problems/BCACM11E/">BCACM11E - Phương án bắn pháo</a></p>
<p><a href="https://oj.vnoi.info/problem/safenet2">SAFENET2 - Mạng máy tính an toàn </a></p>
<p><a href="https://oj.vnoi.info/problem/reform">REFORM - VOI 2015 Day 1 - Kế hoạch cải tổ</a></p>
<h3 id="thanh-phan-lien-thong-manh">Thành phần liên thông mạnh</h3>
<p><a href="https://codeforces.com/contest/894/problem/E">Ralph and Mushrooms</a></p>
<p><a href="https://codeforces.com/contest/427/problem/C">Checkposts</a></p>
<p><a href="https://oj.vnoi.info/problem/message">MESSAGE - Truyền tin</a></p>
<p><a href="https://oj.vnoi.info/problem/treat">TREAT - Cho kẹo hay bị phá nào</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../js/jquery-3.7.1.min.js"></script>
      
        <script src="../../../js/webjs.js"></script>
      
    
  </body>
</html>