
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/KienPC1234/fptoj_wiki/algo/data-structures/prefix-sum-and-difference-array/">
      
      
        <link rel="prev" href="../persistent-data-structures/">
      
      
        <link rel="next" href="../rmq/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Mảng cộng dồn và mảng hiệu - FPTOJ WIKI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mang-cong-don-va-mang-hieu" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FPTOJ WIKI" class="md-header__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FPTOJ WIKI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mảng cộng dồn và mảng hiệu
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ tối"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ tối" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Chuyển sang chế độ sáng"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Chuyển sang chế độ sáng" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FPTOJ WIKI" class="md-nav__button md-logo" aria-label="FPTOJ WIKI" data-md-component="logo">
      
  <img src="../../../uploads/icon.svg" alt="logo">

    </a>
    FPTOJ WIKI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trang chủ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giới thiệu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Markdown
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Thuật Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Thuật Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cơ Bản
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Cơ Bản
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/backtracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đệ quy và Thuật toán quay lui
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán tìm kiếm nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bitwise-operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phép toán bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/computational-complexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp thời gian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 1: vòng lặp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/hoc-tin-the-nao-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tôi đã học tin học như thế nào? Phần 2: bắt đầu từ đâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/meet-in-the-middle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán sắp xếp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/Tai-Lieu-Thuat-Toan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số Tài liệu hay về Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/two-pointers.md78" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật hai con trỏ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đại Số
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Đại Số
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/binary_exponentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lũy thừa nhị phân
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/euclid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Euclid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/fft-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Biến đổi Fourier nhanh - Fast Fourier transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/nCk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cách tính số tổ hợp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/primality_check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kiểm tra số nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algebra/prime_sieve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sàng nguyên tố
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../array-vs-linked-lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng và danh sách liên kết
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../C%C3%A2y-Palindrome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc của cây Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-structures-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng quan về Cấu Trúc Dữ Liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deque-min-max/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàng đợi hai đầu (deque) và Bài toán tìm max-min trong đoạn tịnh tiến
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Deque/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deque - hàng đợi hai đầu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../disjoint-set-union/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Set Union
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../disjoint-set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoints Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fenwick-2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân 2 chiều (BIT 2 chiều)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fenwick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây chỉ số nhị phân (Binary Indexed Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Table)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heavy-light-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heavy-Light Decomposition (HLD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interval-tree-tap-doan-thang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interval Tree trên tập đoạn thẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lca-binlift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lowest Common Ancestor (LCA) - Binary Lifting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các phương pháp giải bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../persistent-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistent Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Mảng cộng dồn và mảng hiệu
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Mảng cộng dồn và mảng hiệu
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#khai-niem" class="md-nav__link">
    <span class="md-ellipsis">
      Khái niệm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Khái niệm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-prefix-sum" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn (prefix sum)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-difference-array" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu (difference array)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cai-at" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cài đặt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tinh-chat" class="md-nav__link">
    <span class="md-ellipsis">
      Tính chất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tính chất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#o-dai-mang" class="md-nav__link">
    <span class="md-ellipsis">
      Độ dài mảng
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinh-rieng-biet" class="md-nav__link">
    <span class="md-ellipsis">
      Tính riêng biệt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lien-he-giua-mang-cong-don-va-mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Liên hệ giữa mảng cộng dồn và mảng hiệu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ung-dung-cua-mang-cong-don" class="md-nav__link">
    <span class="md-ellipsis">
      Ứng dụng của mảng cộng dồn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ứng dụng của mảng cộng dồn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-toan-minh-hoa" class="md-nav__link">
    <span class="md-ellipsis">
      Bài toán minh họa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ung-dung-cua-mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Ứng dụng của mảng hiệu
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ứng dụng của mảng hiệu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-toan-minh-hoa_1" class="md-nav__link">
    <span class="md-ellipsis">
      Bài toán minh họa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mo-rong-sang-mang-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mở rộng sang mảng nhiều chiều
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mở rộng sang mảng nhiều chiều">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-hai-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn hai chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-ba-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn ba chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-hai-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu hai chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-ba-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu ba chiều
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mo-rong-sang-mang-ong" class="md-nav__link">
    <span class="md-ellipsis">
      Mở rộng sang mảng động
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bai-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Bài tập
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bài tập">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-1-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn 1 chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-1-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu 1 chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn nhiều chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu nhiều chiều
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Range Minimum Query (RMQ) - Sparse Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segment-tree-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây Phân Đoạn (cơ bản)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segment-tree-extend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tất tần tật về Cây Phân Đoạn (Segment Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Skip-Lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip Lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sqrt-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chia căn (sqrt decomposition) và ứng dụng: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack (ngăn xếp)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../suffix-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mảng hậu tố (Suffix Array)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../suffix-automaton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suffix Automaton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trie
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quy hoạch động
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Quy hoạch động
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-dynamic-programming-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quy hoạch động cơ bản (Phần 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số bài toán quy hoạch động điển hình
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/Mot-so-ky-thuat-toi-uu-hoa-thuat-toan-Quy-Hoach-Dong/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một số kĩ thuật tối ưu hoá thuật toán Quy Hoạch Động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/palindrome-problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Một vài bài tập về Palindrome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/thac-mac-ve-qhd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phân tích về QHĐ - Thầy Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Games
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Games
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../games/Giai-Thuat-Cat-Tia-Alpha-beta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thuật cắt tỉa Alpha-beta
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hình học
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Hình học
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 1: Những khái niệm cơ bản
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/basic-geometry-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hình học tính toán phần 2: Sự giao nhau của đường thẳng và các ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/Sweep-Line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán đường quét
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lý thuyết Đồ Thị
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Lý thuyết Đồ Thị
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/breadth-first-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BFS (Breadth-first search)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/centroid-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán phân tách trọng tâm - Centroid decomposition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/Depth-First-Search-Tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây DFS (Depth-First Search Tree) và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/euler-cycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi - Chu trình Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/euler-tour-on-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Đường đi Euler trên cây
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/everything/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các chủ đề cơ bản về đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán Luồng cực đại trên mạng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/lubenica-vnoj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán LUBENICA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/minimum-spanning-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán tìm cây khung nhỏ nhất trong đồ thị
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/shortest-path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các thuật toán về tìm đường đi ngắn nhất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph-theory/topological-sort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sắp xếp Tô-pô (Topological Sort)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Toán
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Toán
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lý thuyết trò chơi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/Ham-Mobius/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/modular-inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4.5 - Nghịch đảo modulo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/multiplicative-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm nhân tính
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tìm Kiếm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Tìm Kiếm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/Local-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kỹ Năng Thi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Kỹ Năng Thi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Ki-nang-thi-cu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tổng hợp các lời khuyên cho các kỳ thi
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/Kinh-nghiem-thi-VOI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinh nghiệm thi VOI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skill/viet-trinh-cham/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tự code, tự chấm, tự sướng - Bí kíp thi offline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xâu kí tự
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Xâu kí tự
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xử lý xâu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash: A String Matching Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán KMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/manacher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Manacher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z-function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mẹo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Mẹo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Ph%E1%BB%8Fng-v%E1%BA%A5n-team-IOI-VN-2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phỏng Vấn Team IOI VN 2017
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/vojsol/ALAKE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALAKE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/convex_greedy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sum-constrained convex optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/counting-without-matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Khử nhân ma trận
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/FFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/matrix-multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhân ma trận (Matrix multiplication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/mitm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meet In The Middle (MITM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../trick/Roi-rac-hoa-va-ung-dung/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rời rạc hoá và ứng dụng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computer Science (Khoa học máy tính)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computer Science (Khoa học máy tính)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Cipher-Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mật mã và Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/Public-Key-Cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public Key Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/crypto/cipher/ROT13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROT13
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xử lý ảnh
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Xử lý ảnh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/Seam-Carving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seam Carving Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/imageprocessing/setup-opencv-windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hướng dẫn cài đặt OpenCV trên Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ngôn Ngữ Lập Trình
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Ngôn Ngữ Lập Trình
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/pointers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Con trỏ trong C/C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../languages/cpp/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xâu trong C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/Pascal-Vi-sao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hoài niệm về Pascal - Lê Minh Hoàng
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dịch Thuật
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Dịch Thuật
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/functional-programming-part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming - Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/Efficient-and-easy-segment-trees/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cài đặt cây phân đoạn hiệu quả (Efficient and easy segment trees)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/hash-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bảng băm (Hash Tables)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/palindrome-tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palindrome tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/stack-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue & Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/codeforces/z-algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    E-Maxx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            E-Maxx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Aho-Corasick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aho Corasick
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/emaxx/Tim-kiem-tam-phan-Ternary-Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tìm kiếm tam phân - Ternary Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nâng Cao
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Nâng Cao
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Lucas-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Lucas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 2 - Số nguyên tố, Sàng Eratosthenes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 3 - Tính (a^b) % c
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 4 - Phi hàm Euler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 5 - Các kiến thức cơ bản về Tổ hợp (Combinatorics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 6 - Xác suất (Probabilities)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Number-Theory-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 7 - Bao hàm - Loại trừ (Inclusion-Exclusion)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/So-hoc-Phan-1-Modulo-gcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Số học 1 - Modulo & gcd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/he/Wilsons-theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Định lý Wilson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Máy học (Machine Learning - ML)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Máy học (Machine Learning - ML)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ml/machine-learning-101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning 101 (1): Làm quen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/PyTorch-la-gi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Là Gì?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/ml/Machine-Learning-Classification-phan-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning - Classification - phần 3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quora
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Quora
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/quora/mobius-function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hàm Mobius
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topcoder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Topcoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Computational-Complexity-Section-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Độ phức tạp tính toán - phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/dynamic-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nhập môn Quy hoạch động
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/fun-with-bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fun with Bits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Greedy-is-Good/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Tham lam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Hieu-ve-xac-suat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xác suất
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Dissect-a-Topcoder-Problem-Statement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ năng đọc đề Topcoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/How-to-Find-a-Solution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nghệ thuật giải bài
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Mathematics-for-Topcoders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toán học trong Tin học
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/max-flow-1-luong-cuc-dai-tren-mang-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luồng cực đại trên mạng - Maxflow network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Planning-an-Approach-to-a-Topcoder-Problem-Part-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Những cách tiếp cận bài toán: Phần 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán RMQ và bài toán LCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/The-Importance-of-Algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tầm Quan Trọng Của Thuật Toán
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/topcoder/Using-Regular-Expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sử dụng Regex
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    USACO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            USACO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/USACO/Crafting-Winning-Solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viết lời giải chiến thắng trong kì thi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wcipeg
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            Wcipeg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Bao-l%E1%BB%93i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải thích trực quan về bao lồi trên mặt phẳng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Binary-Heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull-Trick/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật bao lồi (Convex Hull Trick)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Convex-Hull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bao lồi (Convex Hull)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/Flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bài toán luồng cực đại
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/kmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thuật toán Knuth-Morris-Pratt (KMP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../translate/wcipeg/tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây (Tree)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#khai-niem" class="md-nav__link">
    <span class="md-ellipsis">
      Khái niệm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Khái niệm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-prefix-sum" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn (prefix sum)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-difference-array" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu (difference array)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cai-at" class="md-nav__link">
    <span class="md-ellipsis">
      Cài đặt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cài đặt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tinh-chat" class="md-nav__link">
    <span class="md-ellipsis">
      Tính chất
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tính chất">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#o-dai-mang" class="md-nav__link">
    <span class="md-ellipsis">
      Độ dài mảng
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinh-rieng-biet" class="md-nav__link">
    <span class="md-ellipsis">
      Tính riêng biệt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lien-he-giua-mang-cong-don-va-mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Liên hệ giữa mảng cộng dồn và mảng hiệu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ung-dung-cua-mang-cong-don" class="md-nav__link">
    <span class="md-ellipsis">
      Ứng dụng của mảng cộng dồn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ứng dụng của mảng cộng dồn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-toan-minh-hoa" class="md-nav__link">
    <span class="md-ellipsis">
      Bài toán minh họa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ung-dung-cua-mang-hieu" class="md-nav__link">
    <span class="md-ellipsis">
      Ứng dụng của mảng hiệu
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ứng dụng của mảng hiệu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-toan-minh-hoa_1" class="md-nav__link">
    <span class="md-ellipsis">
      Bài toán minh họa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mo-rong-sang-mang-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mở rộng sang mảng nhiều chiều
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mở rộng sang mảng nhiều chiều">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-hai-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn hai chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-ba-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn ba chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-hai-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu hai chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-ba-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu ba chiều
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mo-rong-sang-mang-ong" class="md-nav__link">
    <span class="md-ellipsis">
      Mở rộng sang mảng động
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bai-tap" class="md-nav__link">
    <span class="md-ellipsis">
      Bài tập
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bài tập">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-1-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn 1 chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-1-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu 1 chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-cong-don-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng cộng dồn nhiều chiều
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mang-hieu-nhieu-chieu" class="md-nav__link">
    <span class="md-ellipsis">
      Mảng hiệu nhiều chiều
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="mang-cong-don-va-mang-hieu">Mảng cộng dồn và mảng hiệu</h1>
<p><strong>Tác giả:</strong> 
- Bùi Nguyễn Đức Tân - VNU-HCM, High School for the Gifted</p>
<p><strong>Reviewer:</strong>
- Trần Quang Lộc - ITMO University
- Hoàng Xuân Nhật - VNU-HCM, University of Science
- Nguyễn Phú Bình - Hung Vuong High School for the Gifted, Binh Duong Province</p>
<hr />
<h2 id="khai-niem">Khái niệm</h2>
<h3 id="mang-cong-don-prefix-sum">Mảng cộng dồn (prefix sum)</h3>
<p>Cho một mảng <span class="arithmatex">\(A\)</span> có <span class="arithmatex">\(n\)</span> phần tử được đánh số từ <span class="arithmatex">\(0\)</span> đến <span class="arithmatex">\(n - 1\)</span>, ta dựng mảng <span class="arithmatex">\(S(A)\)</span> theo quy tắc sau:</p>
<ul>
<li><span class="arithmatex">\(S_0 = c\)</span>, với <span class="arithmatex">\(c\)</span> là một hằng số thực</li>
<li><span class="arithmatex">\(S_i = S_{i - 1} + A_{i -1} = \displaystyle c +\sum_{j = 0}^{i - 1} A_j\)</span>, với <span class="arithmatex">\(1 \le i &lt; n\)</span></li>
</ul>
<p>Mảng <span class="arithmatex">\(S(A)\)</span> được gọi là <strong>mảng cộng dồn (tiền tố)</strong> theo <span class="arithmatex">\(c\)</span> của <span class="arithmatex">\(A\)</span>, gọi cách khác là prefix sum của <span class="arithmatex">\(A\)</span>. Từ một mảng <span class="arithmatex">\(A\)</span>, ta có thể sinh ra vô hạn mảng <span class="arithmatex">\(S(A)\)</span> bằng cách chọn một số thực <span class="arithmatex">\(c\)</span> tùy ý; trên thực tế, ta thường chọn <span class="arithmatex">\(c = 0\)</span> để thuận tiện hơn khi tính toán.</p>
<p><img alt="" src="https://i.imgur.com/lzBYJ89.gif" /></p>
<h3 id="mang-hieu-difference-array">Mảng hiệu (difference array)</h3>
<p>Cũng với mảng <span class="arithmatex">\(A\)</span>, ta có thể dựng mảng <span class="arithmatex">\(D(A)\)</span> theo quy tắc: <span class="arithmatex">\(D_i = A_{i + 1} - A_i\;(0 \le i &lt; n - 1)\)</span>.</p>
<p>Mảng <span class="arithmatex">\(D(A)\)</span> được gọi là <strong>mảng hiệu</strong> của <span class="arithmatex">\(A\)</span>, có tên tiếng Anh là difference array.</p>
<p><img alt="" src="https://i.imgur.com/3IQ1YlB.gif" /></p>
<h2 id="cai-at">Cài đặt</h2>
<h3 id="mang-cong-don">Mảng cộng dồn</h3>
<p>Để dựng mảng cộng dồn, ta có thể áp dụng định nghĩa ở trên để dựng trực tiếp mảng:</p>
<div class="highlight"><pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buildPrefixSum</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="n">prefixSum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<!-- giải thích lại partial_sum -->

<p>Ngoài ra, thư viện C++ STL cũng cung cấp hàm <code>partial_sum</code> để phục vụ quá trình dựng mảng cộng dồn, cú pháp của hàm như sau:</p>
<div class="highlight"><pre><span></span><code><span class="n">partial_sum</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">binary_op</span><span class="p">)</span>
</code></pre></div>
<p>Hàm trên sẽ thực hiện tính mảng cộng dồn với toán tử <code>binary_op</code> trên các container của C++ có iterator trỏ từ <code>[first, last)</code> và trả mảng cộng dồn sang container bắt đầu từ iterator trỏ về <code>result</code>.</p>
<p>Có hai lưu ý quan trọng khi sử dụng hàm này:</p>
<ul>
<li>Hàm <code>partial_sum</code> duyệt qua các phần tử của container theo tính chất của iterator của container đó; vì thế giá trị của mảng cộng dồn sẽ phụ thuộc vào thứ tự xuất hiện của các phần tử trong container đó.</li>
<li>Tham số <code>binary_op</code> có thể được để trống. Khi này, toán tử mặc định là phép cộng (<code>+</code>).</li>
</ul>
<p>Bạn đọc có thể tham khảo thêm về hàm này tại trang <a href="https://en.cppreference.com/w/cpp/algorithm/partial_sum">cppreference</a>.</p>
<p>Code minh họa:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">printArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">arr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">arr</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-6</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="c1">// Dựng thủ công</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefOne</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildPrefixSum</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">printArray</span><span class="p">(</span><span class="n">prefOne</span><span class="p">);</span><span class="w"> </span><span class="c1">// 0 3 2 -2 -1 4 13 11 5</span>

<span class="c1">// Dựng bằng partial_sum</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefTwo</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="n">partial_sum</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">prefTwo</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
<span class="n">printArray</span><span class="p">(</span><span class="n">prefTwo</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3 2 -2 -1 4 13 11 5</span>
</code></pre></div>
<p>Trong cả hai cách trên, độ phức tạp của quá trình dựng là <span class="arithmatex">\(\mathcal{O}(n)\)</span>.</p>
<h3 id="mang-hieu">Mảng hiệu</h3>
<p>Tương tự, ta cũng có thể áp dụng định nghĩa để dựng trực tiếp mảng hiệu:</p>
<div class="highlight"><pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buildDifferenceArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">differenceArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Ngoài ra, thư viện C++ STL cũng cung cấp hàm <code>adjacent_difference</code> để phục vụ quá trình dựng mảng cộng dồn, cú pháp của hàm như sau:</p>
<div class="highlight"><pre><span></span><code><span class="n">adjacent_difference</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">binary_op</span><span class="p">)</span>
</code></pre></div>
<p>Hàm trên sẽ thực hiện tính mảng hiệu với toán tử <code>binary_op</code> trên các container của C++ có iterator trỏ từ <code>[first, last)</code> và trả mảng hiệu sang container bắt đầu từ iterator trỏ về <code>result</code>.</p>
<p>Các lưu ý ở phần <code>partial_sum</code> cũng được áp dụng cho hàm này.</p>
<p>Bạn đọc có thể tham khảo thêm về hàm này tại trang <a href="https://en.cppreference.com/w/cpp/algorithm/difference_array">cppreference</a>.
Code minh họa:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Dựng thủ công</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">diffOne</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildDifferenceArray</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">printArray</span><span class="p">(</span><span class="n">diffOne</span><span class="p">);</span>
<span class="c1">// -4 -3 5 4 4 -11 -4</span>

<span class="c1">// Dựng bằng partial_sum</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">diffTwo</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="n">adjacent_difference</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">diffTwo</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
<span class="n">printArray</span><span class="p">(</span><span class="n">diffTwo</span><span class="p">);</span>
<span class="c1">// 3 -4 -3 5 4 4 -11 -4</span>
</code></pre></div>
<p>Trong cả hai cách trên, độ phức tạp của quá trình dựng là <span class="arithmatex">\(\mathcal{O}(n)\)</span>.</p>
<h2 id="tinh-chat">Tính chất</h2>
<h3 id="o-dai-mang">Độ dài mảng</h3>
<ul>
<li>Đối với <strong>mảng cộng dồn</strong>, do ta cần thêm một hằng số <span class="arithmatex">\(c\)</span> ở đầu mảng, độ dài của mảng <span class="arithmatex">\(S(c, A)\)</span> là <span class="arithmatex">\(n + 1\)</span>, nhiều hơn 1 phần tử so với mảng <span class="arithmatex">\(A\)</span> gốc.</li>
<li>Ngược lại, <strong>mảng hiệu</strong> được dựng dựa trên hiệu của hai phần tử liền kề nhau. Tuy nhiên, trong mảng <span class="arithmatex">\(A\)</span> chỉ có <span class="arithmatex">\(n - 1\)</span> cặp như vậy, vì thế độ dài của <span class="arithmatex">\(D(A)\)</span> là <span class="arithmatex">\(n - 1\)</span>, ít hơn 1 phần tử so với mảng <span class="arithmatex">\(A\)</span> gốc.</li>
</ul>
<h3 id="tinh-rieng-biet">Tính riêng biệt</h3>
<ul>
<li>Từ một mảng <span class="arithmatex">\(A\)</span> bất kỳ, ta sinh được vô hạn mảng cộng dồn <span class="arithmatex">\(S(c, A)\)</span> từ <span class="arithmatex">\(A\)</span>. Tuy nhiên, các mảng cộng dồn này chỉ khác nhau ở giá trị <span class="arithmatex">\(c\)</span> được chọn.</li>
<li>Cũng với mảng <span class="arithmatex">\(A\)</span> đó, ta sinh được <strong>một và chỉ một</strong> mảng hiệu <span class="arithmatex">\(D(A)\)</span> từ <span class="arithmatex">\(A\)</span>.</li>
</ul>
<h3 id="lien-he-giua-mang-cong-don-va-mang-hieu">Liên hệ giữa mảng cộng dồn và mảng hiệu</h3>
<p>Cho mảng cộng dồn <span class="arithmatex">\(S(c, A)\)</span> và mảng hiệu <span class="arithmatex">\(D(A)\)</span>, ta có thể dễ dàng khôi phục nội dung của mảng <span class="arithmatex">\(A\)</span> thông qua các phép sau:</p>
<ul>
<li><span class="arithmatex">\(S(A_0, D(A)) = A\)</span></li>
<li><span class="arithmatex">\(D(S(c, A)) = A\)</span> với mọi <span class="arithmatex">\(c\)</span> thực</li>
</ul>
<p>Hình dưới đây mô tả rõ hơn mối liên hệ giữa mảng gốc, mảng hiệu và mảng cộng dồn sinh ra từ nó:
<img alt="" src="https://i.imgur.com/agrVFdU.png" /></p>
<p>Hàm <code>partial_sum</code> và <code>adjacent_difference</code> trong C++ STL cũng tuân theo quy tắc này trên. Tuy nhiên, các thao tác trên hai hàm này có phần phức tạp hơn so với thao tác trên mảng mà ta cài đặt thủ công.</p>
<h2 id="ung-dung-cua-mang-cong-don">Ứng dụng của mảng cộng dồn</h2>
<p>Mảng cộng dồn có một tính chất quan trọng: các phần tử được cộng lại chồng chất lên nhau một cách liên tiếp, vì thế, với mọi nửa khoảng <span class="arithmatex">\([l, r)\)</span> <span class="arithmatex">\((0 \le l &lt; r \le n)\)</span>, ta chỉ cần tính <span class="arithmatex">\(S_r - S_l\)</span> để tính tổng của các phần tử <span class="arithmatex">\(A_l, A_{l + 1},\dots, A_{r - 2}, A_{r - 1}\)</span>. Việc trừ này cũng sẽ khử đi hằng số <span class="arithmatex">\(c\)</span> của <span class="arithmatex">\(S\)</span>, vì thế ta có thể dùng bất kỳ mảng <span class="arithmatex">\(S\)</span> nào được sinh từ <span class="arithmatex">\(A\)</span> để tính tổng.</p>
<p><strong>Chứng minh:</strong></p>
<p>Theo định nghĩa: <span class="arithmatex">\(S_i = c + \displaystyle \sum_{j = 0}^{i - 1} A_j\)</span></p>
<p>Khi này: </p>
<div class="arithmatex">\[
\begin{align*}
S_r - S_l &amp;= c + \displaystyle \sum_{j = 0}^{r - 1} A_j - \bigg(c + \displaystyle \sum_{j = 0}^{l - 1} A_j\bigg) \\
&amp;= c + \displaystyle \sum_{j = 0}^{r - 1} A_j - c - \displaystyle \sum_{j = 0}^{l - 1} A_j \\
&amp;= c - c + \displaystyle \sum_{j = 0}^{r - 1} A_j - \displaystyle \sum_{j = 0}^{l - 1} A_j \\
&amp;= \displaystyle \sum_{j = l}^{r - 1} A_j + \displaystyle \sum_{j = 0}^{l - 1} A_j - \displaystyle \sum_{j = 0}^{l - 1} A_j \\
&amp;= \displaystyle \sum_{j = l}^{r - 1} A_j \quad \blacksquare
\end{align*}
\]</div>
<p>Trong đa số trường hợp, mảng cộng dồn thường được sử dụng nếu bài toán yêu cầu tính tổng một đoạn con nhiều lần liên tiếp. Dưới đây, ta sẽ đề cập một số bài toán có điều kiện trên.</p>
<h3 id="bai-toan-minh-hoa">Bài toán minh họa</h3>
<p>Nguồn: <a href="https://cses.fi/problemset/task/1643">CSES - Maximum Subarray Sum</a></p>
<p>Đề bài: Cho một mảng <span class="arithmatex">\(A\)</span> gồm <span class="arithmatex">\(n\)</span> phần tử. Tìm đoạn con khác rỗng có tổng lớn nhất. Giới hạn: <span class="arithmatex">\(1 \le n \le 2 \cdot 10^5\)</span>, <span class="arithmatex">\(\lvert A_i \rvert \le 10^9\)</span></p>
<p>Trước hết, ta tạo mảng <span class="arithmatex">\(pref = S(0, A)\)</span> để lưu mảng cộng dồn của <span class="arithmatex">\(A\)</span>. Giả sử với <span class="arithmatex">\(r\)</span> cố định, ta cần tìm <span class="arithmatex">\(l &lt; r\)</span> sao cho tổng các phần tử trong nửa khoảng <span class="arithmatex">\([l, r)\)</span> đạt cực đại. Ta viết lại bài toán theo công thức sau:</p>
<div class="arithmatex">\[
\begin{align*}
ans_r &amp;= \max_{0 \, \le \, l \, &lt; \, r} (pref_r - pref_l) \\ 
&amp;= pref_r + \max_{0 \, \le \, l \, &lt; \, r} (- pref_l) \\ 
&amp;= pref_r - \min_{0 \, \le \, l \, &lt; \, r} pref_l \\ 
\end{align*}
\]</div>
<p>Nếu ta chạy <span class="arithmatex">\(r\)</span> từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(n\)</span>, ta có thể cập nhật cuốn chiếu <span class="arithmatex">\(\min\)</span> theo từng <span class="arithmatex">\(pref_r\)</span>; việc này cho phép chúng ta tính <span class="arithmatex">\(ans_r\)</span> với độ phức tạp <span class="arithmatex">\(O(1)\)</span>. Đáp án của bài toán là <span class="arithmatex">\(\displaystyle \max_{r} ans_r\)</span> với <span class="arithmatex">\(1 \le r \le n\)</span>.</p>
<p>Độ phức tạp của cách trên là <span class="arithmatex">\(\mathcal{O}(n)\)</span>. Code tham khảo:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAXN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200003</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e18</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">prefSum</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="w"> </span><span class="n">prefMin</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">INF</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="n">prefSum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefMin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">      </span><span class="n">prefSum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefSum</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">prefMin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">prefMin</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">prefSum</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="w"> </span><span class="n">prefSum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prefMin</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Lưu ý, ta có thể thu gọn <code>prefSum</code> và <code>prefMin</code> thành một biến duy nhất để tối ưu bộ nhớ sử dụng.
Bên cạnh cách giải đã đề cập, bài toán này cũng có thể giải bằng phương pháp quy hoạch động hoặc chia để trị.</p>
<h2 id="ung-dung-cua-mang-hieu">Ứng dụng của mảng hiệu</h2>
<p>Giả sử, ta cần cộng thêm một lượng <span class="arithmatex">\(k\)</span> vào một đoạn con <span class="arithmatex">\([l, r]\)</span> của mảng <span class="arithmatex">\(A\)</span>. Thay vì cộng lần lượt từng phần tử với độ phức tạp <span class="arithmatex">\(\mathcal{O}(n)\)</span>, ta có thể dựng mảng hiệu <span class="arithmatex">\(D(A)\)</span> và cập nhật trên đó với độ phức tạp <span class="arithmatex">\(\mathcal{O}(1)\)</span>. Dựng mảng hiệu <span class="arithmatex">\(D\)</span> từ <span class="arithmatex">\(A\)</span> lưu trữ chênh lệch của các cặp phần tử liền kề nhau, ta chia các trường hợp sau để nhận xét:</p>
<ul>
<li>Nếu <span class="arithmatex">\(A_i\)</span> và <span class="arithmatex">\(A_{i + 1}\)</span> đều nằm ngoài <span class="arithmatex">\([l, r]\)</span> <span class="arithmatex">\(\Rightarrow\)</span> Giá trị của hai phần tử không đổi <span class="arithmatex">\(\Rightarrow\)</span> <span class="arithmatex">\(D_i\)</span> không đổi</li>
<li>Nếu <span class="arithmatex">\(A_i\)</span> và <span class="arithmatex">\(A_{i + 1}\)</span> đều nằm trong <span class="arithmatex">\([l, r]\)</span> <span class="arithmatex">\(\Rightarrow\)</span> Giá trị của hai phần tử đều được cộng một lượng <span class="arithmatex">\(k\)</span> <span class="arithmatex">\(\Rightarrow\)</span> <span class="arithmatex">\(D_i\)</span> không đổi</li>
<li>Nếu chỉ một trong <span class="arithmatex">\(A_i\)</span> hoặc <span class="arithmatex">\(A_{i + 1}\)</span> nằm trong <span class="arithmatex">\([l, r]\)</span> <span class="arithmatex">\(\Rightarrow\)</span> Giá trị của một phần tử giữ nguyên còn phần tử còn lại được cộng một lượng <span class="arithmatex">\(k\)</span> <span class="arithmatex">\(\Rightarrow\)</span> <strong><span class="arithmatex">\(D_i\)</span> thay đổi</strong></li>
</ul>
<p>Chỉ duy nhất trường hợp cuối cùng ta cần tác động trực tiếp lên <span class="arithmatex">\(D\)</span>. Nhận thấy, trường hợp cuối chỉ thỏa khi <span class="arithmatex">\(i = l - 1\)</span> hoặc <span class="arithmatex">\(i = r\)</span>, ta chỉ cần tác động trực tiếp lên <span class="arithmatex">\(D_{l - 1}\)</span> và <span class="arithmatex">\(D_{r}\)</span> để cập nhật đoạn. Sau khi cập nhật hoàn tất, ta áp dụng tính chất <span class="arithmatex">\(S(D, A_0) = A\)</span> để lấy giá trị cuối cùng của <span class="arithmatex">\(A\)</span>.</p>
<h3 id="bai-toan-minh-hoa_1">Bài toán minh họa</h3>
<p>Nguồn: <a href="https://codeforces.com/contest/816/problem/B">Codeforces - Karen and Coffee</a></p>
<p>Đề bài: Cho một mảng <span class="arithmatex">\(A\)</span> có vô số phần tử mang giá trị <span class="arithmatex">\(0\)</span>. Có <span class="arithmatex">\(n\)</span> truy vấn cập nhật, mỗi truy vấn yêu cầu cập nhật toàn bộ phần tử từ <span class="arithmatex">\(l_i\)</span> đến <span class="arithmatex">\(r_i\)</span> thêm <span class="arithmatex">\(1\)</span>.</p>
<p>Sau khi cập nhật xong, trả lời <span class="arithmatex">\(q\)</span> câu hỏi với nội dung sau: có bao nhiêu vị trí <span class="arithmatex">\(i\)</span> thỏa <span class="arithmatex">\(a \le i \le b\)</span> và <span class="arithmatex">\(A_i \ge k\)</span>?</p>
<p>Giới hạn: <span class="arithmatex">\(k \le n \le 2 \cdot 10^5, q \le 2 \cdot 10^5, 1 \le l_i \le r_i \le 2 \cdot 10^5, 1 \le a \le b \le 2 \cdot 10^5\)</span></p>
<p>Do điều kiện <span class="arithmatex">\(l_i, r_i, a, b\)</span> của đề bài, mảng <span class="arithmatex">\(A\)</span> sẽ chỉ lưu trữ tối đa 200 nghìn phần tử, toàn bộ phần tử này đều có chỉ số dương, vì thế ta sẽ đơn thuần lưu 2 mảng này dưới dạng mảng thường.</p>
<p>Gọi <span class="arithmatex">\(D\)</span> là mảng hiệu của <span class="arithmatex">\(A\)</span>. Để xử lý truy vấn cập nhật, ta chỉ cần cập nhật giá trị của mảng <span class="arithmatex">\(D\)</span> tại 2 biên <span class="arithmatex">\(l\)</span> và <span class="arithmatex">\(r + 1\)</span> bằng cách tăng <span class="arithmatex">\(D_l\)</span> thêm <span class="arithmatex">\(1\)</span> và trừ <span class="arithmatex">\(1\)</span> khỏi <span class="arithmatex">\(D_{r + 1}\)</span>. Sau khi xử lý toàn bộ truy vấn cập nhật, ta sử dụng hệ thức <span class="arithmatex">\(S(D, 0) = A\)</span> để cập nhật lại giá trị của mảng <span class="arithmatex">\(A\)</span>.</p>
<p>Để trả lời câu hỏi, ta có thể hình dung mỗi chỉ số trong đoạn <span class="arithmatex">\([a, b]\)</span> mang giá trị <span class="arithmatex">\(1\)</span> nếu thỏa điều kiện đề bài và <span class="arithmatex">\(0\)</span> nếu không thỏa; số chỉ số thỏa mãn cũng chỉ là tổng của các phần tử nằm trong đoạn <span class="arithmatex">\([a, b]\)</span>. Từ tính chất này, ta có thể ứng dụng mảng cộng dồn để trả lời nhau câu hỏi trong <span class="arithmatex">\(\mathcal{O}(1)\)</span>. Ta đặt mảng <span class="arithmatex">\(A'\)</span> đánh dấu giá trị <span class="arithmatex">\(A_i\)</span> tương ứng có thỏa điều kiện <span class="arithmatex">\(\ge k\)</span> không, rồi dựng mảng cộng dồn <span class="arithmatex">\(S\)</span> trên <span class="arithmatex">\(A'\)</span>. Đáp án của mỗi câu hỏi sẽ là kết quả của phép tính <span class="arithmatex">\(S_{b} - S_{a - 1}\)</span>.</p>
<p>Độ phức tạp thời gian và không gian của cách này đều là <span class="arithmatex">\(\mathcal{O}(n)\)</span>. Code tham khảo:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/stdc++.h&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAXN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200003</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">++</span><span class="n">d</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="w"> </span><span class="o">--</span><span class="n">d</span><span class="p">[</span><span class="n">r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">buildPrefixSum</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAXN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="w">        </span><span class="n">update</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">buildPrefixSum</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">query</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="mo-rong-sang-mang-nhieu-chieu">Mở rộng sang mảng nhiều chiều</h2>
<p>Ta có thể mở rộng mảng cộng dồn và mảng hiệu để thao tác trên mảng nhiều chiều.</p>
<h3 id="mang-cong-don-hai-chieu">Mảng cộng dồn hai chiều</h3>
<p>Cho mảng hai chiều <span class="arithmatex">\(A\)</span> có kích thước <span class="arithmatex">\(m \times n\)</span> (chỉ số hàng và cột đầu tiên đều là 1), mảng cộng dồn <span class="arithmatex">\(S(A)\)</span> được dựng theo công thức sau: <span class="arithmatex">\(<span class="arithmatex">\(S_{i,j}=\displaystyle \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i,t_j}\)</span>\)</span></p>
<p>Các phần tử trong mảng cộng dồn lưu tổng của toàn bộ phần tử chứa trong hình chữ nhật <span class="arithmatex">\([1, i] \times [1, j]\)</span>.
Điểm khác biệt so với mảng cộng dồn 1 chiều ở đây là sự lược bỏ của hằng số <span class="arithmatex">\(C\)</span>, ta ngầm quy ước: <span class="arithmatex">\(S_{0,x} = S_{y,0} = 0\)</span> với <span class="arithmatex">\(x, y\)</span> nguyên không âm khi dựng mảng cộng dồn.</p>
<p><img alt="" src="https://i.imgur.com/FhmEVv3.png" /></p>
<p>Từ công thức quy ước trên, ta thực hiện biến đổi sau để dựng mảng cộng dồn:</p>
<div class="arithmatex">\[
\begin{alignat*}{2}
\displaystyle
S_{i,j} &amp; =\sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i,t_j}\\
&amp;=\sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j} + \sum_{t_i\,=\,1}^{i - 1} A_{t_i,j} + \sum_{t_j\,=\,1}^{j - 1} A_{i,t_j} + A_{i, j}\\
&amp;=\sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j} + \sum_{t_i\,=\,1}^{i - 1} A_{t_i,j} + \sum_{t_j\,=\,1}^{j - 1} A_{i,t_j} + A_{i, j}\\
&amp;=\sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j} + \Bigg(\sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j} A_{t_i,t_j} - \sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j}\Bigg) + \Bigg(\sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j} - \sum_{t_i\,=\,1}^{i - 1} \sum_{t_j\,=\,1}^{j - 1} A_{t_i,t_j}\Bigg) + A_{i, j}\\
&amp;= S_{i-1,j-1} + S_{i-1,j} - S_{i-1,j-1} + S_{i,j-1} - S_{i-1,j-1} + A_{i, j} \\
&amp;= S_{i-1,j} + S_{i,j-1} - S_{i-1,j-1} + A_{i, j}
\end{alignat*}
\]</div>
<p>Để hình dung rõ hơn công thức biến đổi trên, bạn đọc có thể tham khảo hình ảnh dưới:</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><img alt="" src="https://i.imgur.com/3vhyF37.gif" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="" src="https://i.imgur.com/TlZhWxX.png" /></td>
</tr>
<tr>
<td style="text-align: center;">Các phần tử <span class="arithmatex">\(A_i\)</span> tô màu xanh nhạt được đánh dấu 1 lần, tô màu xanh đậm được đánh dấu tới 2 lần</td>
</tr>
</tbody>
</table>
<p>Code dưới đây dựng mảng cộng dồn hai chiều:</p>
<div class="highlight"><pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">build2DPrefixSum</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">size</span><span class="p">();</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c1">// ta truy cập a(i - 1, j - 1) do mảng A là 0-indexed</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">prefixSum</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Để tính tổng của toàn bộ các phần tử nằm trong hình chữ nhật có góc trái trên là <span class="arithmatex">\((x_1, y_1)\)</span> và góc phải dưới <span class="arithmatex">\((x_2, y_2)\)</span>, ta biến đổi tương tự để thu được công thức tính sau:</p>
<div class="arithmatex">\[
\displaystyle
\sum_{i = x_1}^{x_2} \sum_{j = y_1}^{y_2} A_{i, j} = S_{x_2,\, y_2} - S_{x_1 - 1,\, y_2} - S_{x_2,\, y_1 - 1} + S_{x_1 - 1,\, y_1 - 1}
\]</div>
<p>Phần chứng minh công thức trên xin được nhường lại cho bạn đọc. Hình ảnh dưới minh họa vì sao công thức trên cho kết quả chính xác:</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><img alt="" src="https://i.imgur.com/aqfFaz3.gif" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="" src="https://i.imgur.com/3qzbjwL.png" /></td>
</tr>
<tr>
<td style="text-align: center;">Các phần tử <span class="arithmatex">\(A_i\)</span> tô màu đỏ bị trừ tới 2 lần, vì thế cần phải cộng bù lại</td>
</tr>
</tbody>
</table>
<h3 id="mang-cong-don-ba-chieu">Mảng cộng dồn ba chiều</h3>
<p>Giả sử ta có mảng <span class="arithmatex">\(A\)</span> trong không gian 3 chiều với kích thước <span class="arithmatex">\(m \times n \times p\)</span>, ta dựng mảng <span class="arithmatex">\(S(A)\)</span> theo quy tắc sau: <span class="arithmatex">\(<span class="arithmatex">\(S_{i, j, k}=\displaystyle \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} \sum_{t_k\,=\,1}^{k} A_{t_i,t_j,t_k}\)</span>\)</span></p>
<p>Công thức sau được sử dụng để dựng mảng cộng dồn 3 chiều:</p>
<div class="arithmatex">\[
\begin{align*}
\displaystyle
S_{t_i,t_j,t_k}&amp;=A_{t_i,t_j,t_k} + S_{t_i-1,t_j,t_k} + S_{t_i,t_j-1,t_k} + S_{t_i,t_j,t_k-1} \\
&amp; \hspace{1em}- S_{t_i-1,t_j-1,t_k} - S_{t_i-1,t_j,t_k-1} - S_{t_i,t_j-1,t_k-1} + S_{t_i-1,t_j-1,t_k-1}
\end{align*}
\]</div>
<p>Tương tự, ta tính tổng các phần tử trong không gian <span class="arithmatex">\([x_1, x_2] \times [y_1, y_2] \times [z_1, z_2]\)</span> qua công thức sau:</p>
<div class="arithmatex">\[
\begin{align*}
\displaystyle
\sum_{i=x_1}^{x_2}\sum_{j=y_1}^{y_2}\sum_{k=z_1}^{z_2} A_{i, j, k}
&amp;=S_{x_2,y_2,z_2}-S_{x_1-1,y_2,z_2}-S_{x_2,y_1-1,z_2}-S_{x_2,y_2,z_1-1}\\
&amp; \, + S_{x_1-1,y_1-1,z_2} + S_{x_1-1,y_2,z_1-1} + S_{x_2,y_1-1,z_1-1} - S_{x_1-1,y_1-1,z_1-1}
\end{align*}
\]</div>
<p>Hai công thức trên được xây dựng thông qua phương pháp bao hàm - loại trừ. Bạn đọc có thể tham khảo bài viết <a href="https://vnoi.info/wiki/translate/he/Number-Theory-7.md">Bao hàm - Loại trừ</a> trên VNOI Wiki để hiểu rõ hơn lý do có được công thức trên.</p>
<p>Ta cũng có thể áp dụng phương pháp này để mở rộng cho các mảng <span class="arithmatex">\(n\)</span>-chiều. Tuy nhiên, do số lượng bài toán liên quan đến mảng trong không gian từ 4 chiều trở lên là cực hiếm, mảng cộng dồn trong không gian này gần như không có ứng dụng thực tiễn. Vì thế, bài viết xin giới hạn lại tại mảng cộng dồn trong không gian 3 chiều trở xuống.</p>
<h3 id="mang-hieu-hai-chieu">Mảng hiệu hai chiều</h3>
<p>Trước khi bắt đầu xây dựng mảng hiệu 2 chiều, ta cần định nghĩa thêm 2 khái niệm sau cho một mảng <span class="arithmatex">\(A\)</span> hai chiều có kích thước <span class="arithmatex">\(m \times n\)</span>:</p>
<ul>
<li><span class="arithmatex">\(D_{hàng}(A)\)</span> gồm <span class="arithmatex">\(m\)</span> hàng, hàng thứ <span class="arithmatex">\(i\)</span> biểu thị mảng hiệu của mảng gồm toàn bộ phần tử nằm trên hàng đó.</li>
<li><span class="arithmatex">\(D_{cột}(A)\)</span> gồm <span class="arithmatex">\(n\)</span> cột, cột thứ <span class="arithmatex">\(i\)</span> biểu thị mảng hiệu của mảng gồm toàn bộ phần tử nằm trên cột đó.</li>
</ul>
<p>Trong không gian 1 chiều, ta thấy được <span class="arithmatex">\(S(D(A)) = A\)</span>. Để tính chất này được áp dụng cho mảng 2 chiều, ta tạo mảng <span class="arithmatex">\(A'\)</span> thỏa: <span class="arithmatex">\(A_{i, j}^{'}= A_{i, j}\)</span> với <span class="arithmatex">\(i, j\)</span> dương và <span class="arithmatex">\(A_{i, j} = 0\)</span> với <span class="arithmatex">\(i = 0\)</span> hoặc <span class="arithmatex">\(j = 0\)</span>. Mảng <span class="arithmatex">\(A'\)</span> này đánh số theo dạng 0-indexed và có kích thước là <span class="arithmatex">\((m + 1) \times (n + 1)\)</span>. Khi này, mảng hiệu của <span class="arithmatex">\(A\)</span> sẽ là mảng <span class="arithmatex">\(D\)</span> thỏa <span class="arithmatex">\(S(D) = A'\)</span>.</p>
<p>Đặt <span class="arithmatex">\(D = D_{cột}(D_{hàng}(A))\)</span>, khi này, ta có:</p>
<div class="arithmatex">\[
\begin{align*}
D_{i, j} &amp;= [D_{cột}(D_{hàng}(A))]_{i, j} \\
&amp;= [D_{hàng}(A_i)]_j - [D_{hàng}(A_{i - 1})]_j \\
&amp;= (A_{i, j} - A_{i, j - 1}) - (A_{i - 1, j} - A_{i - 1, j - 1}) \\
&amp;= A_{i, j} - A_{i, j - 1} - A_{i - 1, j} + A_{i - 1, j - 1}
\end{align*}
\]</div>
<p>Mảng <span class="arithmatex">\(S(D)\)</span> có giá trị như sau:</p>
<div class="arithmatex">\[
\begin{align*}
\displaystyle
S(D)_{i,j} &amp;= \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} D_{t_i,t_j}\\
&amp;=\sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} (A_{t_i, t_j} - A_{t_i, t_j - 1} - A_{t_i - 1, t_j} + A_{t_i - 1, t_j - 1})\\
&amp;=\sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i, t_j} - \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i, t_j - 1} - \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i - 1, t_j} + \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i - 1, t_j - 1}\\
&amp;=\sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j} A_{t_i, t_j} - \sum_{t_i\,=\,1}^{i} \sum_{t_j\,=\,1}^{j-1} A_{t_i, t_j} - \sum_{t_i\,=\,1}^{i-1} \sum_{t_j\,=\,1}^{j} A_{t_i, t_j} + \sum_{t_i\,=\,1}^{i-1} \sum_{t_j\,=\,1}^{j-1} A_{t_i, t_j}\\
&amp;= S_{i,j} - S_{i-1,j} - S_{i,j-1} + S_{i-1,j-1} \\
&amp;= {A'}_{i, j} \\
\end{align*}
\]</div>
<p>Ta kết luận rằng <span class="arithmatex">\(S(D) = A'\)</span>, mảng <span class="arithmatex">\(D\)</span> ta vừa dựng chính là mảng hiệu của <span class="arithmatex">\(A\)</span>.</p>
<p><img alt="" src="https://i.imgur.com/w7txGHE.png" /></p>
<p>Từ các quan sát trên, ta có thể dựng mảng hiệu của <span class="arithmatex">\(A\)</span> bằng hai cách:</p>
<ul>
<li>Sử dụng trực tiếp công thức:
  <span class="arithmatex">\(D_{i, j} = A_{i, j} - A_{i, j - 1} - A_{i - 1, j} + A_{i - 1, j - 1}\)</span></li>
<li>Tính <span class="arithmatex">\(D_{hàng}\)</span> cho từng hàng của <span class="arithmatex">\(A\)</span> và gán kết quả vào <span class="arithmatex">\(A'\)</span>, sau đó tính <span class="arithmatex">\(D_{cột}\)</span> cho từng cột của <span class="arithmatex">\(A'\)</span>.</li>
</ul>
<p>Code dưới đây dựng mảng hiệu 2 chiều <span class="arithmatex">\(D\)</span> theo <span class="arithmatex">\(A\)</span> theo cách thứ nhất:</p>
<div class="highlight"><pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">build2DDifferenceArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">differenceArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">differenceArray</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Quay lại bài toán cũ trong không gian 1 chiều: làm thế nào để ta tăng thêm một lượng <span class="arithmatex">\(k\)</span> lên toàn bộ phần tử trong lưới <span class="arithmatex">\([r_1, r_2] \times [c_1, c_2]\)</span> một cách hiệu quả? Khi ta tính <span class="arithmatex">\(D_{hàng}\)</span> cho từng hàng của <span class="arithmatex">\(A\)</span>, ta nhận thấy chỉ giá trị của phần tử ở biên trái (tại <span class="arithmatex">\(c_1\)</span>) và biên phải (tại <span class="arithmatex">\(c_2 + 1\)</span>). Tiếp tục tính <span class="arithmatex">\(D_{cột}\)</span> cho từng cột của mảng <span class="arithmatex">\(D_{hàng}(A)\)</span>, quan sát tương tự cho thấy chỉ phần tử tại <span class="arithmatex">\(r_1\)</span> và <span class="arithmatex">\(r_2 + 1\)</span> sẽ bị tác động bởi thao tác cập nhật này.</p>
<p>Từ nhận xét trên, ta thấy chỉ có 4 phần tử của <span class="arithmatex">\(D(A)\)</span> sẽ bị tác động bởi thao tác này là tọa độ <span class="arithmatex">\((r_1, c_1)\)</span>, <span class="arithmatex">\((r_1, c_2 + 1)\)</span>, <span class="arithmatex">\((r_2 + 1, c_1)\)</span> và <span class="arithmatex">\((r_2 + 1, c_2 + 1)\)</span> - trong đó, phần tử tại <span class="arithmatex">\((r_1, c_1)\)</span> và <span class="arithmatex">\((r_2 + 1, c_2 + 1)\)</span> tăng thêm lượng <span class="arithmatex">\(k\)</span>, phần tử tại <span class="arithmatex">\((r_1, c_2 + 1)\)</span> và <span class="arithmatex">\((r_2 + 1, c_1)\)</span> trừ đi lượng <span class="arithmatex">\(k\)</span>. Ta dễ dàng cập nhật đoạn trên mảng hai chiều với độ phức tạp <span class="arithmatex">\(\mathcal{O}(1)\)</span>.</p>
<h3 id="mang-hieu-ba-chieu">Mảng hiệu ba chiều</h3>
<p>Cũng như mảng cộng dồn, ta cũng có thể dựng mảng hiệu của các mảng trong không gian 3 chiều. Tương tự, nếu ta coi <span class="arithmatex">\(D\)</span> là mảng sinh ra mảng cộng dồn <span class="arithmatex">\(A\)</span>, ta có công thức dựng <span class="arithmatex">\(D\)</span> sau:</p>
<div class="arithmatex">\[
\begin{align*}
D_{i,j,k} &amp;= A_{i,j,k} - A_{i-1,j,k} - A_{i,j-1,k} - A_{i,j,k-1} \\
&amp; \, + A_{i-1,j-1,k} + A_{i-1,j,k-1} + A_{i,j-1,k-1} - A_{i-1,j-1,k-1}
\end{align*}
\]</div>
<p>Để xử lý truy vấn cập nhật toàn bộ phần tử trong không gian <span class="arithmatex">\([x_1, x_2] \times [y_1, y_2] \times [z_1, z_2]\)</span>, ta cần cập nhật giá trị tại <span class="arithmatex">\(8\)</span> vị trí, các vị trí đều nằm tại biên của không gian. Nếu ta coi mảng <span class="arithmatex">\(n\)</span>-chiều như một hình lập phương chứa số, vị trí cần cập nhật sẽ tương ứng với đỉnh của hình lập phương đại diện cho không gian cần cập nhật. Ta sẽ tô xen kẽ các đỉnh này theo hai màu đen - trắng, đỉnh có tọa độ <span class="arithmatex">\((x_1, y_1, z_1)\)</span> được tô màu trắng. Phần tử <span class="arithmatex">\(D\)</span> ứng với các đỉnh trắng được cộng thêm lượng <span class="arithmatex">\(k\)</span>, ngược lại, phần tử ứng với đỉnh đen thì trừ đi lượng <span class="arithmatex">\(k\)</span>.</p>
<p><img alt="" src="https://i.imgur.com/jO0h9zp.png" /></p>
<p>Hình trên minh họa những vị trí mà ta cần cập nhật trên mảng hiệu. Tương tự mảng cộng dồn, phương pháp <a href="https://vnoi.info/wiki/translate/he/Number-Theory-7.md">bao hàm - loại trừ</a> được áp dụng để đưa đến kết luận này.</p>
<h2 id="mo-rong-sang-mang-ong">Mở rộng sang mảng động</h2>
<p>Trong các ví dụ đã đề cập, các bài toán chúng ta phải giải đều không có truy vấn cập nhật hoặc toàn bộ truy vấn cập nhật được thực hiện trước truy vấn hỏi. Tuy nhiên, trong một số bài toán yêu cầu phải thực hiện xen kẽ hai loại truy vấn này, ta cần sử dụng các cấu trúc dữ liệu để giải quyết hiệu quả các truy vấn này.</p>
<p>Có hai dạng bài toán liên quan đến mảng cộng dồn và mảng hiệu:</p>
<ul>
<li><strong>Dạng 1:</strong> Cập nhật giá trị của <span class="arithmatex">\(A_i\)</span> hoặc tính tổng của <span class="arithmatex">\(i\)</span> phần tử đầu tiên.</li>
<li><strong>Dạng 2:</strong> Cập nhật toàn bộ giá trị từ <span class="arithmatex">\(A_i\)</span> đến <span class="arithmatex">\(A_j\)</span> <span class="arithmatex">\((i \le j)\)</span> hoặc cho biết giá trị hiện tại của <span class="arithmatex">\(A_i\)</span>.</li>
</ul>
<p>Nếu bài toán chỉ xử lý một trong hai dạng nói trên, ta có thể áp dụng cấu trúc dữ liệu <a href="https://vnoi.info/wiki/algo/data-structures/fenwick.md">Binary Indexed Tree</a> để giải quyết các truy vấn trên. Độ phức tạp của từng truy vấn sẽ phụ thuộc vào số chiều của mảng, thí dụ, thao tác trên mảng 1D sẽ cho độ phức tạp <span class="arithmatex">\(\mathcal{O}(\log n)\)</span> còn trên mảng 2D sẽ là <span class="arithmatex">\(\mathcal{O}(\log^2 n)\)</span>.</p>
<p>Trong một số bài toán yêu cầu xử lý kết hợp 2 dạng (cập nhật đoạn và tính tổng đoạn), ta thường áp dụng <a href="https://vnoi.info/wiki/algo/data-structures/segment-tree-extend.md">Segment Tree</a> có lazy propagation (cập nhật lười). Mặc dù có chung độ phức tạp, cách cài đặt này thường khó hơn, có thời gian chạy lâu hơn và dùng nhiều bộ nhớ hơn so với cài đặt Binary Indexed Tree. Nếu ta làm việc trên mảng 1 chiều, ta cũng có thể biến đổi hệ thức giữa mảng hiệu và mảng cộng dồn để cài đặt trực tiếp BIT làm việc trên các truy vấn này. Bạn đọc có thể tham khảo thêm cách cài đặt này tại <a href="https://vnoi.info/wiki/algo/data-structures/fenwick.md#truy-v%E1%BA%A5n-tr%C3%AAn-%C4%91o%E1%BA%A1n">đây</a>.</p>
<h2 id="bai-tap">Bài tập</h2>
<h3 id="mang-cong-don-1-chieu">Mảng cộng dồn 1 chiều</h3>
<p><a href="https://oj.vnoi.info/problem/nkseq">VNOJ - NKSEQ</a></p>
<p><a href="https://cses.fi/problemset/task/1661">CSES - Subarray Sums II</a></p>
<p><a href="https://cses.fi/problemset/task/1662">CSES - Subarray Divisibility</a></p>
<p><a href="https://codeforces.com/contest/1398/problem/C">Codeforces - Good Subarrays</a></p>
<p><a href="https://www.codechef.com/problems/XXOR">Codechef - XXOR</a></p>
<h3 id="mang-hieu-1-chieu">Mảng hiệu 1 chiều</h3>
<p><a href="https://codeforces.com/problemset/problem/276/C">Codeforces - Little Girl and Maximum Sum</a></p>
<p><a href="https://codeforces.com/contest/296/problem/C">Codeforces - Greg and Array</a></p>
<p><a href="https://codeforces.com/group/1rv4rhCsHp/contest/319055/problem/E">Codeforces Gym - 319055E</a> (lưu ý: để xem nội dung bài tập cần tham gia nhóm tại <a href="https://codeforces.com/group/1rv4rhCsHp">link đây</a>)</p>
<h3 id="mang-cong-don-nhieu-chieu">Mảng cộng dồn nhiều chiều</h3>
<p><a href="https://cses.fi/problemset/task/1652">CSES - Forest Queries</a></p>
<p><a href="http://www.usaco.org/index.php?page=viewproblem2&amp;cpid=416">USACO - The Lazy Cow</a></p>
<p><a href="http://www.usaco.org/index.php?page=viewproblem2&amp;cpid=923">USACO - Painting the Barn</a></p>
<p><a href="https://oj.vnoi.info/problem/maxcub">VNOJ - MAXCUB</a></p>
<h3 id="mang-hieu-nhieu-chieu">Mảng hiệu nhiều chiều</h3>
<p><a href="https://www.codechef.com/COW42020/problems/COW3E">Codechef - COW3E</a></p>
<p><a href="https://wcipeg.com/problem/cake">WCIPEG - CAKE</a></p>
<p>VNOJ có phân loại riêng các bài tập về mảng cộng dồn, bạn đọc có thể tham khảo tại <a href="https://oj.vnoi.info/tags/?tag_id=prefix_sum">đây</a>.</p>
<h2 id="references">References</h2>
<p><a href="http://wcipeg.com/wiki/Prefix_sum_array_and_difference_array">WCIPEG - Prefix sum array and difference array</a></p>
<p><a href="https://en.cppreference.com/w/cpp/algorithm/partial_sum">cppreference.com - partial_sum</a></p>
<p><a href="https://en.cppreference.com/w/cpp/algorithm/adjacent_difference">cppreference.com - adjacent_difference</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../js/jquery-3.7.1.min.js"></script>
      
        <script src="../../../js/webjs.js"></script>
      
    
  </body>
</html>